local a={debugger=true,version=1}local b;local c={}local d={}local e=term.current()local f=string.sub;local g={[colors.white]="0",[colors.orange]="1",[colors.magenta]="2",[colors.lightBlue]="3",[colors.yellow]="4",[colors.lime]="5",[colors.pink]="6",[colors.gray]="7",[colors.lightGray]="8",[colors.cyan]="9",[colors.purple]="a",[colors.blue]="b",[colors.brown]="c",[colors.green]="d",[colors.red]="e",[colors.black]="f"}local h={basaltBG=colors.lightGray,basaltFG=colors.black,FrameBG=colors.gray,FrameFG=colors.black,ButtonBG=colors.gray,ButtonFG=colors.black,CheckboxBG=colors.gray,CheckboxFG=colors.black,InputBG=colors.gray,InputFG=colors.black,textfieldBG=colors.gray,textfieldFG=colors.black,listBG=colors.gray,listFG=colors.black,dropdownBG=colors.gray,dropdownFG=colors.black,radioBG=colors.gray,radioFG=colors.black,selectionBG=colors.black,selectionFG=colors.lightGray}local i={{"\32\32\32\137\156\148\158\159\148\135\135\144\159\139\32\136\157\32\159\139\32\32\143\32\32\143\32\32\32\32\32\32\32\32\147\148\150\131\148\32\32\32\151\140\148\151\140\147","\32\32\32\149\132\149\136\156\149\144\32\133\139\159\129\143\159\133\143\159\133\138\32\133\138\32\133\32\32\32\32\32\32\150\150\129\137\156\129\32\32\32\133\131\129\133\131\132","\32\32\32\130\131\32\130\131\32\32\129\32\32\32\32\130\131\32\130\131\32\32\32\32\143\143\143\32\32\32\32\32\32\130\129\32\130\135\32\32\32\32\131\32\32\131\32\131","\139\144\32\32\143\148\135\130\144\149\32\149\150\151\149\158\140\129\32\32\32\135\130\144\135\130\144\32\149\32\32\139\32\159\148\32\32\32\32\159\32\144\32\148\32\147\131\132","\159\135\129\131\143\149\143\138\144\138\32\133\130\149\149\137\155\149\159\143\144\147\130\132\32\149\32\147\130\132\131\159\129\139\151\129\148\32\32\139\131\135\133\32\144\130\151\32","\32\32\32\32\32\32\130\135\32\130\32\129\32\129\129\131\131\32\130\131\129\140\141\132\32\129\32\32\129\32\32\32\32\32\32\32\131\131\129\32\32\32\32\32\32\32\32\32","\32\32\32\32\149\32\159\154\133\133\133\144\152\141\132\133\151\129\136\153\32\32\154\32\159\134\129\130\137\144\159\32\144\32\148\32\32\32\32\32\32\32\32\32\32\32\151\129","\32\32\32\32\133\32\32\32\32\145\145\132\141\140\132\151\129\144\150\146\129\32\32\32\138\144\32\32\159\133\136\131\132\131\151\129\32\144\32\131\131\129\32\144\32\151\129\32","\32\32\32\32\129\32\32\32\32\130\130\32\32\129\32\129\32\129\130\129\129\32\32\32\32\130\129\130\129\32\32\32\32\32\32\32\32\133\32\32\32\32\32\129\32\129\32\32","\150\156\148\136\149\32\134\131\148\134\131\148\159\134\149\136\140\129\152\131\32\135\131\149\150\131\148\150\131\148\32\148\32\32\148\32\32\152\129\143\143\144\130\155\32\134\131\148","\157\129\149\32\149\32\152\131\144\144\131\148\141\140\149\144\32\149\151\131\148\32\150\32\150\131\148\130\156\133\32\144\32\32\144\32\130\155\32\143\143\144\32\152\129\32\134\32","\130\131\32\131\131\129\131\131\129\130\131\32\32\32\129\130\131\32\130\131\32\32\129\32\130\131\32\130\129\32\32\129\32\32\133\32\32\32\129\32\32\32\130\32\32\32\129\32","\150\140\150\137\140\148\136\140\132\150\131\132\151\131\148\136\147\129\136\147\129\150\156\145\138\143\149\130\151\32\32\32\149\138\152\129\149\32\32\157\152\149\157\144\149\150\131\148","\149\143\142\149\32\149\149\32\149\149\32\144\149\32\149\149\32\32\149\32\32\149\32\149\149\32\149\32\149\32\144\32\149\149\130\148\149\32\32\149\32\149\149\130\149\149\32\149","\130\131\129\129\32\129\131\131\32\130\131\32\131\131\32\131\131\129\129\32\32\130\131\32\129\32\129\130\131\32\130\131\32\129\32\129\131\131\129\129\32\129\129\32\129\130\131\32","\136\140\132\150\131\148\136\140\132\153\140\129\131\151\129\149\32\149\149\32\149\149\32\149\137\152\129\137\152\129\131\156\133\149\131\32\150\32\32\130\148\32\152\137\144\32\32\32","\149\32\32\149\159\133\149\32\149\144\32\149\32\149\32\149\32\149\150\151\129\138\155\149\150\130\148\32\149\32\152\129\32\149\32\32\32\150\32\32\149\32\32\32\32\32\32\32","\129\32\32\130\129\129\129\32\129\130\131\32\32\129\32\130\131\32\32\129\32\129\32\129\129\32\129\32\129\32\131\131\129\130\131\32\32\32\129\130\131\32\32\32\32\140\140\132","\32\154\32\159\143\32\149\143\32\159\143\32\159\144\149\159\143\32\159\137\145\159\143\144\149\143\32\32\145\32\32\32\145\149\32\144\32\149\32\143\159\32\143\143\32\159\143\32","\32\32\32\152\140\149\151\32\149\149\32\145\149\130\149\157\140\133\32\149\32\154\143\149\151\32\149\32\149\32\144\32\149\149\153\32\32\149\32\149\133\149\149\32\149\149\32\149","\32\32\32\130\131\129\131\131\32\130\131\32\130\131\129\130\131\129\32\129\32\140\140\129\129\32\129\32\129\32\137\140\129\130\32\129\32\130\32\129\32\129\129\32\129\130\131\32","\144\143\32\159\144\144\144\143\32\159\143\144\159\138\32\144\32\144\144\32\144\144\32\144\144\32\144\144\32\144\143\143\144\32\150\129\32\149\32\130\150\32\134\137\134\134\131\148","\136\143\133\154\141\149\151\32\129\137\140\144\32\149\32\149\32\149\154\159\133\149\148\149\157\153\32\154\143\149\159\134\32\130\148\32\32\149\32\32\151\129\32\32\32\32\134\32","\133\32\32\32\32\133\129\32\32\131\131\32\32\130\32\130\131\129\32\129\32\130\131\129\129\32\129\140\140\129\131\131\129\32\130\129\32\129\32\130\129\32\32\32\32\32\129\32","\32\32\32\32\149\32\32\149\32\32\32\32\32\32\32\32\149\32\32\149\32\32\32\32\32\32\32\32\149\32\32\149\32\32\32\32\32\32\32\32\149\32\32\149\32\32\32\32","\32\32\32\32\32\32\32\32\32\32\32\32\32\149\32\32\149\32\32\149\32\32\149\32\32\149\32\32\149\32\32\149\32\32\149\32\32\32\32\32\32\32\32\32\32\32\32\32","\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32","\32\32\32\32\149\32\32\149\32\32\32\32\32\32\32\32\149\32\32\149\32\32\32\32\32\32\32\32\149\32\32\149\32\32\32\32\32\32\32\32\149\32\32\149\32\32\32\32","\32\32\32\32\32\32\32\32\32\32\32\32\32\149\32\32\149\32\32\149\32\32\149\32\32\149\32\32\149\32\32\149\32\32\149\32\32\32\32\32\32\32\32\32\32\32\32\32","\32\149\32\32\149\32\32\149\32\32\149\32\32\149\32\32\149\32\32\149\32\32\149\32\32\149\32\32\149\32\32\149\32\32\149\32\32\149\32\32\149\32\32\149\32\32\149\32","\32\32\32\32\145\32\159\139\32\151\131\132\155\143\132\134\135\145\32\149\32\158\140\129\130\130\32\152\147\155\157\134\32\32\144\144\32\32\32\32\32\32\152\131\155\131\131\129","\32\32\32\32\149\32\149\32\145\148\131\32\149\32\149\140\157\132\32\148\32\137\155\149\32\32\32\149\154\149\137\142\32\153\153\32\131\131\149\131\131\129\149\135\145\32\32\32","\32\32\32\32\129\32\130\135\32\131\131\129\134\131\132\32\129\32\32\129\32\131\131\32\32\32\32\130\131\129\32\32\32\32\129\129\32\32\32\32\32\32\130\131\129\32\32\32","\150\150\32\32\148\32\134\32\32\132\32\32\134\32\32\144\32\144\150\151\149\32\32\32\32\32\32\145\32\32\152\140\144\144\144\32\133\151\129\133\151\129\132\151\129\32\145\32","\130\129\32\131\151\129\141\32\32\142\32\32\32\32\32\149\32\149\130\149\149\32\143\32\32\32\32\142\132\32\154\143\133\157\153\132\151\150\148\151\158\132\151\150\148\144\130\148","\32\32\32\140\140\132\32\32\32\32\32\32\32\32\32\151\131\32\32\129\129\32\32\32\32\134\32\32\32\32\32\32\32\129\129\32\129\32\129\129\130\129\129\32\129\130\131\32","\156\143\32\159\141\129\153\140\132\153\137\32\157\141\32\159\142\32\150\151\129\150\131\132\140\143\144\143\141\145\137\140\148\141\141\144\157\142\32\159\140\32\151\134\32\157\141\32","\157\140\149\157\140\149\157\140\149\157\140\149\157\140\149\157\140\149\151\151\32\154\143\132\157\140\32\157\140\32\157\140\32\157\140\32\32\149\32\32\149\32\32\149\32\32\149\32","\129\32\129\129\32\129\129\32\129\129\32\129\129\32\129\129\32\129\129\131\129\32\134\32\131\131\129\131\131\129\131\131\129\131\131\129\130\131\32\130\131\32\130\131\32\130\131\32","\151\131\148\152\137\145\155\140\144\152\142\145\153\140\132\153\137\32\154\142\144\155\159\132\150\156\148\147\32\144\144\130\145\136\137\32\146\130\144\144\130\145\130\136\32\151\140\132","\151\32\149\151\155\149\149\32\149\149\32\149\149\32\149\149\32\149\149\32\149\152\137\144\157\129\149\149\32\149\149\32\149\149\32\149\149\32\149\130\150\32\32\157\129\149\32\149","\131\131\32\129\32\129\130\131\32\130\131\32\130\131\32\130\131\32\130\131\32\32\32\32\130\131\32\130\131\32\130\131\32\130\131\32\130\131\32\32\129\32\130\131\32\133\131\32","\156\143\32\159\141\129\153\140\132\153\137\32\157\141\32\159\142\32\159\159\144\152\140\144\156\143\32\159\141\129\153\140\132\157\141\32\130\145\32\32\147\32\136\153\32\130\146\32","\152\140\149\152\140\149\152\140\149\152\140\149\152\140\149\152\140\149\149\157\134\154\143\132\157\140\133\157\140\133\157\140\133\157\140\133\32\149\32\32\149\32\32\149\32\32\149\32","\130\131\129\130\131\129\130\131\129\130\131\129\130\131\129\130\131\129\130\130\131\32\134\32\130\131\129\130\131\129\130\131\129\130\131\129\32\129\32\32\129\32\32\129\32\32\129\32","\159\134\144\137\137\32\156\143\32\159\141\129\153\140\132\153\137\32\157\141\32\32\132\32\159\143\32\147\32\144\144\130\145\136\137\32\146\130\144\144\130\145\130\138\32\146\130\144","\149\32\149\149\32\149\149\32\149\149\32\149\149\32\149\149\32\149\149\32\149\131\147\129\138\134\149\149\32\149\149\32\149\149\32\149\149\32\149\154\143\149\32\157\129\154\143\149","\130\131\32\129\32\129\130\131\32\130\131\32\130\131\32\130\131\32\130\131\32\32\32\32\130\131\32\130\131\129\130\131\129\130\131\129\130\131\129\140\140\129\130\131\32\140\140\129"},{[[000110000110110000110010101000000010000000100101]],[[000000110110000000000010101000000010000000100101]],[[000000000000000000000000000000000000000000000000]],[[100010110100000010000110110000010100000100000110]],[[000000110000000010110110000110000000000000110000]],[[000000000000000000000000000000000000000000000000]],[[000000110110000010000000100000100000000000000010]],[[000000000110110100010000000010000000000000000100]],[[000000000000000000000000000000000000000000000000]],[[010000000000100110000000000000000000000110010000]],[[000000000000000000000000000010000000010110000000]],[[000000000000000000000000000000000000000000000000]],[[011110110000000100100010110000000100000000000000]],[[000000000000000000000000000000000000000000000000]],[[000000000000000000000000000000000000000000000000]],[[110000110110000000000000000000010100100010000000]],[[000010000000000000110110000000000100010010000000]],[[000000000000000000000000000000000000000000000000]],[[010110010110100110110110010000000100000110110110]],[[000000000000000000000110000000000110000000000000]],[[000000000000000000000000000000000000000000000000]],[[010100010110110000000000000000110000000010000000]],[[110110000000000000110000110110100000000010000000]],[[000000000000000000000000000000000000000000000000]],[[000100011111000100011111000100011111000100011111]],[[000000000000100100100100011011011011111111111111]],[[000000000000000000000000000000000000000000000000]],[[000100011111000100011111000100011111000100011111]],[[000000000000100100100100011011011011111111111111]],[[100100100100100100100100100100100100100100100100]],[[000000110100110110000010000011110000000000011000]],[[000000000100000000000010000011000110000000001000]],[[000000000000000000000000000000000000000000000000]],[[010000100100000000000000000100000000010010110000]],[[000000000000000000000000000000110110110110110000]],[[000000000000000000000000000000000000000000000000]],[[110110110110110110000000110110110110110110110110]],[[000000000000000000000110000000000000000000000000]],[[000000000000000000000000000000000000000000000000]],[[000000000000110110000110010000000000000000010010]],[[000010000000000000000000000000000000000000000000]],[[000000000000000000000000000000000000000000000000]],[[110110110110110110110000110110110110000000000000]],[[000000000000000000000110000000000000000000000000]],[[000000000000000000000000000000000000000000000000]],[[110110110110110110110000110000000000000000010000]],[[000000000000000000000000100000000000000110000110]],[[000000000000000000000000000000000000000000000000]]}}local j={}local k={}do local l=0;local m=#i[1]local n=#i[1][1]for o=1,m,3 do for p=1,n,3 do local q=string.char(l)local r={}r[1]=i[1][o]:sub(p,p+2)r[2]=i[1][o+1]:sub(p,p+2)r[3]=i[1][o+2]:sub(p,p+2)local s={}s[1]=i[2][o]:sub(p,p+2)s[2]=i[2][o+1]:sub(p,p+2)s[3]=i[2][o+2]:sub(p,p+2)k[q]={r,s}l=l+1 end end;j[1]=k end;local function t(u,v)local w={["0"]="1",["1"]="0"}if u<=#j then return true end;for x=#j+1,u do local y={}local z=j[x-1]for l=0,255 do local q=string.char(l)local r={}local s={}local A=z[q][1]local B=z[q][2]for o=1,#A do local C,D,E,F,G,H={},{},{},{},{},{}for p=1,#A[1]do local I=k[A[o]:sub(p,p)][1]table.insert(C,I[1])table.insert(D,I[2])table.insert(E,I[3])local J=k[A[o]:sub(p,p)][2]if B[o]:sub(p,p)=="1"then table.insert(F,J[1]:gsub("[01]",w))table.insert(G,J[2]:gsub("[01]",w))table.insert(H,J[3]:gsub("[01]",w))else table.insert(F,J[1])table.insert(G,J[2])table.insert(H,J[3])end end;table.insert(r,table.concat(C))table.insert(r,table.concat(D))table.insert(r,table.concat(E))table.insert(s,table.concat(F))table.insert(s,table.concat(G))table.insert(s,table.concat(H))end;y[q]={r,s}if v then v="Font"..x.."Yeld"..l;os.queueEvent(v)os.pullEvent(v)end end;j[x]=y end;return true end;local function K(L,M,N,O,P)if not type(M)=="string"then error("Not a String",3)end;local Q=type(N)=="string"and N:sub(1,1)or g[N]or error("Wrong Front Color",3)local R=type(O)=="string"and O:sub(1,1)or g[O]or error("Wrong Back Color",3)if j[L]==nil then t(3,false)end;local S=j[L]or error("Wrong font size selected",3)if M==""then return{{""},{""},{""}}end;local T={}for o in M:gmatch('.')do table.insert(T,o)end;local U={}local m=#S[T[1]][1]for V=1,m do local W={}for o=1,#T do W[o]=S[T[o]]and S[T[o]][1][V]or""end;U[V]=table.concat(W)end;local X={}local Y={}local Z={["0"]=Q,["1"]=R}local _={["0"]=R,["1"]=Q}for V=1,m do local a0={}local a1={}for o=1,#T do local a2=S[T[o]]and S[T[o]][2][V]or""a0[o]=a2:gsub("[01]",P and{["0"]=N:sub(o,o),["1"]=O:sub(o,o)}or Z)a1[o]=a2:gsub("[01]",P and{["0"]=O:sub(o,o),["1"]=N:sub(o,o)}or _)end;X[V]=table.concat(a0)Y[V]=table.concat(a1)end;return{U,X,Y}end;local function a3(a4)local a5=a4;local a6,m=a5.getSize()local a7={}local a8={}local a9={}local aa={}local ab={}local ac={}local ad;local ae={}local function af()ad=(" "):rep(a6)for ag=0,15 do local ah=2^ag;local ai=g[ah]ae[ah]=ai:rep(a6)end end;af()local function aj()local ak=ad;local al=ae[colors.white]local am=ae[colors.black]for an=1,m do a7[an]=f(a7[an]==nil and ak or a7[an]..ak:sub(1,a6-a7[an]:len()),1,a6)a9[an]=f(a9[an]==nil and al or a9[an]..al:sub(1,a6-a9[an]:len()),1,a6)a8[an]=f(a8[an]==nil and am or a8[an]..am:sub(1,a6-a8[an]:len()),1,a6)end end;aj()local function ao(ap,aq,ar)if aq>=1 and aq<=m then if ap+ar:len()>0 and ap<=a6 then local as=a7[aq]local at;local au=ap+#ar-1;if ap<1 then local av=1-ap+1;local aw=a6-ap+1;ar=f(ar,av,aw)elseif au>a6 then local aw=a6-ap+1;ar=f(ar,1,aw)end;if ap>1 then local aw=ap-1;at=f(as,1,aw)..ar else at=ar end;if au<a6 then at=at..f(as,au+1,a6)end;a7[aq]=at end end end;local function ax(ap,aq,ay)if aq>=1 and aq<=m then if ap+ay:len()>0 and ap<=a6 then local as=a8[aq]local at;local au=ap+#ay-1;if ap<1 then ay=f(ay,1-ap+1,a6-ap+1)elseif au>a6 then ay=f(ay,1,a6-ap+1)end;if ap>1 then at=f(as,1,ap-1)..ay else at=ay end;if au<a6 then at=at..f(as,au+1,a6)end;a8[aq]=at end end end;local function az(ap,aq,ay)if aq>=1 and aq<=m then if ap+ay:len()>0 and ap<=a6 then local as=a9[aq]local at;local au=ap+#ay-1;if ap<1 then local av=1-ap+1;local aw=a6-ap+1;ay=f(ay,av,aw)elseif au>a6 then local aw=a6-ap+1;ay=f(ay,1,aw)end;if ap>1 then local aw=ap-1;at=f(as,1,aw)..ay else at=ay end;if au<a6 then at=at..f(as,au+1,a6)end;a9[aq]=at end end end;local aA={setBG=function(ap,aq,ay)ax(ap,aq,ay)end,setText=function(ap,aq,ar)ao(ap,aq,ar)end,setFG=function(ap,aq,ay)az(ap,aq,ay)end,drawBackgroundBox=function(ap,aq,a6,m,aB)for ag=1,m do ax(ap,aq+ag-1,g[aB]:rep(a6))end end,drawForegroundBox=function(ap,aq,a6,m,aC)for ag=1,m do az(ap,aq+ag-1,g[aC]:rep(a6))end end,drawTextBox=function(ap,aq,a6,m,aD)for ag=1,m do ao(ap,aq+ag-1,aD:rep(a6))end end,writeText=function(ap,aq,ar,aB,aC)aB=aB or a5.getBackgroundColor()aC=aC or a5.getTextColor()ao(ap,aq,ar)ax(ap,aq,g[aB]:rep(ar:len()))az(ap,aq,g[aC]:rep(ar:len()))end,update=function()local aE,aF=a5.getCursorPos()local aG=false;if a5.getCursorBlink~=nil then aG=a5.getCursorBlink()end;a5.setCursorBlink(false)for ag=1,m do a5.setCursorPos(1,ag)a5.blit(a7[ag],a9[ag],a8[ag])end;a5.setBackgroundColor(colors.black)a5.setCursorBlink(aG)a5.setCursorPos(aE,aF)end,setTerm=function(aH)a5=aH end}return aA end;local function aI()local aJ={}local aK={}local aL={registerEvent=function(self,aM,aN)if aJ[aM]==nil then aJ[aM]={}aK[aM]=1 end;aJ[aM][aK[aM]]=aN;aK[aM]=aK[aM]+1;return aK[aM]-1 end,removeEvent=function(self,aM,aK)aJ[aM][aK[aM]]=nil end,sendEvent=function(self,aM,...)if aJ[aM]~=nil then for aO,aP in pairs(aJ[aM])do aP(...)end end end}aL.__index=aL;return aL end;local aQ={}local aR={}local aS=0;function aR:new(aT,aU,...)local aV=table.pack(...)local aW=setmetatable({path=aT},{__index=self})aW.window=aU;aW.processId=aS;aW.coroutine=coroutine.create(function()os.run({basalt=a},aT,table.unpack(aV))end)aQ[aS]=aW;aS=aS+1;return aW end;function aR:resume(aL,...)term.redirect(self.window)local aX,aY=coroutine.resume(self.coroutine,aL,...)self.window=term.current()if aX then self.filter=aY else a.debug(aY)end end;function aR:isDead()if self.coroutine~=nil then if coroutine.status(self.coroutine)=="dead"then table.remove(aQ,self.processId)return true end else return true end;return false end;function aR:getStatus()if self.coroutine~=nil then return coroutine.status(self.coroutine)end;return nil end;function aR:start()coroutine.resume(self.coroutine)end;local function aZ(ar,a6,a_,b0)ar=string.sub(ar,1,a6)local b1=a6-string.len(ar)if a_=="right"then ar=string.rep(b0 or" ",b1)..ar elseif a_=="center"then ar=string.rep(b0 or" ",math.floor(b1/2))..ar..string.rep(b0 or" ",math.floor(b1/2))ar=ar..(string.len(ar)<a6 and(b0 or" ")or"")else ar=ar..string.rep(b0 or" ",b1)end;return ar end;local function b2(b3,a_)local b1=0;if a_=="center"then b1=math.ceil(b3/2)if b1<1 then b1=1 end end;if a_=="bottom"then b1=b3 end;if b1<1 then b1=1 end;return b1 end;local function b4(b5)return function(b5,o)o=o-1;if o~=0 then return o,b5[o]end end,b5,#b5+1 end;local function b6(b7,b8)local b9={[0]={8,4,3,6,5},{4,14,8,7},{6,10,8,7},{9,11,8,0},{1,14,8,0},{13,12,8,0},{2,10,8,0},{15,8,10,11,12,14},{0,7,1,9,2,13},{3,11,8,7},{2,6,7,15},{9,3,7,15},{13,5,7,15},{5,12,8,7},{1,4,7,15},{7,10,11,12,14}}local ba,bb,bc={},{},{}for o=0,15 do bb[2^o]=o end;do local bd="0123456789abcdef"for o=1,16 do ba[bd:sub(o,o)]=o-1;ba[o-1]=bd:sub(o,o)bc[bd:sub(o,o)]=2^(o-1)bc[2^(o-1)]=bd:sub(o,o)local be=b9[o-1]for o=1,#be do be[o]=2^be[o]end end end;local function bf(bg)local bh=b9[bb[bg[#bg][1]]]if bh~=nil then for p=1,#bh do local bi=bh[p]for o=1,#bg-1 do if bg[o][1]==bi then return o end end end end;return 1 end;local function bj(bk,bl)if not bl then local bm={}bl={}for o=1,6 do local bn=bk[o]local bo=bl[bn]bl[bn],bm[o]=bo and bo+1 or 1,bn end;bk=bm end;local bg={}for bp,aP in pairs(bl)do bg[#bg+1]={bp,aP}end;if#bg>1 then while#bg>2 do table.sort(bg,function(bq,br)return bq[2]>br[2]end)local bs,bt=bf(bg),#bg;local bu,bv=bg[bt][1],bg[bs][1]for o=1,6 do if bk[o]==bu then bk[o]=bv;bg[bs][2]=bg[bs][2]+1 end end;bg[bt]=nil end;local bw=128;for o=1,#bk-1 do if bk[o]~=bk[6]then bw=bw+2^(o-1)end end;return string.char(bw),bc[bg[1][1]==bk[6]and bg[2][1]or bg[1][1]],bc[bk[6]]else return"\128",bc[bk[1]],bc[bk[1]]end end;local bx,a6,m,aB={{},{},{}},0,#b7+#b7%3,b8 or colors.black;for o=1,#b7 do if#b7[o]>a6 then a6=#b7[o]end end;for aq=0,m-1,3 do local by,bz,bA,bB={},{},{},1;for ap=0,a6-1,2 do local bk,bl={},{}for bC=1,3 do for bD=1,2 do bk[#bk+1]=b7[aq+bC]and b7[aq+bC][ap+bD]and(b7[aq+bC][ap+bD]==0 and aB or b7[aq+bC][ap+bD])or aB;bl[bk[#bk]]=bl[bk[#bk]]and bl[bk[#bk]]+1 or 1 end end;by[bB],bz[bB],bA[bB]=bj(bk,bl)bB=bB+1 end;bx[1][#bx[1]+1],bx[2][#bx[2]+1],bx[3][#bx[3]+1]=table.concat(by),table.concat(bz),table.concat(bA)end;bx.width,bx.height=#bx[1][1],#bx[1]return bx end;local function bE(bF)local bG="Object"local aP;local bH=1;local bI="left"local bJ="top"local bK=false;local bL=false;local bM=true;local bN=aI()local bO={x=1,y=1,width=1,height=1,bgColor=colors.black,fgColor=colors.white,name=bF or"Object",parent=nil,show=function(self)bL=true;bM=true;return self end,hide=function(self)bL=false;bM=true;return self end,isVisible=function(self)return bL end,getZIndex=function(self)return bH end,setFocus=function(self)if self.parent~=nil then self.parent:setFocusedObject(self)end;return self end,setZIndex=function(self,aK)bH=aK;if self.parent~=nil then self.parent:removeObject(self)self.parent:addObject(self)end;return self end,getType=function(self)return bG end,getName=function(self)return self.name end,remove=function(self)if self.parent~=nil then self.parent:removeObject(self)end;return self end,setParent=function(self,bP)if bP.getType~=nil and bP:getType()=="Frame"then self:remove()bP:addObject(self)if self.draw then self:show()end end;return self end,setValue=function(self,bQ)if aP~=bQ then aP=bQ;bM=true;self:valueChangedHandler()end;return self end,getValue=function(self)return aP end,getVisualChanged=function(self)return bM end,setVisualChanged=function(self,bR)bM=bR or true;return self end,getEventSystem=function(self)return bN end,getParent=function(self)return self.parent end,setPosition=function(self,bS,bT,bU)if bU then self.x,self.y=math.floor(self.x+bS),math.floor(self.y+bT)else self.x,self.y=math.floor(bS),math.floor(bT)end;bM=true;return self end,getPosition=function(self)return self.x,self.y end,getVisibility=function(self)return bL end,setVisibility=function(self,bV)bL=bV or not bL;bM=true;return self end,setSize=function(self,a6,m)self.width,self.height=a6,m;bM=true;return self end,getHeight=function(self)return self.height end,getWidth=function(self)return self.width end,getSize=function(self)return self.width,self.height end,setBackground=function(self,bW)self.bgColor=bW;bM=true;return self end,getBackground=function(self)return self.bgColor end,setForeground=function(self,bW)self.fgColor=bW;bM=true;return self end,getForeground=function(self)return self.fgColor end,draw=function(self)if bL then return true end;return false end,getAbsolutePosition=function(self,ap,aq)if ap==nil then ap=self.x end;if aq==nil then aq=self.y end;if self.parent~=nil then local bX,bY=self.parent:getAbsolutePosition(self.parent:getAnchorPosition())ap=bX+ap-1;aq=bY+aq-1 end;return ap,aq end,getAnchorPosition=function(self,ap,aq,bZ)if ap==nil then ap=self.x end;if aq==nil then aq=self.y end;if bI=="right"then ap=self.parent.width-ap-self.width+2 end;if bJ=="bottom"then aq=self.parent.height-aq-self.height+2 end;local b_,c0=self:getOffset()if bK or bZ then return ap,aq end;return ap+b_,aq+c0 end,getOffset=function(self)if self.parent~=nil and bK==false then return self.parent:getFrameOffset()end;return 0,0 end,ignoreOffset=function(self,c1)bK=c1 or true;return self end,setAnchor=function(self,...)for aO,aP in pairs(table.pack(...))do if aP=="right"or aP=="left"then bI=aP end;if aP=="top"or aP=="bottom"then bJ=aP end end;bM=true;return self end,getAnchor=function(self)return bI,bJ end,onChange=function(self,aN)self:registerEvent("value_changed",aN)return self end,onClick=function(self,aN)self:registerEvent("mouse_click",aN)self:registerEvent("monitor_touch",aN)return self end,onEvent=function(self,aN)self:registerEvent("custom_event_handler",aN)return self end,onClickUp=function(self,aN)self:registerEvent("mouse_up",aN)return self end,onKey=function(self,aN)self:registerEvent("key",aN)self:registerEvent("char",aN)return self end,onKeyUp=function(self,aN)self:registerEvent("key_up",aN)return self end,onBackgroundKey=function(self,aN)self:registerEvent("background_key",aN)self:registerEvent("background_char",aN)return self end,onBackgroundKeyUp=function(self,aN)self:registerEvent("background_key_up",aN)return self end,isFocused=function(self)if self.parent~=nil then return self.parent:getFocusedObject()==self end;return false end,onGetFocus=function(self,aN)self:registerEvent("get_focus",aN)return self end,onLoseFocus=function(self,aN)self:registerEvent("lose_focus",aN)return self end,registerEvent=function(self,aL,aN)return bN:registerEvent(aL,aN)end,removeEvent=function(self,aL,aK)return bN:removeEvent(aL,aK)end,sendEvent=function(self,aL,...)return bN:sendEvent(aL,self,...)end,mouseClickHandler=function(self,aL,c2,ap,aq)local c3,c4=self:getAbsolutePosition(self:getAnchorPosition())if c3<=ap and c3+self.width>ap and c4<=aq and c4+self.height>aq and bL then if self.parent~=nil then self.parent:setFocusedObject(self)end;bN:sendEvent(aL,self,aL,c2,ap,aq)return true end;return false end,keyHandler=function(self,aL,bp)if self:isFocused()then bN:sendEvent(aL,self,aL,bp)return true end;return false end,backgroundKeyHandler=function(self,aL,bp)bN:sendEvent("background_"..aL,self,aL,bp)end,valueChangedHandler=function(self)bN:sendEvent("value_changed",self)end,eventHandler=function(self,aL,c5,c6,c7,c8)bN:sendEvent("custom_event_handler",self,aL,c5,c6,c7,c8)end,getFocusHandler=function(self)bN:sendEvent("get_focus",self)end,loseFocusHandler=function(self)bN:sendEvent("lose_focus",self)end}bO.__index=bO;return bO end;local function c9(bF)local bO={}local bG="Animation"local ca;local cb={}local aK=1;local cc=0;local cd;local function ce()if cb[aK]~=nil then cb[aK].f(bO,aK)end;aK=aK+1;if cb[aK]~=nil then if cb[aK].t>0 then ca=os.startTimer(cb[aK].t)else ce()end end end;bO={name=bF,getType=function(self)return bG end,getZIndex=function(self)return 1 end,getName=function(self)return self.name end,add=function(self,aN,cf)cd=aN;table.insert(cb,{f=aN,t=cf or cc})return self end,wait=function(self,cf)cc=cf;return self end,rep=function(self,cg)for ap=1,cg do table.insert(cb,{f=cd,t=cc})end;return self end,clear=function(self)cb={}cd=nil;cc=0;aK=1;return self end,play=function(self)aK=1;if cb[aK]~=nil then if cb[aK].t>0 then ca=os.startTimer(cb[aK].t)else ce()end end;return self end,cancel=function(self)os.cancelTimer(ca)return self end,eventHandler=function(self,aL,ch)if aL=="timer"and ch==ca then if cb[aK]~=nil then ce()end end end}bO.__index=bO;return bO end;local function ci(bF)local cj=bE(bF)local bG="Button"cj:setValue("Button")cj:setZIndex(5)cj.width=8;cj.bgColor=h.ButtonBG;cj.fgColor=h.ButtonFG;local ck="center"local cl="center"local bO={getType=function(self)return bG end,setHorizontalAlign=function(self,cm)ck=cm end,setVerticalAlign=function(self,cm)cl=cm end,setText=function(self,ar)cj:setValue(ar)return self end,draw=function(self)if cj.draw(self)then if self.parent~=nil then local cn,co=self:getAnchorPosition()local cp=b2(self.height,cl)self.parent:drawBackgroundBox(cn,co,self.width,self.height,self.bgColor)self.parent:drawForegroundBox(cn,co,self.width,self.height,self.fgColor)self.parent:drawTextBox(cn,co,self.width,self.height," ")for ag=1,self.height do if ag==cp then self.parent:setText(cn,co+ag-1,aZ(self:getValue(),self.width,ck))end end end end end}return setmetatable(bO,cj)end;local function cq(bF)local cj=bE(bF)local bG="Checkbox"cj:setZIndex(5)cj:setValue(false)cj.width=1;cj.height=1;cj.bgColor=h.CheckboxBG;cj.fgColor=h.CheckboxFG;local bO={symbol="\42",getType=function(self)return bG end,mouseClickHandler=function(self,aL,c2,ap,aq)if cj.mouseClickHandler(self,aL,c2,ap,aq)then if aL=="mouse_click"and c2==1 or aL=="monitor_touch"then if self:getValue()~=true and self:getValue()~=false then self:setValue(false)else self:setValue(not self:getValue())end end;return true end;return false end,draw=function(self)if cj.draw(self)then if self.parent~=nil then local cn,co=self:getAnchorPosition()local cp=b2(self.height,"center")self.parent:drawBackgroundBox(cn,co,self.width,self.height,self.bgColor)for ag=1,self.height do if ag==cp then if self:getValue()==true then self.parent:writeText(cn,co+ag-1,aZ(self.symbol,self.width,"center"),self.bgColor,self.fgColor)else self.parent:writeText(cn,co+ag-1,aZ(" ",self.width,"center"),self.bgColor,self.fgColor)end end end end end end}return setmetatable(bO,cj)end;local function cr(bF)local cj=bE(bF)local bG="Dropdown"cj.width=12;cj.height=1;cj.bgColor=h.dropdownBG;cj.fgColor=h.dropdownFG;cj:setZIndex(6)local cs={}local ct=h.selectionBG;local cu=h.selectionFG;local cv=true;local cw="left"local cx=0;local cy=16;local cz=6;local cA="\16"local cB="\31"local cC=1;local bO={getType=function(self)return bG end,setIndexOffset=function(self,cD)cx=cD;return self end,getIndexOffset=function(self)return cx end,addItem=function(self,ar,aB,aC,...)table.insert(cs,{text=ar,bgCol=aB or self.bgColor,fgCol=aC or self.fgColor,args={...}})return self end,getAll=function(self)return cs end,removeItem=function(self,aK)table.remove(cs,aK)return self end,getItem=function(self,aK)return cs[aK]end,getItemIndex=function(self)local cE=self:getValue()for bp,aP in pairs(cs)do if aP==cE then return bp end end end,clear=function(self)cs={}self:setValue({})return self end,getItemCount=function(self)return#cs end,editItem=function(self,aK,ar,aB,aC,...)table.remove(cs,aK)table.insert(cs,aK,{text=ar,bgCol=aB or self.bgColor,fgCol=aC or self.fgColor,args={...}})return self end,selectItem=function(self,aK)self:setValue(cs[aK]or{})return self end,setSelectedItem=function(self,aB,aC,cF)ct=aB or self.bgColor;cu=aC or self.fgColor;cv=cF;return self end,setDropdownSize=function(self,a6,m)cy,cz=a6,m;return self end,mouseClickHandler=function(self,aL,c2,ap,aq)if cC==2 then local cn,co=self:getAbsolutePosition(self:getAnchorPosition())if aL=="mouse_click"and c2==1 or aL=="monitor_touch"then if#cs>0 then for ag=1,cz do if cs[ag+cx]~=nil then if cn<=ap and cn+cy>ap and co+ag==aq then self:setValue(cs[ag+cx])return true end end end end end;if aL=="mouse_scroll"then cx=cx+c2;if cx<0 then cx=0 end;if c2==1 then if#cs>cz then if cx>#cs-cz then cx=#cs-cz end else cx=cs-1 end end;return true end;self:setVisualChanged()end;if cj.mouseClickHandler(self,aL,c2,ap,aq)then cC=2 else cC=1 end end,draw=function(self)if cj.draw(self)then local cn,co=self:getAnchorPosition()if self.parent~=nil then self.parent:drawBackgroundBox(cn,co,self.width,self.height,self.bgColor)if#cs>=1 then if self:getValue()~=nil then if self:getValue().text~=nil then if cC==1 then self.parent:writeText(cn,co,aZ(self:getValue().text,self.width,cw):sub(1,self.width-1)..cA,self.bgColor,self.fgColor)else self.parent:writeText(cn,co,aZ(self:getValue().text,self.width,cw):sub(1,self.width-1)..cB,self.bgColor,self.fgColor)end end end;if cC==2 then for ag=1,cz do if cs[ag+cx]~=nil then if cs[ag+cx]==self:getValue()then if cv then self.parent:writeText(cn,co+ag,aZ(cs[ag+cx].text,cy,cw),ct,cu)else self.parent:writeText(cn,co+ag,aZ(cs[ag+cx].text,cy,cw),cs[ag+cx].bgCol,cs[ag+cx].fgCol)end else self.parent:writeText(cn,co+ag,aZ(cs[ag+cx].text,cy,cw),cs[ag+cx].bgCol,cs[ag+cx].fgCol)end end end end end end end end}return setmetatable(bO,cj)end;local function cG(bF)local cj=bE(bF)local bG="Image"cj:setZIndex(2)local cH;local cI;local cJ=false;local function b6()local b9={[0]={8,4,3,6,5},{4,14,8,7},{6,10,8,7},{9,11,8,0},{1,14,8,0},{13,12,8,0},{2,10,8,0},{15,8,10,11,12,14},{0,7,1,9,2,13},{3,11,8,7},{2,6,7,15},{9,3,7,15},{13,5,7,15},{5,12,8,7},{1,4,7,15},{7,10,11,12,14}}local ba,bb,bc={},{},{}for o=0,15 do bb[2^o]=o end;do local bd="0123456789abcdef"for o=1,16 do ba[bd:sub(o,o)]=o-1;ba[o-1]=bd:sub(o,o)bc[bd:sub(o,o)]=2^(o-1)bc[2^(o-1)]=bd:sub(o,o)local be=b9[o-1]for o=1,#be do be[o]=2^be[o]end end end;local function bf(bg)local bh=b9[bb[bg[#bg][1]]]for p=1,#bh do local bi=bh[p]for o=1,#bg-1 do if bg[o][1]==bi then return o end end end;return 1 end;local function bj(bk,bl)if not bl then local bm={}bl={}for o=1,6 do local bn=bk[o]local bo=bl[bn]bl[bn],bm[o]=bo and bo+1 or 1,bn end;bk=bm end;local bg={}for bp,aP in pairs(bl)do bg[#bg+1]={bp,aP}end;if#bg>1 then while#bg>2 do table.sort(bg,function(bq,br)return bq[2]>br[2]end)local bs,bt=bf(bg),#bg;local bu,bv=bg[bt][1],bg[bs][1]for o=1,6 do if bk[o]==bu then bk[o]=bv;bg[bs][2]=bg[bs][2]+1 end end;bg[bt]=nil end;local bw=128;for o=1,#bk-1 do if bk[o]~=bk[6]then bw=bw+2^(o-1)end end;return string.char(bw),bc[bg[1][1]==bk[6]and bg[2][1]or bg[1][1]],bc[bk[6]]else return"\128",bc[bk[1]],bc[bk[1]]end end;local bx,a6,m,aB={{},{},{}},0,#cH+#cH%3,cj.bgColor or colors.black;for o=1,#cH do if#cH[o]>a6 then a6=#cH[o]end end;for aq=0,m-1,3 do local by,bz,bA,bB={},{},{},1;for ap=0,a6-1,2 do local bk,bl={},{}for bC=1,3 do for bD=1,2 do bk[#bk+1]=cH[aq+bC]and cH[aq+bC][ap+bD]and(cH[aq+bC][ap+bD]==0 and aB or cH[aq+bC][ap+bD])or aB;bl[bk[#bk]]=bl[bk[#bk]]and bl[bk[#bk]]+1 or 1 end end;by[bB],bz[bB],bA[bB]=bj(bk,bl)bB=bB+1 end;bx[1][#bx[1]+1],bx[2][#bx[2]+1],bx[3][#bx[3]+1]=table.concat(by),table.concat(bz),table.concat(bA)end;bx.width,bx.height=#bx[1][1],#bx[1]cI=bx end;local bO={getType=function(self)return bG end,loadImage=function(self,aT)cH=paintutils.loadImage(aT)cJ=false;return self end,loadBlittleImage=function(self,aT)cJ=true;return self end,shrink=function(self)b6()cJ=true;return self end,draw=function(self)if cj.draw(self)then if self.parent~=nil then if cH~=nil then local cn,co=self:getAnchorPosition()if cJ then local b5,cK,cL=cI[1],cI[2],cI[3]for o=1,cI.height do local cM=b5[o]if type(cM)=="string"then self.parent:setText(cn,co+o-1,cM)self.parent:setFG(cn,co+o-1,cK[o])self.parent:setBG(cn,co+o-1,cL[o])elseif type(cM)=="table"then self.parent:setText(cn,co+o-1,cM[2])self.parent:setFG(cn,co+o-1,cK[o])self.parent:setBG(cn,co+o-1,cL[o])end end else for bT=1,math.min(#cH,self.height)do local cN=cH[bT]for bS=1,math.min(#cN,self.width)do if cN[bS]>0 then self.parent:drawBackgroundBox(cn+bS-1,co+bT-1,1,1,cN[bS])end end end end end end end end}return setmetatable(bO,cj)end;local function cO(bF)local cj=bE(bF)local bG="Input"local cP="text"local cQ=0;cj:setZIndex(5)cj:setValue("")cj.width=10;cj.height=1;cj.bgColor=h.InputBG;cj.fgColor=h.InputFG;local cR=1;local cS=1;local cT=""local cU;local cV;local cW=cT;local cX=false;local bO={getType=function(self)return bG end,setInputType=function(self,cY)if cY=="password"or cY=="number"or cY=="text"then cP=cY end;return self end,setDefaultText=function(self,ar,cZ,c_)cT=ar;cU=c_ or cU;cV=cZ or cV;if self:isFocused()then cW=""else cW=cT end;return self end,getInputType=function(self)return cP end,setValue=function(self,d0)cj.setValue(self,tostring(d0))if not cX then cR=tostring(d0):len()+1 end;return self end,getValue=function(self)local d0=cj.getValue(self)return cP=="number"and tonumber(d0)or d0 end,setInputLimit=function(self,d1)cQ=tonumber(d1)or cQ;return self end,getInputLimit=function(self)return cQ end,getFocusHandler=function(self)cj.getFocusHandler(self)if self.parent~=nil then local cn,co=self:getAnchorPosition()cW=""if self.parent~=nil then self.parent:setCursor(true,cn+cR-cS,co,self.fgColor)end end end,loseFocusHandler=function(self)cj.loseFocusHandler(self)if self.parent~=nil then self.parent:setCursor(false)cW=cT end end,keyHandler=function(self,aL,bp)if cj.keyHandler(self,aL,bp)then cX=true;if aL=="key"then if bp==keys.backspace then local ar=tostring(cj.getValue())if cR>1 then self:setValue(ar:sub(1,cR-2)..ar:sub(cR,ar:len()))if cR>1 then cR=cR-1 end;if cS>1 then if cR<cS then cS=cS-1 end end end end;if bp==keys.enter then if self.parent~=nil then end end;if bp==keys.right then local d2=tostring(cj.getValue()):len()cR=cR+1;if cR>d2 then cR=d2+1 end;if cR<1 then cR=1 end;if cR<cS or cR>=self.width+cS then cS=cR-self.width+1 end;if cS<1 then cS=1 end end;if bp==keys.left then cR=cR-1;if cR>=1 then if cR<cS or cR>=self.width+cS then cS=cR end end;if cR<1 then cR=1 end;if cS<1 then cS=1 end end end;if aL=="char"then local ar=cj.getValue()if ar:len()<cQ or cQ<=0 then if cP=="number"then local d3=ar;if bp=="."or tonumber(bp)~=nil then self:setValue(ar:sub(1,cR-1)..bp..ar:sub(cR,ar:len()))cR=cR+1 end;if tonumber(cj.getValue())==nil then self:setValue(d3)end else self:setValue(ar:sub(1,cR-1)..bp..ar:sub(cR,ar:len()))cR=cR+1 end;if cR>=self.width+cS then cS=cS+1 end end end;local cn,co=self:getAnchorPosition()local d0=tostring(cj.getValue())local d4=(cR<=d0:len()and cR-1 or d0:len())-(cS-1)if d4>self.x+self.width-1 then d4=self.x+self.width-1 end;if self.parent~=nil then self.parent:setCursor(true,cn+d4,co,self.fgColor)end;cX=false end end,mouseClickHandler=function(self,aL,c2,ap,aq)if cj.mouseClickHandler(self,aL,c2,ap,aq)then if aL=="mouse_click"and c2==1 then end;return true end;return false end,draw=function(self)if cj.draw(self)then if self.parent~=nil then local cn,co=self:getAnchorPosition()local cp=b2(self.height,"center")self.parent:drawBackgroundBox(cn,co,self.width,self.height,self.bgColor)for ag=1,self.height do if ag==cp then local d0=tostring(cj.getValue())local c_=self.bgColor;local cZ=self.fgColor;local ar;if d0:len()<=0 then ar=cW;c_=cU or c_;cZ=cV or cZ end;ar=cW;if d0~=""then ar=d0 end;ar=ar:sub(cS,self.width+cS-1)local d5=self.width-ar:len()if d5<0 then d5=0 end;if cP=="password"and d0~=""then ar=string.rep("*",ar:len())end;ar=ar..string.rep(" ",d5)self.parent:writeText(cn,co+ag-1,ar,c_,cZ)end end end end end}return setmetatable(bO,cj)end;local function d6(bF)local cj=bE(bF)local bG="Label"cj:setZIndex(3)cj.fgColor=colors.white;cj.bgcolor=colors.black;local d7=true;cj:setValue("")local ck="left"local cl="top"local d8=0;local bO={getType=function(self)return bG end,setText=function(self,ar)ar=tostring(ar)cj:setValue(ar)if d7 then self.width=ar:len()end;return self end,setTextAlign=function(self,d9,da)ck=d9 or ck;cl=da or cl;self:setVisualChanged()return self end,setFontSize=function(self,u)if u>0 and u<=4 then d8=u-1 or 0 end;return self end,getFontSize=function(self)return d8+1 end,setSize=function(self,a6,m)cj.setSize(self,a6,m)d7=false;self:setVisualChanged()return self end,draw=function(self)if cj.draw(self)then if self.parent~=nil then local cn,co=self:getAnchorPosition()local cp=b2(self.height,cl)self.parent:drawBackgroundBox(cn,co,self.width,self.height,self.bgColor)self.parent:drawForegroundBox(cn,co,self.width,self.height,self.fgColor)self.parent:drawTextBox(cn,co,self.width,self.height," ")if d8==0 then for ag=1,self.height do if ag==cp then self.parent:writeText(cn,co+ag-1,aZ(self:getValue(),self.width,ck),self.bgColor,self.fgColor)end end else local db=K(d8,self:getValue(),self.fgColor,self.bgColor)if d7 then self.height=#db[1]-1;self.width=#db[1][1]end;for ag=1,self.height do if ag==cp then local dc,dd=self.parent:getSize()local de,df=#db[1][1],#db[1]cn=cn or math.floor((dc-de)/2)+1;co=co or math.floor((dd-df)/2)+1;for o=1,df do self.parent:setFG(cn,co+o+ag-2,aZ(db[2][o],self.width,ck))self.parent:setBG(cn,co+o+ag-2,aZ(db[3][o],self.width,ck,g[self.bgColor]))self.parent:setText(cn,co+o+ag-2,aZ(db[1][o],self.width,ck))end end end end end end end}return setmetatable(bO,cj)end;local function dg(bF)local cj=bE(bF)local bG="List"cj.width=16;cj.height=6;cj.bgColor=h.listBG;cj.fgColor=h.listFG;cj:setZIndex(5)local cs={}local ct=h.selectionBG;local cu=h.selectionFG;local cv=true;local cw="left"local cx=0;local dh=true;local bO={getType=function(self)return bG end,addItem=function(self,ar,aB,aC,...)table.insert(cs,{text=ar,bgCol=aB or self.bgColor,fgCol=aC or self.fgColor,args={...}})if#cs==1 then self:setValue(cs[1])end;return self end,setIndexOffset=function(self,cD)cx=cD;return self end,getIndexOffset=function(self)return cx end,removeItem=function(self,aK)table.remove(cs,aK)return self end,getItem=function(self,aK)return cs[aK]end,getAll=function(self)return cs end,getItemIndex=function(self)local cE=self:getValue()for bp,aP in pairs(cs)do if aP==cE then return bp end end end,clear=function(self)cs={}self:setValue({})return self end,getItemCount=function(self)return#cs end,editItem=function(self,aK,ar,aB,aC,...)table.remove(cs,aK)table.insert(cs,aK,{text=ar,bgCol=aB or self.bgColor,fgCol=aC or self.fgColor,args={...}})return self end,selectItem=function(self,aK)self:setValue(cs[aK]or{})return self end,setSelectedItem=function(self,aB,aC,cF)ct=aB or self.bgColor;cu=aC or self.fgColor;cv=cF;return self end,setScrollable=function(self,di)dh=di;return self end,mouseClickHandler=function(self,aL,c2,ap,aq)local cn,co=self:getAbsolutePosition(self:getAnchorPosition())if cn<=ap and cn+self.width>ap and co<=aq and co+self.height>aq and self:isVisible()then if(aL=="mouse_click"or aL=="mouse_drag")and c2==1 or aL=="monitor_touch"then if#cs>0 then for ag=1,self.height do if cs[ag+cx]~=nil then if cn<=ap and cn+self.width>ap and co+ag-1==aq then self:setValue(cs[ag+cx])self:getEventSystem():sendEvent("mouse_click",self,"mouse_click",0,ap,aq,cs[ag+cx])end end end end end;if aL=="mouse_scroll"and dh then cx=cx+c2;if cx<0 then cx=0 end;if c2>=1 then if#cs>self.height then if cx>#cs-self.height then cx=#cs-self.height end;if cx>=#cs then cx=#cs-1 end else cx=cx-1 end end end;self:setVisualChanged()return true end end,draw=function(self)if cj.draw(self)then if self.parent~=nil then local cn,co=self:getAnchorPosition()self.parent:drawBackgroundBox(cn,co,self.width,self.height,self.bgColor)for ag=1,self.height do if cs[ag+cx]~=nil then if cs[ag+cx]==self:getValue()then if cv then self.parent:writeText(cn,co+ag-1,aZ(cs[ag+cx].text,self.width,cw),ct,cu)else self.parent:writeText(cn,co+ag-1,aZ(cs[ag+cx].text,self.width,cw),cs[ag+cx].bgCol,cs[ag+cx].fgCol)end else self.parent:writeText(cn,co+ag-1,aZ(cs[ag+cx].text,self.width,cw),cs[ag+cx].bgCol,cs[ag+cx].fgCol)end end end end end end}return setmetatable(bO,cj)end;local function dj(bF)local cj=bE(bF)local bG="Menubar"local bO={}cj.width=30;cj.height=1;cj.bgColor=colors.gray;cj.fgColor=colors.lightGray;cj:setZIndex(5)local cs={}local ct=h.selectionBG;local cu=h.selectionFG;local cv=true;local cw="left"local dk=0;local d5=2;local dh=false;local function dl()local dm=0;local bS=1;for ag=1,#cs do if bS+cs[ag].text:len()+d5*2>bO.w then dm=dm+cs[ag].text:len()+d5*2 end;bS=bS+cs[ag].text:len()+d5*2 end;return dm end;bO={getType=function(self)return bG end,addItem=function(self,ar,aB,aC,...)table.insert(cs,{text=ar,bgCol=aB or self.bgColor,fgCol=aC or self.fgColor,args={...}})if#cs==1 then self:setValue(cs[1])end;return self end,getAll=function(self)return cs end,getItemIndex=function(self)local cE=self:getValue()for bp,aP in pairs(cs)do if aP==cE then return bp end end end,clear=function(self)cs={}self:setValue({})return self end,setSpace=function(self,dn)d5=dn or d5;return self end,setButtonOffset=function(self,b1)dk=b1 or 0;if dk<0 then dk=0 end;local dm=dl()if dk>dm then dk=dm end;return self end,setScrollable=function(self,di)dh=di;return self end,removeItem=function(self,aK)table.remove(cs,aK)return self end,getItem=function(self,aK)return cs[aK]end,getItemCount=function(self)return#cs end,editItem=function(self,aK,ar,aB,aC,...)table.remove(cs,aK)table.insert(cs,aK,{text=ar,bgCol=aB or self.bgColor,fgCol=aC or self.fgColor,args={...}})return self end,selectItem=function(self,aK)self:setValue(cs[aK]or{})return self end,setSelectedItem=function(self,aB,aC,cF)ct=aB or self.bgColor;cu=aC or self.fgColor;cv=cF;return self end,mouseClickHandler=function(self,aL,c2,ap,aq)local c3,c4=self:getAbsolutePosition(self:getAnchorPosition())if c3<=ap and c3+self.width>ap and c4<=aq and c4+self.height>aq and self:isVisible()then if self.parent~=nil then self.parent:setFocusedObject(self)end;if aL=="mouse_click"or aL=="monitor_touch"then local bS=1;for ag=1+dk,#cs do if cs[ag]~=nil then if bS+cs[ag].text:len()+d5*2<=self.width then if c3+bS-1<=ap and c3+bS-1+cs[ag].text:len()+d5*2>ap and c4==aq then self:setValue(cs[ag])self:getEventSystem():sendEvent("mouse_click",self,"mouse_click",0,ap,aq,cs[ag])end;bS=bS+cs[ag].text:len()+d5*2 else break end end end end;if aL=="mouse_scroll"and dh then dk=dk+c2;if dk<0 then dk=0 end;local dm=dl()if dk>dm then dk=dm end end;return true end;return false end,draw=function(self)if cj.draw(self)then if self.parent~=nil then local cn,co=self:getAnchorPosition()self.parent:drawBackgroundBox(cn,co,self.width,self.height,self.bgColor)local bS=0;for aO,aP in pairs(cs)do if bS+aP.text:len()+d5*2<=self.width then if aP==self:getValue()then self.parent:writeText(cn+bS-1+-dk,co,aZ((" "):rep(d5)..aP.text..(" "):rep(d5),aP.text:len()+d5*2,cw),ct or aP.bgCol,cu or aP.fgCol)else self.parent:writeText(cn+bS-1+-dk,co,aZ((" "):rep(d5)..aP.text..(" "):rep(d5),aP.text:len()+d5*2,cw),aP.bgCol,aP.fgCol)end;bS=bS+aP.text:len()+d5*2 else if bS<self.width+dk then if aP==self:getValue()then self.parent:writeText(cn+bS-1+-dk,co,aZ((" "):rep(d5)..aP.text..(" "):rep(d5),aP.text:len()+d5*2,cw):sub(1,self.width+dk-bS),ct or aP.bgCol,cu or aP.fgCol)else self.parent:writeText(cn+bS-1+-dk,co,aZ((" "):rep(d5)..aP.text..(" "):rep(d5),aP.text:len()+d5*2,cw):sub(1,self.width+dk-bS),aP.bgCol,aP.fgCol)end;bS=bS+aP.text:len()+d5*2 end end end end end end}return setmetatable(bO,cj)end;local function dp(bF)local cj=bE(bF)local bG="Pane"local bO={getType=function(self)return bG end,draw=function(self)if cj.draw(self)then if self.parent~=nil then local cn,co=self:getAnchorPosition()self.parent:drawBackgroundBox(cn,co,self.width,self.height,self.bgColor)self.parent:drawForegroundBox(cn,co,self.width,self.height,self.bgColor)end end end}return setmetatable(bO,cj)end;local function dq(bF)local cj=bE(bF)local bG="Program"cj:setZIndex(5)local bO;local function dr(ap,aq,a6,m)local ds,dt=1,1;local b8,du=colors.black,colors.white;local dv=false;local dw=false;local a7={}local a8={}local a9={}local dx={}local ad;local ae={}for o=0,15 do local dy=2^o;dx[dy]={e.getPaletteColour(dy)}end;local function af()ad=(" "):rep(a6)for ag=0,15 do local ah=2^ag;local ai=g[ah]ae[ah]=ai:rep(a6)end end;local function aj()af()local ak=ad;local al=ae[colors.white]local am=ae[colors.black]for ag=1,m do a7[ag]=f(a7[ag]==nil and ak or a7[ag]..ak:sub(1,a6-a7[ag]:len()),1,a6)a9[ag]=f(a9[ag]==nil and al or a9[ag]..al:sub(1,a6-a9[ag]:len()),1,a6)a8[ag]=f(a8[ag]==nil and am or a8[ag]..am:sub(1,a6-a8[ag]:len()),1,a6)end end;aj()local function dz()if ds>=1 and dt>=1 and ds<=a6 and dt<=m then else end end;local function dA(dB,dC,dD)local dE=ds;local au=dE+#dB-1;if dt>=1 and dt<=m then if dE<=a6 and au>=1 then if dE==1 and au==a6 then a7[dt]=dB;a9[dt]=dC;a8[dt]=dD else local dF,dG,dH;if dE<1 then local dI=1-dE+1;local dJ=a6-dE+1;dF=f(dB,dI,dJ)dG=f(dC,dI,dJ)dH=f(dD,dI,dJ)elseif au>a6 then local dJ=a6-dE+1;dF=f(dB,1,dJ)dG=f(dC,1,dJ)dH=f(dD,1,dJ)else dF=dB;dG=dC;dH=dD end;local dK=a7[dt]local dL=a9[dt]local dM=a8[dt]local dN,dO,dP;if dE>1 then local dQ=dE-1;dN=f(dK,1,dQ)..dF;dO=f(dL,1,dQ)..dG;dP=f(dM,1,dQ)..dH else dN=dF;dO=dG;dP=dH end;if au<a6 then local dR=au+1;dN=dN..f(dK,dR,a6)dO=dO..f(dL,dR,a6)dP=dP..f(dM,dR,a6)end;a7[dt]=dN;a9[dt]=dO;a8[dt]=dP end end;ds=au+1;if dw then dz()end end end;local function ao(dS,dT,ar)if ar~=nil then local dU=a7[dT]if dU~=nil then a7[dT]=f(dU:sub(1,dS-1)..ar..dU:sub(dS+ar:len(),a6),1,a6)end end end;local function ax(dS,dT,ay)if ay~=nil then local dV=a8[dT]if dV~=nil then a8[dT]=f(dV:sub(1,dS-1)..ay..dV:sub(dS+ay:len(),a6),1,a6)end end end;local function az(dS,dT,ay)if ay~=nil then local dW=a9[dT]if dW~=nil then a9[dT]=f(dW:sub(1,dS-1)..ay..dW:sub(dS+ay:len(),a6),1,a6)end end end;local dX=function(bW)if type(bW)~="number"then error("bad argument #1 (expected number, got "..type(bW)..")",2)elseif g[bW]==nil then error("Invalid color (got "..bW..")",2)end;du=bW end;local dY=function(bW)if type(bW)~="number"then error("bad argument #1 (expected number, got "..type(bW)..")",2)elseif g[bW]==nil then error("Invalid color (got "..bW..")",2)end;b8=bW end;local dZ=function(d_,e0,e1,br)if type(d_)~="number"then error("bad argument #1 (expected number, got "..type(d_)..")",2)end;if g[d_]==nil then error("Invalid color (got "..d_..")",2)end;local e2;if type(e0)=="number"and e1==nil and br==nil then e2={colours.rgb8(e0)}dx[d_]=e2 else if type(e0)~="number"then error("bad argument #2 (expected number, got "..type(e0)..")",2)end;if type(e1)~="number"then error("bad argument #3 (expected number, got "..type(e1)..")",2)end;if type(br)~="number"then error("bad argument #4 (expected number, got "..type(br)..")",2)end;e2=dx[d_]e2[1]=e0;e2[2]=e1;e2[3]=br end end;local e3=function(d_)if type(d_)~="number"then error("bad argument #1 (expected number, got "..type(d_)..")",2)end;if g[d_]==nil then error("Invalid color (got "..d_..")",2)end;local e2=dx[d_]return e2[1],e2[2],e2[3]end;local e4={setCursorPos=function(dS,dT)if type(dS)~="number"then error("bad argument #1 (expected number, got "..type(dS)..")",2)end;if type(dT)~="number"then error("bad argument #2 (expected number, got "..type(dT)..")",2)end;ds=math.floor(dS)dt=math.floor(dT)if dw then dz()end end,getCursorPos=function()return ds,dt end,setCursorBlink=function(e5)if type(e5)~="boolean"then error("bad argument #1 (expected boolean, got "..type(e5)..")",2)end;dv=e5 end,getCursorBlink=function()return dv end,getPaletteColor=e3,getPaletteColour=e3,setBackgroundColor=dY,setBackgroundColour=dY,setTextColor=dX,setTextColour=dX,setPaletteColor=dZ,setPaletteColour=dZ,getBackgroundColor=function()return b8 end,getBackgroundColour=function()return b8 end,getSize=function()return a6,m end,getTextColor=function()return du end,getTextColour=function()return du end,basalt_resize=function(e6,e7)a6,m=e6,e7;aj()end,basalt_reposition=function(dS,dT)ap,aq=dS,dT end,basalt_setVisible=function(e8)dw=e8 end,drawBackgroundBox=function(dS,dT,e6,e7,aB)for ag=1,e7 do ax(dS,dT+ag-1,g[aB]:rep(e6))end end,drawForegroundBox=function(dS,dT,e6,e7,aC)for ag=1,e7 do az(dS,dT+ag-1,g[aC]:rep(e6))end end,drawTextBox=function(dS,dT,e6,e7,aD)for ag=1,e7 do ao(dS,dT+ag-1,aD:rep(e6))end end,writeText=function(dS,dT,ar,aB,aC)aB=aB or b8;aC=aC or du;ao(ap,dT,ar)ax(dS,dT,g[aB]:rep(ar:len()))az(dS,dT,g[aC]:rep(ar:len()))end,basalt_update=function()if bO.parent~=nil then for ag=1,m do bO.parent:setText(ap,aq+ag-1,a7[ag])bO.parent:setBG(ap,aq+ag-1,a8[ag])bO.parent:setFG(ap,aq+ag-1,a9[ag])end end end,scroll=function(b1)if type(b1)~="number"then error("bad argument #1 (expected number, got "..type(b1)..")",2)end;if b1~=0 then local e9=ad;local ea=ae[du]local eb=ae[b8]for ec=1,m do local aq=ec+b1;if aq>=1 and aq<=m then a7[ec]=a7[aq]a8[ec]=a8[aq]a9[ec]=a9[aq]else a7[ec]=e9;a9[ec]=ea;a8[ec]=eb end end end;if dw then dz()end end,isColor=function()return e.isColor()end,isColour=function()return e.isColor()end,write=function(ar)ar=tostring(ar)if dw then dA(ar,g[du]:rep(ar:len()),g[b8]:rep(ar:len()))end end,clearLine=function()if dw then ao(1,dt,(" "):rep(a6))ax(1,dt,g[b8]:rep(a6))az(1,dt,g[du]:rep(a6))end;if dw then dz()end end,clear=function()for ag=1,m do ao(1,ag,(" "):rep(a6))ax(1,ag,g[b8]:rep(a6))az(1,ag,g[du]:rep(a6))end;if dw then dz()end end,blit=function(ar,ed,ee)if type(ar)~="string"then error("bad argument #1 (expected string, got "..type(ar)..")",2)end;if type(ed)~="string"then error("bad argument #2 (expected string, got "..type(ed)..")",2)end;if type(ee)~="string"then error("bad argument #3 (expected string, got "..type(ee)..")",2)end;if#ed~=#ar or#ee~=#ar then error("Arguments must be the same length",2)end;if dw then dA(ar,ed,ee)end end}return e4 end;cj.width=30;cj.height=12;local ef=dr(1,1,cj.width,cj.height)local eg;local eh=false;local ei={}bO={getType=function(self)return bG end,show=function(self)cj.show(self)ef.setBackgroundColor(self.bgColor)ef.setTextColor(self.fgColor)ef.basalt_setVisible(true)return self end,hide=function(self)cj.hide(self)ef.basalt_setVisible(false)return self end,setPosition=function(self,ap,aq,bU)cj.setPosition(self,ap,aq,bU)ef.basalt_reposition(self:getAnchorPosition())return self end,getBasaltWindow=function()return ef end,getBasaltProcess=function()return eg end,setSize=function(self,a6,m)cj.setSize(self,a6,m)ef.basalt_resize(self.width,self.height)return self end,getStatus=function(self)if eg~=nil then return eg:getStatus()end;return"inactive"end,execute=function(self,aT,...)eg=aR:new(aT,ef,...)ef.setBackgroundColor(colors.black)ef.setTextColor(colors.white)ef.clear()ef.setCursorPos(1,1)eg:resume()eh=false;return self end,stop=function(self)if eg~=nil then if not eg:isDead()then eg:resume("terminate")if eg:isDead()then if self.parent~=nil then self.parent:setCursor(false)end end end end;return self end,pause=function(self,ej)eh=ej or not eh;if eg~=nil then if not eg:isDead()then if not eh then self:injectEvents(ei)ei={}end end end;return self end,isPaused=function(self)return eh end,injectEvent=function(self,aL,c5,c6,c7,c8,ek)if eg~=nil then if not eg:isDead()then if eh==false or ek then eg:resume(aL,c5,c6,c7,c8)else table.insert(ei,{event=aL,args={c5,c6,c7,c8}})end end end;return self end,getQueuedEvents=function(self)return ei end,updateQueuedEvents=function(self,aJ)ei=aJ or ei;return self end,injectEvents=function(self,aJ)if eg~=nil then if not eg:isDead()then for aO,aP in pairs(aJ)do eg:resume(aP.event,table.unpack(aP.args))end end end;return self end,mouseClickHandler=function(self,aL,c2,ap,aq)if cj.mouseClickHandler(self,aL,c2,ap,aq)then if eg==nil then return false end;if not eg:isDead()then if not eh then local el,em=self:getAbsolutePosition(self:getAnchorPosition(nil,nil,true))eg:resume(aL,c2,ap-el+1,aq-em+1)end end;return true end end,keyHandler=function(self,aL,bp)cj.keyHandler(self,aL,bp)if self:isFocused()then if eg==nil then return false end;if not eg:isDead()then if not eh then if self.draw then eg:resume(aL,bp)end end end end end,getFocusHandler=function(self)cj.getFocusHandler(self)if eg~=nil then if not eg:isDead()then if not eh then if self.parent~=nil then local en,eo=ef.getCursorPos()local cn,co=self:getAnchorPosition()if self.parent~=nil then if cn+en-1>=1 and cn+en-1<=cn+self.width-1 and eo+co-1>=1 and eo+co-1<=co+self.height-1 then self.parent:setCursor(ef.getCursorBlink(),cn+en-1,eo+co-1,ef.getTextColor())end end end end end end end,loseFocusHandler=function(self)cj.loseFocusHandler(self)if eg~=nil then if not eg:isDead()then if self.parent~=nil then self.parent:setCursor(false)end end end end,eventHandler=function(self,aL,c5,c6,c7,c8)if eg==nil then return end;if not eg:isDead()then if not eh then if aL~="mouse_click"and aL~="monitor_touch"and aL~="mouse_up"and aL~="mouse_scroll"and aL~="mouse_drag"and aL~="key_up"and aL~="key"and aL~="char"and aL~="terminate"then eg:resume(aL,c5,c6,c7,c8)end;if self:isFocused()then local cn,co=self:getAnchorPosition()local en,eo=ef.getCursorPos()if self.parent~=nil then if cn+en-1>=1 and cn+en-1<=cn+self.width-1 and eo+co-1>=1 and eo+co-1<=co+self.height-1 then self.parent:setCursor(ef.getCursorBlink(),cn+en-1,eo+co-1,ef.getTextColor())end end;if aL=="terminate"and self:isFocused()then self:stop()end end else if aL~="mouse_click"and aL~="monitor_touch"and aL~="mouse_up"and aL~="mouse_scroll"and aL~="mouse_drag"and aL~="key_up"and aL~="key"and aL~="char"and aL~="terminate"then table.insert(ei,{event=aL,args={c5,c6,c7,c8}})end end end end,draw=function(self)if cj.draw(self)then if self.parent~=nil then local cn,co=self:getAnchorPosition()ef.basalt_reposition(cn,co)self.parent:drawBackgroundBox(cn,co,self.width,self.height,self.bgColor)ef.basalt_update()end end end}return setmetatable(bO,cj)end;local function ep(bF)local cj=bE(bF)local bG="Progressbar"local eq=0;cj:setZIndex(5)cj:setValue(false)cj.width=25;cj.height=1;cj.bgColor=h.CheckboxBG;cj.fgColor=h.CheckboxFG;local er=colors.black;local es=""local et=colors.white;local eu=""local ev=0;local bO={getType=function(self)return bG end,setDirection=function(self,ew)ev=ew;return self end,setProgressBar=function(self,bW,aD,ex)er=bW or er;es=aD or es;et=ex or et;return self end,setBackgroundSymbol=function(self,aD)eu=aD:sub(1,1)return self end,setProgress=function(self,aP)if aP>=0 and aP<=100 and eq~=aP then eq=aP;self:setValue(eq)if eq==100 then self:progressDoneHandler()end end;return self end,getProgress=function(self)return eq end,onProgressDone=function(self,x)self:registerEvent("progress_done",x)return self end,progressDoneHandler=function(self)self:sendEvent("progress_done")end,draw=function(self)if cj.draw(self)then if self.parent~=nil then local cn,co=self:getAnchorPosition()self.parent:drawBackgroundBox(cn,co,self.width,self.height,self.bgColor)self.parent:drawForegroundBox(cn,co,self.width,self.height,self.fgColor)self.parent:drawTextBox(cn,co,self.width,self.height,eu)if ev==1 then self.parent:drawBackgroundBox(cn,co,self.width,self.height/100*eq,er)self.parent:drawForegroundBox(cn,co,self.width,self.height/100*eq,et)self.parent:drawTextBox(cn,co,self.width,self.height/100*eq,es)elseif ev==2 then self.parent:drawBackgroundBox(cn,co+math.ceil(self.height-self.height/100*eq),self.width,self.height/100*eq,er)self.parent:drawForegroundBox(cn,co+math.ceil(self.height-self.height/100*eq),self.width,self.height/100*eq,et)self.parent:drawTextBox(cn,co+math.ceil(self.height-self.height/100*eq),self.width,self.height/100*eq,es)elseif ev==3 then self.parent:drawBackgroundBox(cn+math.ceil(self.width-self.width/100*eq),co,self.width/100*eq,self.height,er)self.parent:drawForegroundBox(cn+math.ceil(self.width-self.width/100*eq),co,self.width/100*eq,self.height,et)self.parent:drawTextBox(cn+math.ceil(self.width-self.width/100*eq),co,self.width/100*eq,self.height,es)else self.parent:drawBackgroundBox(cn,co,self.width/100*eq,self.height,er)self.parent:drawForegroundBox(cn,co,self.width/100*eq,self.height,et)self.parent:drawTextBox(cn,co,self.width/100*eq,self.height,es)end end end end}return setmetatable(bO,cj)end;local function ey(bF)local cj=bE(bF)local bG="Radio"cj.width=8;cj.bgColor=h.listBG;cj.fgColor=h.listFG;cj:setZIndex(5)local cs={}local ct=h.selectionBG;local cu=h.selectionFG;local ez=cj.bgColor;local eA=cj.fgColor;local cv=true;local aD="\7"local cw="left"local bO={getType=function(self)return bG end,addItem=function(self,ar,ap,aq,aB,aC,...)table.insert(cs,{x=ap or 1,y=aq or 1,text=ar,bgCol=aB or self.bgColor,fgCol=aC or self.fgColor,args={...}})if#cs==1 then self:setValue(cs[1])end;return self end,getAll=function(self)return cs end,removeItem=function(self,aK)table.remove(cs,aK)return self end,getItem=function(self,aK)return cs[aK]end,getItemIndex=function(self)local cE=self:getValue()for bp,aP in pairs(cs)do if aP==cE then return bp end end end,clear=function(self)cs={}self:setValue({})return self end,getItemCount=function(self)return#cs end,editItem=function(self,aK,ar,ap,aq,aB,aC,...)table.remove(cs,aK)table.insert(cs,aK,{x=ap or 1,y=aq or 1,text=ar,bgCol=aB or self.bgColor,fgCol=aC or self.fgColor,args={...}})return self end,selectItem=function(self,aK)self:setValue(cs[aK]or{})return self end,setSelectedItem=function(self,aB,aC,eB,eC,cF)ct=aB or ct;cu=aC or cu;ez=eB or ez;eA=eC or eA;cv=cF;return self end,mouseClickHandler=function(self,aL,c2,ap,aq)local cn,co=self:getAbsolutePosition(self:getAnchorPosition())if aL=="mouse_click"and c2==1 or aL=="monitor_touch"then if#cs>0 then for aO,aP in pairs(cs)do if cn+aP.x-1<=ap and cn+aP.x-1+aP.text:len()+2>=ap and co+aP.y-1==aq then self:setValue(aP)if self.parent~=nil then self.parent:setFocusedObject(self)end;self:setVisualChanged()return true end end end end;return false end,draw=function(self)if cj.draw(self)then if self.parent~=nil then local cn,co=self:getAnchorPosition()for aO,aP in pairs(cs)do if aP==self:getValue()then if cw=="left"then self.parent:writeText(aP.x+cn-1,aP.y+co-1,aD,ez,eA)self.parent:writeText(aP.x+2+cn-1,aP.y+co-1,aP.text,ct,cu)end else self.parent:drawBackgroundBox(aP.x+cn-1,aP.y+co-1,1,1,self.bgColor)self.parent:writeText(aP.x+2+cn-1,aP.y+co-1,aP.text,aP.bgCol,aP.fgCol)end end end end end}return setmetatable(bO,cj)end;local function eD(bF)local cj=bE(bF)local bG="Scrollbar"cj.width=1;cj.height=8;cj.bgColor=colors.lightGray;cj.fgColor=colors.gray;cj:setValue(1)cj:setZIndex(2)local eE="vertical"local aD=" "local eF=colors.black;local eG="\127"local eH=cj.height;local aK=1;local eI=1;local bO={getType=function(self)return bG end,setSymbol=function(self,eJ)aD=eJ:sub(1,1)self:setVisualChanged()return self end,setSymbolSize=function(self,u)eI=tonumber(u)or 1;if eE=="vertical"then self:setValue(aK-1*eH/(self.height-(eI-1))-eH/(self.height-(eI-1)))elseif eE=="horizontal"then self:setValue(aK-1*eH/(self.width-(eI-1))-eH/(self.width-(eI-1)))end;self:setVisualChanged()return self end,setMaxValue=function(self,d0)eH=d0;return self end,setBackgroundSymbol=function(self,eK)eG=string.sub(eK,1,1)self:setVisualChanged()return self end,setSymbolColor=function(self,eL)eF=eL;self:setVisualChanged()return self end,setBarType=function(self,eM)eE=eM:lower()return self end,mouseClickHandler=function(self,aL,c2,ap,aq)if cj.mouseClickHandler(self,aL,c2,ap,aq)then local cn,co=self:getAbsolutePosition(self:getAnchorPosition())if(aL=="mouse_click"or aL=="mouse_drag")and c2==1 or aL=="monitor_touch"then if eE=="horizontal"then for eN=0,self.width do if cn+eN==ap and co<=aq and co+self.height>aq then aK=math.min(eN+1,self.width-(eI-1))self:setValue(eH/self.width*aK)self:setVisualChanged()end end end;if eE=="vertical"then for eN=0,self.height do if co+eN==aq and cn<=ap and cn+self.width>ap then aK=math.min(eN+1,self.height-(eI-1))self:setValue(eH/self.height*aK)self:setVisualChanged()end end end end;if aL=="mouse_scroll"then aK=aK+c2;if aK<1 then aK=1 end;aK=math.min(aK,(eE=="vertical"and self.height or self.width)-(eI-1))self:setValue(eH/(eE=="vertical"and self.height or self.width)*aK)end;return true end end,draw=function(self)if cj.draw(self)then if self.parent~=nil then local cn,co=self:getAnchorPosition()if eE=="horizontal"then self.parent:writeText(cn,co,eG:rep(aK-1),self.bgColor,self.fgColor)self.parent:writeText(cn+aK-1,co,aD:rep(eI),eF,eF)self.parent:writeText(cn+aK+eI-1,co,eG:rep(self.width-(aK+eI-1)),self.bgColor,self.fgColor)end;if eE=="vertical"then for ag=0,self.height-1 do if aK==ag+1 then for eO=0,math.min(eI-1,self.height)do self.parent:writeText(cn,co+ag+eO,aD,eF,eF)end else if ag+1<aK or ag+1>aK-1+eI then self.parent:writeText(cn,co+ag,eG,self.bgColor,self.fgColor)end end end end end end end}return setmetatable(bO,cj)end;local function eP(bF)local cj=bE(bF)local bG="Slider"cj.width=8;cj.bgColor=colors.lightGray;cj.fgColor=colors.gray;cj:setValue(1)local eE="horizontal"local aD=" "local eF=colors.black;local eG="\140"local eH=cj.width;local aK=1;local bO={getType=function(self)return bG end,setSymbol=function(self,eJ)aD=eJ:sub(1,1)self:setVisualChanged()return self end,setBackgroundSymbol=function(self,eK)eG=string.sub(eK,1,1)self:setVisualChanged()return self end,setSymbolColor=function(self,eL)eF=eL;self:setVisualChanged()return self end,setBarType=function(self,eM)eE=eM:lower()return self end,setValue=function(self,d0)aK=math.floor(d0/eH)if eE=="horizontal"then if aK<1 then aK=1 elseif aK>self.width then aK=self.width end;cj.setValue(self,eH/self.width*aK)elseif eE=="vertical"then if aK<1 then aK=1 elseif aK>self.height then aK=self.height end;cj.setValue(self,eH/self.height*aK)end;return self end,setIndex=function(self,eN)if eE=="horizontal"then if eN>=1 and eN<=self.width then aK=eN;cj.setValue(self,eH/self.width*aK)end elseif eE=="vertical"then if eN>=1 and eN<=self.height then aK=eN;cj.setValue(self,eH/self.height*aK)end end;return self end,mouseClickHandler=function(self,aL,c2,ap,aq)if cj.mouseClickHandler(self,aL,c2,ap,aq)then local cn,co=self:getAbsolutePosition(self:getAnchorPosition())if eE=="horizontal"then for eN=0,self.width-1 do if cn+eN==ap and co<=aq and co+self.height>aq then aK=eN+1;cj.setValue(self,eH/self.width*aK)self:setVisualChanged()end end end;if eE=="vertical"then for eN=0,self.height-1 do if co+eN==aq and cn<=ap and cn+self.width>ap then aK=eN+1;cj.setValue(self,eH/self.height*aK)self:setVisualChanged()end end end end end,draw=function(self)if cj.draw(self)then if self.parent~=nil then local cn,co=self:getAnchorPosition()if eE=="horizontal"then self.parent:writeText(cn,co,eG:rep(aK-1),self.bgColor,self.fgColor)self.parent:writeText(cn+aK-1,co,aD,eF,eF)self.parent:writeText(cn+aK,co,eG:rep(self.width-aK),self.bgColor,self.fgColor)end;if eE=="vertical"then for ag=0,self.height-1 do if ag+1==aK then self.parent:writeText(cn,co+ag,aD,eF,eF)else self.parent:writeText(cn,co+ag,eG,self.bgColor,self.fgColor)end end end end end end}return setmetatable(bO,cj)end;local function eQ(bF)local cj=bE(bF)local bG="Switch"cj.width=3;cj.height=1;cj.bgColor=colors.lightGray;cj.fgColor=colors.gray;cj:setValue(false)cj:setZIndex(5)local bO={getType=function(self)return bG end,mouseClickHandler=function(self,aL,c2,ap,aq)if cj.mouseClickHandler(self,aL,c2,ap,aq)then local cn,co=self:getAbsolutePosition(self:getAnchorPosition())if(aL=="mouse_click"or aL=="mouse_drag")and c2==1 or aL=="monitor_touch"then end;return true end end,draw=function(self)if cj.draw(self)then if self.parent~=nil then local cn,co=self:getAnchorPosition()end end end}return setmetatable(bO,cj)end;local function eR(bF)local cj=bE(bF)local bG="Textfield"local eS,cS,cR,eT=1,1,1,1;local eU={""}local eV={[colors.purple]={"break"}}cj.width=20;cj.height=8;cj.bgColor=h.textfieldBG;cj.fgColor=h.textfieldFG;cj:setZIndex(5)local bO={getType=function(self)return bG end,getLines=function(self)return eU end,getLine=function(self,aK)return eU[aK]or""end,editLine=function(self,aK,ar)eU[aK]=ar or eU[aK]return self end,addLine=function(self,ar,aK)if aK~=nil then table.insert(eU,aK,ar)else table.insert(eU,ar)end;return self end,addKeyword=function(self,eW,bW)end,removeLine=function(self,aK)table.remove(eU,aK or#eU)if#eU<=0 then table.insert(eU,"")end;return self end,getTextCursor=function(self)return cR,eT end,getFocusHandler=function(self)cj.getFocusHandler(self)if self.parent~=nil then local cn,co=self:getAnchorPosition()if self.parent~=nil then self.parent:setCursor(true,cn+cR-cS,co+eT-eS,self.fgColor)end end end,loseFocusHandler=function(self)cj.loseFocusHandler(self)if self.parent~=nil then self.parent:setCursor(false)end end,keyHandler=function(self,aL,bp)if cj.keyHandler(self,aL,bp)then local cn,co=self:getAnchorPosition()if aL=="key"then if bp==keys.backspace then if eU[eT]==""then if eT>1 then table.remove(eU,eT)cR=eU[eT-1]:len()+1;cS=cR-self.width+1;if cS<1 then cS=1 end;eT=eT-1 end elseif cR<=1 then if eT>1 then cR=eU[eT-1]:len()+1;cS=cR-self.width+1;if cS<1 then cS=1 end;eU[eT-1]=eU[eT-1]..eU[eT]table.remove(eU,eT)eT=eT-1 end else eU[eT]=eU[eT]:sub(1,cR-2)..eU[eT]:sub(cR,eU[eT]:len())if cR>1 then cR=cR-1 end;if cS>1 then if cR<cS then cS=cS-1 end end end;if eT<eS then eS=eS-1 end;self:setValue("")end;if bp==keys.delete then if cR>eU[eT]:len()then if eU[eT+1]~=nil then eU[eT]=eU[eT]..eU[eT+1]table.remove(eU,eT+1)end else eU[eT]=eU[eT]:sub(1,cR-1)..eU[eT]:sub(cR+1,eU[eT]:len())end end;if bp==keys.enter then table.insert(eU,eT+1,eU[eT]:sub(cR,eU[eT]:len()))eU[eT]=eU[eT]:sub(1,cR-1)eT=eT+1;cR=1;cS=1;if eT-eS>=self.height then eS=eS+1 end;self:setValue("")end;if bp==keys.up then if eT>1 then eT=eT-1;if cR>eU[eT]:len()+1 then cR=eU[eT]:len()+1 end;if cS>1 then if cR<cS then cS=cR-self.width+1;if cS<1 then cS=1 end end end;if eS>1 then if eT<eS then eS=eS-1 end end end end;if bp==keys.down then if eT<#eU then eT=eT+1;if cR>eU[eT]:len()+1 then cR=eU[eT]:len()+1 end;if eT>=eS+self.height then eS=eS+1 end end end;if bp==keys.right then cR=cR+1;if eT<#eU then if cR>eU[eT]:len()+1 then cR=1;eT=eT+1 end elseif cR>eU[eT]:len()then cR=eU[eT]:len()+1 end;if cR<1 then cR=1 end;if cR<cS or cR>=self.width+cS then cS=cR-self.width+1 end;if cS<1 then cS=1 end end;if bp==keys.left then cR=cR-1;if cR>=1 then if cR<cS or cR>=self.width+cS then cS=cR end end;if eT>1 then if cR<1 then eT=eT-1;cR=eU[eT]:len()+1;cS=cR-self.width+1 end end;if cR<1 then cR=1 end;if cS<1 then cS=1 end end end;if aL=="char"then eU[eT]=eU[eT]:sub(1,cR-1)..bp..eU[eT]:sub(cR,eU[eT]:len())cR=cR+1;if cR>=self.width+cS then cS=cS+1 end;self:setValue("")end;local d4=(cR<=eU[eT]:len()and cR-1 or eU[eT]:len())-(cS-1)if d4>self.x+self.width-1 then d4=self.x+self.width-1 end;local eX=eT-eS<self.height and eT-eS or eT-eS-1;if d4<1 then d4=0 end;self.parent:setCursor(true,cn+d4,co+eX,self.fgColor)return true end end,mouseClickHandler=function(self,aL,c2,ap,aq)if cj.mouseClickHandler(self,aL,c2,ap,aq)then local cn,co=self:getAbsolutePosition(self:getAnchorPosition())local eY,eZ=self:getAnchorPosition()if aL=="mouse_click"or aL=="monitor_touch"then if eU[aq-co+eS]~=nil then cR=ap-cn+cS;eT=aq-co+eS;if cR>eU[eT]:len()then cR=eU[eT]:len()+1 end;if cR<cS then cS=cR-1;if cS<1 then cS=1 end end;if self.parent~=nil then self.parent:setCursor(true,eY+cR-cS,eZ+eT-eS)end end end;if aL=="mouse_drag"then if eU[aq-co+eS]~=nil then cR=ap-cn+cS;eT=aq-co+eS;if cR>eU[eT]:len()then cR=eU[eT]:len()+1 end;if cR<cS then cS=cR-1;if cS<1 then cS=1 end end;if self.parent~=nil then self.parent:setCursor(true,eY+cR-cS,eZ+eT-eS)end end end;if aL=="mouse_scroll"then eS=eS+c2;if eS>#eU-(self.height-1)then eS=#eU-(self.height-1)end;if eS<1 then eS=1 end;if self.parent~=nil then if cn+cR-cS>=cn and cn+cR-cS<=cn+self.width and(co+eT-eS>=co and co+eT-eS<=co+self.height)then self.parent:setCursor(true,eY+cR-cS,eZ+eT-eS)else self.parent:setCursor(false)end end end;self:setVisualChanged()return true end end,draw=function(self)if cj.draw(self)then if self.parent~=nil then local cn,co=self:getAnchorPosition()self.parent:drawBackgroundBox(cn,co,self.width,self.height,self.bgColor)self.parent:drawForegroundBox(cn,co,self.width,self.height,self.fgColor)for ag=1,self.height do local ar=""if eU[ag+eS-1]~=nil then ar=eU[ag+eS-1]end;ar=ar:sub(cS,self.width+cS-1)local d5=self.width-ar:len()if d5<0 then d5=0 end;ar=ar..string.rep(" ",d5)self.parent:setText(cn,co+ag-1,ar)end end end end}return setmetatable(bO,cj)end;local function e_(bF)local bO;local bG="Thread"local aN;local f0;local f1=false;bO={name=bF,getType=function(self)return bG end,getZIndex=function(self)return 1 end,getName=function(self)return self.name end,start=function(self,x)if x==nil then error("Function provided to thread is nil")end;aN=x;f0=coroutine.create(aN)f1=true;local aX,aY=coroutine.resume(f0)if not aX then if aY~="Terminated"then error("Thread Error Occurred - "..aY)end end;return self end,getStatus=function(self,x)if f0~=nil then return coroutine.status(f0)end;return nil end,stop=function(self,x)f1=false;return self end,eventHandler=function(self,aL,c5,c6,c7)if f1 then if coroutine.status(f0)~="dead"then local aX,aY=coroutine.resume(f0,aL,c5,c6,c7)if not aX then if aY~="Terminated"then error("Thread Error Occurred - "..aY)end end else f1=false end end end}bO.__index=bO;return bO end;local function f2(bF)local bG="Timer"local f3=0;local f4=0;local f5=0;local ca;local bN=aI()local bO={name=bF,getType=function(self)return bG end,getZIndex=function(self)return 1 end,getName=function(self)return self.name end,setTime=function(self,f6,f7)f3=f6 or 0;f4=f7 or 1;return self end,start=function(self)f5=f4;ca=os.startTimer(f3)return self end,cancel=function(self)if ca~=nil then os.cancelTimer(ca)end;return self end,onCall=function(self,aN)bN:registerEvent("timed_event",aN)return self end,eventHandler=function(self,aL,ch)if aL=="timer"and ch==ca then bN:sendEvent("timed_event",self)if f5>=1 then f5=f5-1;if f5>=1 then ca=os.startTimer(f3)end elseif f5==-1 then ca=os.startTimer(f3)end end end}bO.__index=bO;return bO end;local function f8(bF,f9)local cj=bE(bF)local bG="Frame"local fa={}local fb={}local bO={}local fc;local fd=e;local fe={}local ff=false;cj:setZIndex(10)local aA=a3(fd)local dv=false;local ds=1;local dt=1;local fg=colors.white;local fh,cx=0,0;if f9~=nil then cj.parent=f9;cj.width,cj.height=f9.w,f9.h;cj.bgColor=h.FrameBG;cj.fgColor=h.FrameFG else cj.width,cj.height=fd.getSize()cj.bgColor=h.basaltBG;cj.fgColor=h.basaltFG end;local function fi(bF)for aO,aP in pairs(fa)do for aO,br in pairs(aP)do if br.name==bF then return aP end end end end;local function fj(fk)local bH=fk:getZIndex()if fi(fk.name)~=nil then return nil end;if fa[bH]==nil then for ap=1,#fb+1 do if fb[ap]~=nil then if bH==fb[ap]then break end;if bH>fb[ap]then table.insert(fb,ap,bH)break end else table.insert(fb,bH)end end;if#fb<=0 then table.insert(fb,bH)end;fa[bH]={}end;fk.parent=bO;table.insert(fa[bH],fk)return fk end;local function fl(fk)for bq,br in pairs(fa)do for bp,aP in pairs(br)do if aP==fk then table.remove(fa[bq],bp)return true end end end;return false end;bO={barActive=false,barBackground=colors.gray,barTextcolor=colors.black,barText="New Frame",barTextAlign="left",isMoveable=false,getType=function(self)return bG end,setFocusedObject=function(self,fk)for aO,aK in pairs(fb)do for aO,aP in pairs(fa[aK])do if aP==fk then if fc~=nil then fc:loseFocusHandler()end;fc=fk;fc:getFocusHandler()end end end;return self end,setOffset=function(self,b_,c0)fh=b_~=nil and math.floor(b_<0 and math.abs(b_)or-b_)or fh;cx=c0~=nil and math.floor(c0<0 and math.abs(c0)or-c0)or cx;return self end,getFrameOffset=function(self)return fh,cx end,removeFocusedObject=function(self)if fc~=nil then fc:loseFocusHandler()end;fc=nil;return self end,getFocusedObject=function(self)return fc end,show=function(self)cj:show()if self.parent==nil and not ff then b=self end;return self end,setCursor=function(self,fm,fn,fo,bW)local cn,co=self:getAbsolutePosition(self:getAnchorPosition())dv=fm or false;if fn~=nil then ds=cn+fn-1 end;if fo~=nil then dt=co+fo-1 end;fg=bW or fg;self:setVisualChanged()return self end,setMoveable=function(self,fp)self.isMoveable=fp or not self.isMoveable;self:setVisualChanged()return self end,addMonitor=function(self,fq)local fr=peripheral.wrap(fq)fe[fq]={monitor=fq,frame=a.createFrame(self:getName().."_monitor_"..fq)}fe[fq].frame:setDisplay(fr):setFrameAsMonitor()fe[fq].frame:setSize(fr:getSize())return fe[fq].frame end,setMonitorScale=function(self,fs,ft)if ff then fd.setTextScale(fs*0.5)if ft then self:setSize(fd:getSize())end end;return self,ff end,setFrameAsMonitor=function(self,fu)ff=fu or true;return self end,showBar=function(self,fv)self.barActive=fv or not self.barActive;self:setVisualChanged()return self end,setBar=function(self,ar,aB,aC)self.barText=ar or""self.barBackground=aB or self.barBackground;self.barTextcolor=aC or self.barTextcolor;self:setVisualChanged()return self end,setBarTextAlign=function(self,cw)self.barTextAlign=cw or"left"self:setVisualChanged()return self end,setDisplay=function(self,a4)fd=a4;aA=a3(fd)return self end,getDisplay=function(self)return fd end,getVisualChanged=function(self)local fw=cj.getVisualChanged(self)for aO,aK in pairs(fb)do if fa[aK]~=nil then for aO,aP in pairs(fa[aK])do if aP.getVisualChanged~=nil and aP:getVisualChanged()then fw=true end end end end;return fw end,loseFocusHandler=function(self)cj.loseFocusHandler(self)end,getFocusHandler=function(self)cj.getFocusHandler(self)if self.parent~=nil then self.parent:removeObject(self)self.parent:addObject(self)end end,keyHandler=function(self,aL,bp)if fc~=nil then if fc.keyHandler~=nil then if fc:keyHandler(aL,bp)then return true end end end;return false end,backgroundKeyHandler=function(self,aL,bp)cj.backgroundKeyHandler(self,aL,bp)for aO,aK in pairs(fb)do if fa[aK]~=nil then for aO,aP in pairs(fa[aK])do if aP.backgroundKeyHandler~=nil then aP:backgroundKeyHandler(aL,bp)end end end end end,eventHandler=function(self,aL,c5,c6,c7,c8)cj.eventHandler(self,aL,c5,c6,c7,c8)for aO,aK in pairs(fb)do if fa[aK]~=nil then for aO,aP in pairs(fa[aK])do if aP.eventHandler~=nil then aP:eventHandler(aL,c5,c6,c7,c8)end end end end;if aL=="terminate"then fd.clear()fd.setCursorPos(1,1)a.stop()end end,mouseClickHandler=function(self,aL,c2,ap,aq)local b_,c0=self:getOffset()b_=b_<0 and math.abs(b_)or-b_;c0=c0<0 and math.abs(c0)or-c0;if self.drag then if aL=="mouse_drag"then local fx=1;local fy=1;if self.parent~=nil then fx,fy=self.parent:getAbsolutePosition(self.parent:getAnchorPosition())end;self:setPosition(ap+self.xToRem-(fx-1)+b_,aq-(fy-1)+c0)end;if aL=="mouse_up"then self.drag=false end;return true end;if cj.mouseClickHandler(self,aL,c2,ap,aq)then local bX,bY=self:getAbsolutePosition(self:getAnchorPosition())if aL~="monitor_touch"or ff then for aO,aK in pairs(fb)do if fa[aK]~=nil then for aO,aP in b4(fa[aK])do if aP.mouseClickHandler~=nil then if aP:mouseClickHandler(aL,c2,ap+b_,aq+c0)then return true end end end end end elseif not ff then for aO,fz in pairs(fe)do if c2==fz.monitor then fz.frame:mouseClickHandler(aL,c2,ap,aq)end end end;if self.isMoveable then if ap>=bX and ap<=bX+self.width-1 and aq==bY and aL=="mouse_click"then self.drag=true;self.xToRem=bX-ap end end;if fc~=nil then fc:loseFocusHandler()fc=nil end;return true end;return false end,setText=function(self,ap,aq,ar)local cn,co=self:getAbsolutePosition(self:getAnchorPosition())if aq>=1 and aq<=self.height then if self.parent~=nil then self.parent:setText(math.max(ap+cn-1,cn)-(self.parent.x-1),co+aq-1-(self.parent.y-1),f(ar,math.max(1-ap+1,1),self.width-ap+1))else aA.setText(math.max(ap+cn-1,cn),co+aq-1,f(ar,math.max(1-ap+1,1),self.width-ap+1))end end end,setBG=function(self,ap,aq,aB)local cn,co=self:getAbsolutePosition(self:getAnchorPosition())if aq>=1 and aq<=self.height then if self.parent~=nil then self.parent:setBG(math.max(ap+cn-1,cn)-(self.parent.x-1),co+aq-1-(self.parent.y-1),f(aB,math.max(1-ap+1,1),self.width-ap+1))else aA.setBG(math.max(ap+cn-1,cn),co+aq-1,f(aB,math.max(1-ap+1,1),self.width-ap+1))end end end,setFG=function(self,ap,aq,aC)local cn,co=self:getAbsolutePosition(self:getAnchorPosition())if aq>=1 and aq<=self.height then if self.parent~=nil then self.parent:setFG(math.max(ap+cn-1,cn)-(self.parent.x-1),co+aq-1-(self.parent.y-1),f(aC,math.max(1-ap+1,1),self.width-ap+1))else aA.setFG(math.max(ap+cn-1,cn),co+aq-1,f(aC,math.max(1-ap+1,1),self.width-ap+1))end end end,writeText=function(self,ap,aq,ar,aB,aC)local cn,co=self:getAbsolutePosition(self:getAnchorPosition())if aq>=1 and aq<=self.height then if self.parent~=nil then self.parent:writeText(math.max(ap+cn-1,cn)-(self.parent.x-1),co+aq-1-(self.parent.y-1),f(ar,math.max(1-ap+1,1),self.width-ap+1),aB,aC)else aA.writeText(math.max(ap+cn-1,cn),co+aq-1,f(ar,math.max(1-ap+1,1),self.width-ap+1),aB,aC)end end end,drawBackgroundBox=function(self,ap,aq,a6,m,aB)local cn,co=self:getAbsolutePosition(self:getAnchorPosition())m=aq<1 and(m+aq>self.height and self.height or m+aq-1)or(m+aq>self.height and self.height-aq+1 or m)a6=ap<1 and(a6+ap>self.width and self.width or a6+ap-1)or(a6+ap>self.width and self.width-ap+1 or a6)if self.parent~=nil then self.parent:drawBackgroundBox(math.max(ap+cn-1,cn)-(self.parent.x-1),math.max(aq+co-1,co)-(self.parent.y-1),a6,m,aB)else aA.drawBackgroundBox(math.max(ap+cn-1,cn),math.max(aq+co-1,co),a6,m,aB)end end,drawTextBox=function(self,ap,aq,a6,m,aD)local cn,co=self:getAbsolutePosition(self:getAnchorPosition())m=aq<1 and(m+aq>self.height and self.height or m+aq-1)or(m+aq>self.height and self.height-aq+1 or m)a6=ap<1 and(a6+ap>self.width and self.width or a6+ap-1)or(a6+ap>self.width and self.width-ap+1 or a6)if self.parent~=nil then self.parent:drawTextBox(math.max(ap+cn-1,cn)-(self.parent.x-1),math.max(aq+co-1,co)-(self.parent.y-1),a6,m,aD:sub(1,1))else aA.drawTextBox(math.max(ap+cn-1,cn),math.max(aq+co-1,co),a6,m,aD:sub(1,1))end end,drawForegroundBox=function(self,ap,aq,a6,m,aC)local cn,co=self:getAbsolutePosition(self:getAnchorPosition())m=aq<1 and(m+aq>self.height and self.height or m+aq-1)or(m+aq>self.height and self.height-aq+1 or m)a6=ap<1 and(a6+ap>self.width and self.width or a6+ap-1)or(a6+ap>self.width and self.width-ap+1 or a6)if self.parent~=nil then self.parent:drawForegroundBox(math.max(ap+cn-1,cn)-(self.parent.x-1),math.max(aq+co-1,co)-(self.parent.y-1),a6,m,aC)else aA.drawForegroundBox(math.max(ap+cn-1,cn),math.max(aq+co-1,co),a6,m,aC)end end,draw=function(self)if self:getVisualChanged()then if cj.draw(self)then for aO,fz in pairs(fe)do fz.frame:draw()end;local cn,co=self:getAbsolutePosition(self:getAnchorPosition())local eY,eZ=self:getAnchorPosition()if self.parent~=nil then self.parent:drawBackgroundBox(eY,eZ,self.width,self.height,self.bgColor)self.parent:drawForegroundBox(eY,eZ,self.width,self.height,self.fgColor)self.parent:drawTextBox(eY,eZ,self.width,self.height," ")else aA.drawBackgroundBox(cn,co,self.width,self.height,self.bgColor)aA.drawForegroundBox(cn,co,self.width,self.height,self.fgColor)aA.drawTextBox(cn,co,self.width,self.height," ")end;e.setCursorBlink(false)if self.barActive then if self.parent~=nil then self.parent:writeText(eY,eZ,aZ(self.barText,self.width,self.barTextAlign),self.barBackground,self.barTextcolor)else aA.writeText(cn,co,aZ(self.barText,self.width,self.barTextAlign),self.barBackground,self.barTextcolor)end end;for aO,aK in b4(fb)do if fa[aK]~=nil then for aO,aP in pairs(fa[aK])do if aP.draw~=nil then aP:draw()end end end end;if dv then fd.setTextColor(fg)fd.setCursorPos(ds,dt)if self.parent~=nil then fd.setCursorBlink(self:isFocused())else fd.setCursorBlink(dv)end end;self:setVisualChanged(false)end;aA.update()end end,addObject=function(self,fk)return fj(fk)end,removeObject=function(self,fk)return fl(fk)end,getObject=function(self,fk)return fi(fk)end,addButton=function(self,bF)local fk=ci(bF)fk.name=bF;return fj(fk)end,addLabel=function(self,bF)local fk=d6(bF)fk.name=bF;fk.bgColor=self.bgColor;fk.fgColor=self.fgColor;return fj(fk)end,addCheckbox=function(self,bF)local fk=cq(bF)fk.name=bF;return fj(fk)end,addInput=function(self,bF)local fk=cO(bF)fk.name=bF;return fj(fk)end,addProgram=function(self,bF)local fk=dq(bF)fk.name=bF;return fj(fk)end,addTextfield=function(self,bF)local fk=eR(bF)fk.name=bF;return fj(fk)end,addList=function(self,bF)local fk=dg(bF)fk.name=bF;return fj(fk)end,addDropdown=function(self,bF)local fk=cr(bF)fk.name=bF;return fj(fk)end,addRadio=function(self,bF)local fk=ey(bF)fk.name=bF;return fj(fk)end,addTimer=function(self,bF)local fk=f2(bF)fk.name=bF;return fj(fk)end,addAnimation=function(self,bF)local fk=c9(bF)fk.name=bF;return fj(fk)end,addSlider=function(self,bF)local fk=eP(bF)fk.name=bF;return fj(fk)end,addScrollbar=function(self,bF)local fk=eD(bF)fk.name=bF;return fj(fk)end,addMenubar=function(self,bF)local fk=dj(bF)fk.name=bF;return fj(fk)end,addThread=function(self,bF)local fk=e_(bF)fk.name=bF;return fj(fk)end,addPane=function(self,bF)local fk=dp(bF)fk.name=bF;return fj(fk)end,addImage=function(self,bF)local fk=cG(bF)fk.name=bF;return fj(fk)end,addProgressbar=function(self,bF)local fk=ep(bF)fk.name=bF;return fj(fk)end,addFrame=function(self,bF)local fk=f8(bF,self)fk.name=bF;return fj(fk)end}setmetatable(bO,cj)if f9==nil then table.insert(c,bO)end;return bO end;local fA=false;local function fB(aL,c5,c6,c7,c8)if aL=="mouse_click"then b:mouseClickHandler(aL,c5,c6,c7,c8)elseif aL=="mouse_drag"then b:mouseClickHandler(aL,c5,c6,c7,c8)elseif aL=="mouse_up"then b:mouseClickHandler(aL,c5,c6,c7,c8)elseif aL=="mouse_scroll"then b:mouseClickHandler(aL,c5,c6,c7,c8)elseif aL=="monitor_touch"then b:mouseClickHandler(aL,c5,c6,c7,c8)elseif aL=="key"or aL=="char"then b:keyHandler(aL,c5)b:backgroundKeyHandler(aL,c5)end;if aL=="key"then d[c5]=true end;if aL=="key_up"then d[c5]=false end;for aO,aP in pairs(c)do aP:eventHandler(aL,c5,c6,c7,c8)end;if fA then b:draw()end end;function a.autoUpdate(f1)e.clear()fA=f1 or true;b:draw()while fA do local aL,c5,c6,c7,c8=os.pullEventRaw()fB(aL,c5,c6,c7,c8)end end;function a.update(aL,c5,c6,c7,c8)if aL~="nil"then fB(aL,c5,c6,c7,c8)else b:draw()end end;function a.stop()fA=false end;function a.isKeyDown(bp)if d[bp]==nil then return false end;return d[bp]end;function a.getFrame(bF)for aO,aP in pairs(c)do if aP.name==bF then return aP end end end;function a.getActiveFrame()return b end;function a.setActiveFrame(bP)if bP:getType()=="Frame"then b=bP;return true end;return false end;function a.createFrame(bF)return f8(bF)end;function a.removeFrame(bF)for bp,aP in pairs(c)do if aP.name==bF then c[bp]=nil;return true end end;return false end;if a.debugger then a.debugFrame=a.createFrame("basaltDebuggingFrame"):showBar():setBackground(colors.lightGray):setBar("Debug",colors.black,colors.gray)a.debugList=a.debugFrame:addList("debugList"):setSize(a.debugFrame.width-2,a.debugFrame.height-3):setPosition(2,3):setScrollable(true):show()a.debugFrame:addButton("back"):setAnchor("right"):setSize(1,1):setText("\22"):onClick(function()a.oldFrame:show()end):setBackground(colors.red):show()a.debugLabel=a.debugFrame:addLabel("debugLabel"):onClick(function()a.oldFrame=b;a.debugFrame:show()end):setBackground(colors.black):setForeground(colors.white):setAnchor("bottom"):setZIndex(20):show()end;if a.debugger then function a.debug(...)local aV={...}if b.name~="basaltDebuggingFrame"then if b~=a.debugLabel.frame then a.debugLabel:setParent(b)end end;local fC=""for bp,aP in pairs(aV)do fC=fC..tostring(aP)..(#aV~=bp and", "or"")end;a.debugLabel:setText("[Debug] "..fC)a.debugList:addItem(fC)if a.debugList:getItemCount()>50 then a.debugList:removeItem(1)end;a.debugList:setValue(a.debugList:getItem(a.debugList:getItemCount()))a.debugLabel:show()end end;return a