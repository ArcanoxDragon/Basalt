local a={debugger=true,version=1}local b;local c={}local d={}local e=term.current()local f=string.sub;local g={[colors.white]="0",[colors.orange]="1",[colors.magenta]="2",[colors.lightBlue]="3",[colors.yellow]="4",[colors.lime]="5",[colors.pink]="6",[colors.gray]="7",[colors.lightGray]="8",[colors.cyan]="9",[colors.purple]="a",[colors.blue]="b",[colors.brown]="c",[colors.green]="d",[colors.red]="e",[colors.black]="f"}local h={basaltBG=colors.lightGray,basaltFG=colors.black,FrameBG=colors.gray,FrameFG=colors.black,ButtonBG=colors.gray,ButtonFG=colors.black,CheckboxBG=colors.gray,CheckboxFG=colors.black,InputBG=colors.gray,InputFG=colors.black,textfieldBG=colors.gray,textfieldFG=colors.black,listBG=colors.gray,listFG=colors.black,dropdownBG=colors.gray,dropdownFG=colors.black,radioBG=colors.gray,radioFG=colors.black,selectionBG=colors.black,selectionFG=colors.lightGray}local i={{"\32\32\32\137\156\148\158\159\148\135\135\144\159\139\32\136\157\32\159\139\32\32\143\32\32\143\32\32\32\32\32\32\32\32\147\148\150\131\148\32\32\32\151\140\148\151\140\147","\32\32\32\149\132\149\136\156\149\144\32\133\139\159\129\143\159\133\143\159\133\138\32\133\138\32\133\32\32\32\32\32\32\150\150\129\137\156\129\32\32\32\133\131\129\133\131\132","\32\32\32\130\131\32\130\131\32\32\129\32\32\32\32\130\131\32\130\131\32\32\32\32\143\143\143\32\32\32\32\32\32\130\129\32\130\135\32\32\32\32\131\32\32\131\32\131","\139\144\32\32\143\148\135\130\144\149\32\149\150\151\149\158\140\129\32\32\32\135\130\144\135\130\144\32\149\32\32\139\32\159\148\32\32\32\32\159\32\144\32\148\32\147\131\132","\159\135\129\131\143\149\143\138\144\138\32\133\130\149\149\137\155\149\159\143\144\147\130\132\32\149\32\147\130\132\131\159\129\139\151\129\148\32\32\139\131\135\133\32\144\130\151\32","\32\32\32\32\32\32\130\135\32\130\32\129\32\129\129\131\131\32\130\131\129\140\141\132\32\129\32\32\129\32\32\32\32\32\32\32\131\131\129\32\32\32\32\32\32\32\32\32","\32\32\32\32\149\32\159\154\133\133\133\144\152\141\132\133\151\129\136\153\32\32\154\32\159\134\129\130\137\144\159\32\144\32\148\32\32\32\32\32\32\32\32\32\32\32\151\129","\32\32\32\32\133\32\32\32\32\145\145\132\141\140\132\151\129\144\150\146\129\32\32\32\138\144\32\32\159\133\136\131\132\131\151\129\32\144\32\131\131\129\32\144\32\151\129\32","\32\32\32\32\129\32\32\32\32\130\130\32\32\129\32\129\32\129\130\129\129\32\32\32\32\130\129\130\129\32\32\32\32\32\32\32\32\133\32\32\32\32\32\129\32\129\32\32","\150\156\148\136\149\32\134\131\148\134\131\148\159\134\149\136\140\129\152\131\32\135\131\149\150\131\148\150\131\148\32\148\32\32\148\32\32\152\129\143\143\144\130\155\32\134\131\148","\157\129\149\32\149\32\152\131\144\144\131\148\141\140\149\144\32\149\151\131\148\32\150\32\150\131\148\130\156\133\32\144\32\32\144\32\130\155\32\143\143\144\32\152\129\32\134\32","\130\131\32\131\131\129\131\131\129\130\131\32\32\32\129\130\131\32\130\131\32\32\129\32\130\131\32\130\129\32\32\129\32\32\133\32\32\32\129\32\32\32\130\32\32\32\129\32","\150\140\150\137\140\148\136\140\132\150\131\132\151\131\148\136\147\129\136\147\129\150\156\145\138\143\149\130\151\32\32\32\149\138\152\129\149\32\32\157\152\149\157\144\149\150\131\148","\149\143\142\149\32\149\149\32\149\149\32\144\149\32\149\149\32\32\149\32\32\149\32\149\149\32\149\32\149\32\144\32\149\149\130\148\149\32\32\149\32\149\149\130\149\149\32\149","\130\131\129\129\32\129\131\131\32\130\131\32\131\131\32\131\131\129\129\32\32\130\131\32\129\32\129\130\131\32\130\131\32\129\32\129\131\131\129\129\32\129\129\32\129\130\131\32","\136\140\132\150\131\148\136\140\132\153\140\129\131\151\129\149\32\149\149\32\149\149\32\149\137\152\129\137\152\129\131\156\133\149\131\32\150\32\32\130\148\32\152\137\144\32\32\32","\149\32\32\149\159\133\149\32\149\144\32\149\32\149\32\149\32\149\150\151\129\138\155\149\150\130\148\32\149\32\152\129\32\149\32\32\32\150\32\32\149\32\32\32\32\32\32\32","\129\32\32\130\129\129\129\32\129\130\131\32\32\129\32\130\131\32\32\129\32\129\32\129\129\32\129\32\129\32\131\131\129\130\131\32\32\32\129\130\131\32\32\32\32\140\140\132","\32\154\32\159\143\32\149\143\32\159\143\32\159\144\149\159\143\32\159\137\145\159\143\144\149\143\32\32\145\32\32\32\145\149\32\144\32\149\32\143\159\32\143\143\32\159\143\32","\32\32\32\152\140\149\151\32\149\149\32\145\149\130\149\157\140\133\32\149\32\154\143\149\151\32\149\32\149\32\144\32\149\149\153\32\32\149\32\149\133\149\149\32\149\149\32\149","\32\32\32\130\131\129\131\131\32\130\131\32\130\131\129\130\131\129\32\129\32\140\140\129\129\32\129\32\129\32\137\140\129\130\32\129\32\130\32\129\32\129\129\32\129\130\131\32","\144\143\32\159\144\144\144\143\32\159\143\144\159\138\32\144\32\144\144\32\144\144\32\144\144\32\144\144\32\144\143\143\144\32\150\129\32\149\32\130\150\32\134\137\134\134\131\148","\136\143\133\154\141\149\151\32\129\137\140\144\32\149\32\149\32\149\154\159\133\149\148\149\157\153\32\154\143\149\159\134\32\130\148\32\32\149\32\32\151\129\32\32\32\32\134\32","\133\32\32\32\32\133\129\32\32\131\131\32\32\130\32\130\131\129\32\129\32\130\131\129\129\32\129\140\140\129\131\131\129\32\130\129\32\129\32\130\129\32\32\32\32\32\129\32","\32\32\32\32\149\32\32\149\32\32\32\32\32\32\32\32\149\32\32\149\32\32\32\32\32\32\32\32\149\32\32\149\32\32\32\32\32\32\32\32\149\32\32\149\32\32\32\32","\32\32\32\32\32\32\32\32\32\32\32\32\32\149\32\32\149\32\32\149\32\32\149\32\32\149\32\32\149\32\32\149\32\32\149\32\32\32\32\32\32\32\32\32\32\32\32\32","\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32","\32\32\32\32\149\32\32\149\32\32\32\32\32\32\32\32\149\32\32\149\32\32\32\32\32\32\32\32\149\32\32\149\32\32\32\32\32\32\32\32\149\32\32\149\32\32\32\32","\32\32\32\32\32\32\32\32\32\32\32\32\32\149\32\32\149\32\32\149\32\32\149\32\32\149\32\32\149\32\32\149\32\32\149\32\32\32\32\32\32\32\32\32\32\32\32\32","\32\149\32\32\149\32\32\149\32\32\149\32\32\149\32\32\149\32\32\149\32\32\149\32\32\149\32\32\149\32\32\149\32\32\149\32\32\149\32\32\149\32\32\149\32\32\149\32","\32\32\32\32\145\32\159\139\32\151\131\132\155\143\132\134\135\145\32\149\32\158\140\129\130\130\32\152\147\155\157\134\32\32\144\144\32\32\32\32\32\32\152\131\155\131\131\129","\32\32\32\32\149\32\149\32\145\148\131\32\149\32\149\140\157\132\32\148\32\137\155\149\32\32\32\149\154\149\137\142\32\153\153\32\131\131\149\131\131\129\149\135\145\32\32\32","\32\32\32\32\129\32\130\135\32\131\131\129\134\131\132\32\129\32\32\129\32\131\131\32\32\32\32\130\131\129\32\32\32\32\129\129\32\32\32\32\32\32\130\131\129\32\32\32","\150\150\32\32\148\32\134\32\32\132\32\32\134\32\32\144\32\144\150\151\149\32\32\32\32\32\32\145\32\32\152\140\144\144\144\32\133\151\129\133\151\129\132\151\129\32\145\32","\130\129\32\131\151\129\141\32\32\142\32\32\32\32\32\149\32\149\130\149\149\32\143\32\32\32\32\142\132\32\154\143\133\157\153\132\151\150\148\151\158\132\151\150\148\144\130\148","\32\32\32\140\140\132\32\32\32\32\32\32\32\32\32\151\131\32\32\129\129\32\32\32\32\134\32\32\32\32\32\32\32\129\129\32\129\32\129\129\130\129\129\32\129\130\131\32","\156\143\32\159\141\129\153\140\132\153\137\32\157\141\32\159\142\32\150\151\129\150\131\132\140\143\144\143\141\145\137\140\148\141\141\144\157\142\32\159\140\32\151\134\32\157\141\32","\157\140\149\157\140\149\157\140\149\157\140\149\157\140\149\157\140\149\151\151\32\154\143\132\157\140\32\157\140\32\157\140\32\157\140\32\32\149\32\32\149\32\32\149\32\32\149\32","\129\32\129\129\32\129\129\32\129\129\32\129\129\32\129\129\32\129\129\131\129\32\134\32\131\131\129\131\131\129\131\131\129\131\131\129\130\131\32\130\131\32\130\131\32\130\131\32","\151\131\148\152\137\145\155\140\144\152\142\145\153\140\132\153\137\32\154\142\144\155\159\132\150\156\148\147\32\144\144\130\145\136\137\32\146\130\144\144\130\145\130\136\32\151\140\132","\151\32\149\151\155\149\149\32\149\149\32\149\149\32\149\149\32\149\149\32\149\152\137\144\157\129\149\149\32\149\149\32\149\149\32\149\149\32\149\130\150\32\32\157\129\149\32\149","\131\131\32\129\32\129\130\131\32\130\131\32\130\131\32\130\131\32\130\131\32\32\32\32\130\131\32\130\131\32\130\131\32\130\131\32\130\131\32\32\129\32\130\131\32\133\131\32","\156\143\32\159\141\129\153\140\132\153\137\32\157\141\32\159\142\32\159\159\144\152\140\144\156\143\32\159\141\129\153\140\132\157\141\32\130\145\32\32\147\32\136\153\32\130\146\32","\152\140\149\152\140\149\152\140\149\152\140\149\152\140\149\152\140\149\149\157\134\154\143\132\157\140\133\157\140\133\157\140\133\157\140\133\32\149\32\32\149\32\32\149\32\32\149\32","\130\131\129\130\131\129\130\131\129\130\131\129\130\131\129\130\131\129\130\130\131\32\134\32\130\131\129\130\131\129\130\131\129\130\131\129\32\129\32\32\129\32\32\129\32\32\129\32","\159\134\144\137\137\32\156\143\32\159\141\129\153\140\132\153\137\32\157\141\32\32\132\32\159\143\32\147\32\144\144\130\145\136\137\32\146\130\144\144\130\145\130\138\32\146\130\144","\149\32\149\149\32\149\149\32\149\149\32\149\149\32\149\149\32\149\149\32\149\131\147\129\138\134\149\149\32\149\149\32\149\149\32\149\149\32\149\154\143\149\32\157\129\154\143\149","\130\131\32\129\32\129\130\131\32\130\131\32\130\131\32\130\131\32\130\131\32\32\32\32\130\131\32\130\131\129\130\131\129\130\131\129\130\131\129\140\140\129\130\131\32\140\140\129"},{[[000110000110110000110010101000000010000000100101]],[[000000110110000000000010101000000010000000100101]],[[000000000000000000000000000000000000000000000000]],[[100010110100000010000110110000010100000100000110]],[[000000110000000010110110000110000000000000110000]],[[000000000000000000000000000000000000000000000000]],[[000000110110000010000000100000100000000000000010]],[[000000000110110100010000000010000000000000000100]],[[000000000000000000000000000000000000000000000000]],[[010000000000100110000000000000000000000110010000]],[[000000000000000000000000000010000000010110000000]],[[000000000000000000000000000000000000000000000000]],[[011110110000000100100010110000000100000000000000]],[[000000000000000000000000000000000000000000000000]],[[000000000000000000000000000000000000000000000000]],[[110000110110000000000000000000010100100010000000]],[[000010000000000000110110000000000100010010000000]],[[000000000000000000000000000000000000000000000000]],[[010110010110100110110110010000000100000110110110]],[[000000000000000000000110000000000110000000000000]],[[000000000000000000000000000000000000000000000000]],[[010100010110110000000000000000110000000010000000]],[[110110000000000000110000110110100000000010000000]],[[000000000000000000000000000000000000000000000000]],[[000100011111000100011111000100011111000100011111]],[[000000000000100100100100011011011011111111111111]],[[000000000000000000000000000000000000000000000000]],[[000100011111000100011111000100011111000100011111]],[[000000000000100100100100011011011011111111111111]],[[100100100100100100100100100100100100100100100100]],[[000000110100110110000010000011110000000000011000]],[[000000000100000000000010000011000110000000001000]],[[000000000000000000000000000000000000000000000000]],[[010000100100000000000000000100000000010010110000]],[[000000000000000000000000000000110110110110110000]],[[000000000000000000000000000000000000000000000000]],[[110110110110110110000000110110110110110110110110]],[[000000000000000000000110000000000000000000000000]],[[000000000000000000000000000000000000000000000000]],[[000000000000110110000110010000000000000000010010]],[[000010000000000000000000000000000000000000000000]],[[000000000000000000000000000000000000000000000000]],[[110110110110110110110000110110110110000000000000]],[[000000000000000000000110000000000000000000000000]],[[000000000000000000000000000000000000000000000000]],[[110110110110110110110000110000000000000000010000]],[[000000000000000000000000100000000000000110000110]],[[000000000000000000000000000000000000000000000000]]}}local j={}local k={}do local l=0;local m=#i[1]local n=#i[1][1]for o=1,m,3 do for p=1,n,3 do local q=string.char(l)local r={}r[1]=i[1][o]:sub(p,p+2)r[2]=i[1][o+1]:sub(p,p+2)r[3]=i[1][o+2]:sub(p,p+2)local s={}s[1]=i[2][o]:sub(p,p+2)s[2]=i[2][o+1]:sub(p,p+2)s[3]=i[2][o+2]:sub(p,p+2)k[q]={r,s}l=l+1 end end;j[1]=k end;local function t(u,v)local w={["0"]="1",["1"]="0"}if u<=#j then return true end;for x=#j+1,u do local y={}local z=j[x-1]for l=0,255 do local q=string.char(l)local r={}local s={}local A=z[q][1]local B=z[q][2]for o=1,#A do local C,D,E,F,G,H={},{},{},{},{},{}for p=1,#A[1]do local I=k[A[o]:sub(p,p)][1]table.insert(C,I[1])table.insert(D,I[2])table.insert(E,I[3])local J=k[A[o]:sub(p,p)][2]if B[o]:sub(p,p)=="1"then table.insert(F,J[1]:gsub("[01]",w))table.insert(G,J[2]:gsub("[01]",w))table.insert(H,J[3]:gsub("[01]",w))else table.insert(F,J[1])table.insert(G,J[2])table.insert(H,J[3])end end;table.insert(r,table.concat(C))table.insert(r,table.concat(D))table.insert(r,table.concat(E))table.insert(s,table.concat(F))table.insert(s,table.concat(G))table.insert(s,table.concat(H))end;y[q]={r,s}if v then v="Font"..x.."Yeld"..l;os.queueEvent(v)os.pullEvent(v)end end;j[x]=y end;return true end;local function K(L,M,N,O,P)if not type(M)=="string"then error("Not a String",3)end;local Q=type(N)=="string"and N:sub(1,1)or g[N]or error("Wrong Front Color",3)local R=type(O)=="string"and O:sub(1,1)or g[O]or error("Wrong Back Color",3)if j[L]==nil then t(3,false)end;local S=j[L]or error("Wrong font size selected",3)if M==""then return{{""},{""},{""}}end;local T={}for o in M:gmatch('.')do table.insert(T,o)end;local U={}local m=#S[T[1]][1]for V=1,m do local W={}for o=1,#T do W[o]=S[T[o]]and S[T[o]][1][V]or""end;U[V]=table.concat(W)end;local X={}local Y={}local Z={["0"]=Q,["1"]=R}local _={["0"]=R,["1"]=Q}for V=1,m do local a0={}local a1={}for o=1,#T do local a2=S[T[o]]and S[T[o]][2][V]or""a0[o]=a2:gsub("[01]",P and{["0"]=N:sub(o,o),["1"]=O:sub(o,o)}or Z)a1[o]=a2:gsub("[01]",P and{["0"]=O:sub(o,o),["1"]=N:sub(o,o)}or _)end;X[V]=table.concat(a0)Y[V]=table.concat(a1)end;return{U,X,Y}end;local function a3(a4)local a5=a4;local a6,m=a5.getSize()local a7={}local a8={}local a9={}local aa={}local ab={}local ac={}local ad;local ae={}local function af()ad=(" "):rep(a6)for ag=0,15 do local ah=2^ag;local ai=g[ah]ae[ah]=ai:rep(a6)end end;af()local function aj()local ak=ad;local al=ae[colors.white]local am=ae[colors.black]for an=1,m do a7[an]=f(a7[an]==nil and ak or a7[an]..ak:sub(1,a6-a7[an]:len()),1,a6)a9[an]=f(a9[an]==nil and al or a9[an]..al:sub(1,a6-a9[an]:len()),1,a6)a8[an]=f(a8[an]==nil and am or a8[an]..am:sub(1,a6-a8[an]:len()),1,a6)end end;aj()local function ao(ap,aq,ar)if aq>=1 and aq<=m then if ap+ar:len()>0 and ap<=a6 then local as=a7[aq]local at;local au=ap+#ar-1;if ap<1 then local av=1-ap+1;local aw=a6-ap+1;ar=f(ar,av,aw)elseif au>a6 then local aw=a6-ap+1;ar=f(ar,1,aw)end;if ap>1 then local aw=ap-1;at=f(as,1,aw)..ar else at=ar end;if au<a6 then at=at..f(as,au+1,a6)end;a7[aq]=at end end end;local function ax(ap,aq,ay)if aq>=1 and aq<=m then if ap+ay:len()>0 and ap<=a6 then local as=a8[aq]local at;local au=ap+#ay-1;if ap<1 then ay=f(ay,1-ap+1,a6-ap+1)elseif au>a6 then ay=f(ay,1,a6-ap+1)end;if ap>1 then at=f(as,1,ap-1)..ay else at=ay end;if au<a6 then at=at..f(as,au+1,a6)end;a8[aq]=at end end end;local function az(ap,aq,ay)if aq>=1 and aq<=m then if ap+ay:len()>0 and ap<=a6 then local as=a9[aq]local at;local au=ap+#ay-1;if ap<1 then local av=1-ap+1;local aw=a6-ap+1;ay=f(ay,av,aw)elseif au>a6 then local aw=a6-ap+1;ay=f(ay,1,aw)end;if ap>1 then local aw=ap-1;at=f(as,1,aw)..ay else at=ay end;if au<a6 then at=at..f(as,au+1,a6)end;a9[aq]=at end end end;local aA={setBG=function(ap,aq,ay)ax(ap,aq,ay)end,setText=function(ap,aq,ar)ao(ap,aq,ar)end,setFG=function(ap,aq,ay)az(ap,aq,ay)end,drawBackgroundBox=function(ap,aq,a6,m,aB)for ag=1,m do ax(ap,aq+ag-1,g[aB]:rep(a6))end end,drawForegroundBox=function(ap,aq,a6,m,aC)for ag=1,m do az(ap,aq+ag-1,g[aC]:rep(a6))end end,drawTextBox=function(ap,aq,a6,m,aD)for ag=1,m do ao(ap,aq+ag-1,aD:rep(a6))end end,writeText=function(ap,aq,ar,aB,aC)aB=aB or a5.getBackgroundColor()aC=aC or a5.getTextColor()ao(ap,aq,ar)ax(ap,aq,g[aB]:rep(ar:len()))az(ap,aq,g[aC]:rep(ar:len()))end,update=function()local aE,aF=a5.getCursorPos()local aG=false;if a5.getCursorBlink~=nil then aG=a5.getCursorBlink()end;a5.setCursorBlink(false)for ag=1,m do a5.setCursorPos(1,ag)a5.blit(a7[ag],a9[ag],a8[ag])end;a5.setBackgroundColor(colors.black)a5.setCursorBlink(aG)a5.setCursorPos(aE,aF)end,setTerm=function(aH)a5=aH end}return aA end;local function aI()local aJ={}local aK={}local aL={registerEvent=function(self,aM,aN)if aJ[aM]==nil then aJ[aM]={}aK[aM]=1 end;aJ[aM][aK[aM]]=aN;aK[aM]=aK[aM]+1;return aK[aM]-1 end,removeEvent=function(self,aM,aK)aJ[aM][aK[aM]]=nil end,sendEvent=function(self,aM,...)if aJ[aM]~=nil then for aO,aP in pairs(aJ[aM])do aP(...)end end end}aL.__index=aL;return aL end;local aQ={}local aR={}local aS=0;function aR:new(aT,aU,...)local aV=table.pack(...)local aW=setmetatable({path=aT},{__index=self})aW.window=aU;aW.processId=aS;aW.coroutine=coroutine.create(function()os.run({basalt=a},aT,table.unpack(aV))end)aQ[aS]=aW;aS=aS+1;return aW end;function aR:resume(aL,...)term.redirect(self.window)local aX,aY=coroutine.resume(self.coroutine,aL,...)self.window=term.current()if aX then self.filter=aY else a.debug(aY)end end;function aR:isDead()if self.coroutine~=nil then if coroutine.status(self.coroutine)=="dead"then table.remove(aQ,self.processId)return true end else return true end;return false end;function aR:getStatus()if self.coroutine~=nil then return coroutine.status(self.coroutine)end;return nil end;function aR:start()coroutine.resume(self.coroutine)end;local function aZ(ar,a6,a_,b0)ar=string.sub(ar,1,a6)local b1=a6-string.len(ar)if a_=="right"then ar=string.rep(b0 or" ",b1)..ar elseif a_=="center"then ar=string.rep(b0 or" ",math.floor(b1/2))..ar..string.rep(b0 or" ",math.floor(b1/2))ar=ar..(string.len(ar)<a6 and(b0 or" ")or"")else ar=ar..string.rep(b0 or" ",b1)end;return ar end;local function b2(b3,a_)local b1=0;if a_=="center"then b1=math.ceil(b3/2)if b1<1 then b1=1 end end;if a_=="bottom"then b1=b3 end;if b1<1 then b1=1 end;return b1 end;local function b4(b5)return function(b5,o)o=o-1;if o~=0 then return o,b5[o]end end,b5,#b5+1 end;local function b6(b7,b8)local b9={[0]={8,4,3,6,5},{4,14,8,7},{6,10,8,7},{9,11,8,0},{1,14,8,0},{13,12,8,0},{2,10,8,0},{15,8,10,11,12,14},{0,7,1,9,2,13},{3,11,8,7},{2,6,7,15},{9,3,7,15},{13,5,7,15},{5,12,8,7},{1,4,7,15},{7,10,11,12,14}}local ba,bb,bc={},{},{}for o=0,15 do bb[2^o]=o end;do local bd="0123456789abcdef"for o=1,16 do ba[bd:sub(o,o)]=o-1;ba[o-1]=bd:sub(o,o)bc[bd:sub(o,o)]=2^(o-1)bc[2^(o-1)]=bd:sub(o,o)local be=b9[o-1]for o=1,#be do be[o]=2^be[o]end end end;local function bf(bg)local bh=b9[bb[bg[#bg][1]]]if bh~=nil then for p=1,#bh do local bi=bh[p]for o=1,#bg-1 do if bg[o][1]==bi then return o end end end end;return 1 end;local function bj(bk,bl)if not bl then local bm={}bl={}for o=1,6 do local bn=bk[o]local bo=bl[bn]bl[bn],bm[o]=bo and bo+1 or 1,bn end;bk=bm end;local bg={}for bp,aP in pairs(bl)do bg[#bg+1]={bp,aP}end;if#bg>1 then while#bg>2 do table.sort(bg,function(bq,br)return bq[2]>br[2]end)local bs,bt=bf(bg),#bg;local bu,bv=bg[bt][1],bg[bs][1]for o=1,6 do if bk[o]==bu then bk[o]=bv;bg[bs][2]=bg[bs][2]+1 end end;bg[bt]=nil end;local bw=128;for o=1,#bk-1 do if bk[o]~=bk[6]then bw=bw+2^(o-1)end end;return string.char(bw),bc[bg[1][1]==bk[6]and bg[2][1]or bg[1][1]],bc[bk[6]]else return"\128",bc[bk[1]],bc[bk[1]]end end;local bx,a6,m,aB={{},{},{}},0,#b7+#b7%3,b8 or colors.black;for o=1,#b7 do if#b7[o]>a6 then a6=#b7[o]end end;for aq=0,m-1,3 do local by,bz,bA,bB={},{},{},1;for ap=0,a6-1,2 do local bk,bl={},{}for bC=1,3 do for bD=1,2 do bk[#bk+1]=b7[aq+bC]and b7[aq+bC][ap+bD]and(b7[aq+bC][ap+bD]==0 and aB or b7[aq+bC][ap+bD])or aB;bl[bk[#bk]]=bl[bk[#bk]]and bl[bk[#bk]]+1 or 1 end end;by[bB],bz[bB],bA[bB]=bj(bk,bl)bB=bB+1 end;bx[1][#bx[1]+1],bx[2][#bx[2]+1],bx[3][#bx[3]+1]=table.concat(by),table.concat(bz),table.concat(bA)end;bx.width,bx.height=#bx[1][1],#bx[1]return bx end;local function bE(bF)local bG="Object"local aP;local bH=1;local bI="left"local bJ="top"local bK=false;local bL=false;local bM=true;local bN=aI()local bO={x=1,y=1,width=1,height=1,bgColor=colors.black,fgColor=colors.white,name=bF or"Object",parent=nil,show=function(self)bL=true;bM=true;return self end,hide=function(self)bL=false;bM=true;return self end,isVisible=function(self)return bL end,setFocus=function(self)if self.parent~=nil then self.parent:setFocusedObject(self)end;return self end,setZIndex=function(self,aK)bH=aK;if self.parent~=nil then self.parent:removeObject(self)self.parent:addObject(self)end;return self end,getZIndex=function(self)return bH end,getType=function(self)return bG end,getName=function(self)return self.name end,remove=function(self)if self.parent~=nil then self.parent:removeObject(self)end;return self end,setParent=function(self,bP)if bP.getType~=nil and bP:getType()=="Frame"then self:remove()bP:addObject(self)if self.draw then self:show()end end;return self end,setValue=function(self,bQ)if aP~=bQ then aP=bQ;bM=true;self:valueChangedHandler()end;return self end,getValue=function(self)return aP end,getVisualChanged=function(self)return bM end,setVisualChanged=function(self,bR)bM=bR or true;if bR==nil then bM=true end;return self end,getEventSystem=function(self)return bN end,getParent=function(self)return self.parent end,setPosition=function(self,bS,bT,bU)if bU then self.x,self.y=math.floor(self.x+bS),math.floor(self.y+bT)else self.x,self.y=math.floor(bS),math.floor(bT)end;bM=true;return self end,getPosition=function(self)return self.x,self.y end,getVisibility=function(self)return bL end,setVisibility=function(self,bV)bL=bV or not bL;bM=true;return self end,setSize=function(self,a6,m)self.width,self.height=a6,m;bM=true;return self end,getHeight=function(self)return self.height end,getWidth=function(self)return self.width end,getSize=function(self)return self.width,self.height end,setBackground=function(self,bW)self.bgColor=bW;bM=true;return self end,getBackground=function(self)return self.bgColor end,setForeground=function(self,bW)self.fgColor=bW;bM=true;return self end,getForeground=function(self)return self.fgColor end,draw=function(self)if bL then return true end;return false end,getAbsolutePosition=function(self,ap,aq)if ap==nil then ap=self.x end;if aq==nil then aq=self.y end;if self.parent~=nil then local bX,bY=self.parent:getAbsolutePosition(self.parent:getAnchorPosition())ap=bX+ap-1;aq=bY+aq-1 end;return ap,aq end,getAnchorPosition=function(self,ap,aq,bZ)if ap==nil then ap=self.x end;if aq==nil then aq=self.y end;if bI=="right"then ap=self.parent.width-ap-self.width+2 end;if bJ=="bottom"then aq=self.parent.height-aq-self.height+2 end;local b_,c0=self:getOffset()if bK or bZ then return ap,aq end;return ap+b_,aq+c0 end,getOffset=function(self)if self.parent~=nil and bK==false then return self.parent:getFrameOffset()end;return 0,0 end,ignoreOffset=function(self,c1)bK=c1 or true;return self end,setAnchor=function(self,...)for aO,aP in pairs(table.pack(...))do if aP=="right"or aP=="left"then bI=aP end;if aP=="top"or aP=="bottom"then bJ=aP end end;bM=true;return self end,getAnchor=function(self)return bI,bJ end,onChange=function(self,aN)self:registerEvent("value_changed",aN)return self end,onClick=function(self,aN)self:registerEvent("mouse_click",aN)self:registerEvent("monitor_touch",aN)return self end,onEvent=function(self,aN)self:registerEvent("custom_event_handler",aN)return self end,onClickUp=function(self,aN)self:registerEvent("mouse_up",aN)return self end,onKey=function(self,aN)self:registerEvent("key",aN)self:registerEvent("char",aN)return self end,onKeyUp=function(self,aN)self:registerEvent("key_up",aN)return self end,onBackgroundKey=function(self,aN)self:registerEvent("background_key",aN)self:registerEvent("background_char",aN)return self end,onBackgroundKeyUp=function(self,aN)self:registerEvent("background_key_up",aN)return self end,isFocused=function(self)if self.parent~=nil then return self.parent:getFocusedObject()==self end;return false end,onGetFocus=function(self,aN)self:registerEvent("get_focus",aN)return self end,onLoseFocus=function(self,aN)self:registerEvent("lose_focus",aN)return self end,registerEvent=function(self,aL,aN)return bN:registerEvent(aL,aN)end,removeEvent=function(self,aL,aK)return bN:removeEvent(aL,aK)end,sendEvent=function(self,aL,...)return bN:sendEvent(aL,self,...)end,mouseClickHandler=function(self,aL,c2,ap,aq)local c3,c4=self:getAbsolutePosition(self:getAnchorPosition())if c3<=ap and c3+self.width>ap and c4<=aq and c4+self.height>aq and bL then if self.parent~=nil then self.parent:setFocusedObject(self)end;bN:sendEvent(aL,self,aL,c2,ap,aq)return true end;return false end,keyHandler=function(self,aL,bp)if self:isFocused()then bN:sendEvent(aL,self,aL,bp)return true end;return false end,backgroundKeyHandler=function(self,aL,bp)bN:sendEvent("background_"..aL,self,aL,bp)end,valueChangedHandler=function(self)bN:sendEvent("value_changed",self)end,eventHandler=function(self,aL,c5,c6,c7,c8)bN:sendEvent("custom_event_handler",self,aL,c5,c6,c7,c8)end,getFocusHandler=function(self)bN:sendEvent("get_focus",self)end,loseFocusHandler=function(self)bN:sendEvent("lose_focus",self)end}bO.__index=bO;return bO end;local function c9(bF)local bO={}local bG="Animation"local ca;local cb={}local aK=1;local cc=0;local cd;local function ce()if cb[aK]~=nil then cb[aK].f(bO,aK)end;aK=aK+1;if cb[aK]~=nil then if cb[aK].t>0 then ca=os.startTimer(cb[aK].t)else ce()end end end;bO={name=bF,getType=function(self)return bG end,getZIndex=function(self)return 1 end,getName=function(self)return self.name end,add=function(self,aN,cf)cd=aN;table.insert(cb,{f=aN,t=cf or cc})return self end,wait=function(self,cf)cc=cf;return self end,rep=function(self,cg)for ap=1,cg do table.insert(cb,{f=cd,t=cc})end;return self end,clear=function(self)cb={}cd=nil;cc=0;aK=1;return self end,play=function(self)aK=1;if cb[aK]~=nil then if cb[aK].t>0 then ca=os.startTimer(cb[aK].t)else ce()end end;return self end,cancel=function(self)os.cancelTimer(ca)return self end,eventHandler=function(self,aL,ch)if aL=="timer"and ch==ca then if cb[aK]~=nil then ce()end end end}bO.__index=bO;return bO end;local function ci(bF)local cj=bE(bF)local bG="Button"cj:setValue("Button")cj:setZIndex(5)cj.width=8;cj.bgColor=h.ButtonBG;cj.fgColor=h.ButtonFG;local ck="center"local cl="center"local bO={getType=function(self)return bG end,setHorizontalAlign=function(self,cm)ck=cm end,setVerticalAlign=function(self,cm)cl=cm end,setText=function(self,ar)cj:setValue(ar)return self end,draw=function(self)if cj.draw(self)then if self.parent~=nil then local cn,co=self:getAnchorPosition()local cp=b2(self.height,cl)self.parent:drawBackgroundBox(cn,co,self.width,self.height,self.bgColor)self.parent:drawForegroundBox(cn,co,self.width,self.height,self.fgColor)self.parent:drawTextBox(cn,co,self.width,self.height," ")for ag=1,self.height do if ag==cp then self.parent:setText(cn,co+ag-1,aZ(self:getValue(),self.width,ck))end end end;self:setVisualChanged(false)end end}return setmetatable(bO,cj)end;local function cq(bF)local cj=bE(bF)local bG="Checkbox"cj:setZIndex(5)cj:setValue(false)cj.width=1;cj.height=1;cj.bgColor=h.CheckboxBG;cj.fgColor=h.CheckboxFG;local bO={symbol="\42",getType=function(self)return bG end,mouseClickHandler=function(self,aL,c2,ap,aq)if cj.mouseClickHandler(self,aL,c2,ap,aq)then if aL=="mouse_click"and c2==1 or aL=="monitor_touch"then if self:getValue()~=true and self:getValue()~=false then self:setValue(false)else self:setValue(not self:getValue())end end;return true end;return false end,draw=function(self)if cj.draw(self)then if self.parent~=nil then local cn,co=self:getAnchorPosition()local cp=b2(self.height,"center")self.parent:drawBackgroundBox(cn,co,self.width,self.height,self.bgColor)for ag=1,self.height do if ag==cp then if self:getValue()==true then self.parent:writeText(cn,co+ag-1,aZ(self.symbol,self.width,"center"),self.bgColor,self.fgColor)else self.parent:writeText(cn,co+ag-1,aZ(" ",self.width,"center"),self.bgColor,self.fgColor)end end end end;self:setVisualChanged(false)end end}return setmetatable(bO,cj)end;local function cr(bF)local cj=bE(bF)local bG="Dropdown"cj.width=12;cj.height=1;cj.bgColor=h.dropdownBG;cj.fgColor=h.dropdownFG;cj:setZIndex(6)local cs={}local ct=h.selectionBG;local cu=h.selectionFG;local cv=true;local cw="left"local cx=0;local cy=16;local cz=6;local cA="\16"local cB="\31"local cC=false;local bO={getType=function(self)return bG end,setIndexOffset=function(self,cD)cx=cD;return self end,getIndexOffset=function(self)return cx end,addItem=function(self,ar,aB,aC,...)table.insert(cs,{text=ar,bgCol=aB or self.bgColor,fgCol=aC or self.fgColor,args={...}})return self end,getAll=function(self)return cs end,removeItem=function(self,aK)table.remove(cs,aK)return self end,getItem=function(self,aK)return cs[aK]end,getItemIndex=function(self)local cE=self:getValue()for bp,aP in pairs(cs)do if aP==cE then return bp end end end,clear=function(self)cs={}self:setValue({})return self end,getItemCount=function(self)return#cs end,editItem=function(self,aK,ar,aB,aC,...)table.remove(cs,aK)table.insert(cs,aK,{text=ar,bgCol=aB or self.bgColor,fgCol=aC or self.fgColor,args={...}})return self end,selectItem=function(self,aK)self:setValue(cs[aK]or{})return self end,setSelectedItem=function(self,aB,aC,cF)ct=aB or self.bgColor;cu=aC or self.fgColor;cv=cF;return self end,setDropdownSize=function(self,a6,m)cy,cz=a6,m;return self end,mouseClickHandler=function(self,aL,c2,ap,aq)if cC then local cn,co=self:getAbsolutePosition(self:getAnchorPosition())if aL=="mouse_click"and c2==1 or aL=="monitor_touch"then if#cs>0 then for ag=1,cz do if cs[ag+cx]~=nil then if cn<=ap and cn+cy>ap and co+ag==aq then self:setValue(cs[ag+cx])return true end end end end end;if aL=="mouse_scroll"then cx=cx+c2;if cx<0 then cx=0 end;if c2==1 then if#cs>cz then if cx>#cs-cz then cx=#cs-cz end else cx=cs-1 end end;return true end;self:setVisualChanged()end;if cj.mouseClickHandler(self,aL,c2,ap,aq)then cC=true else cC=false end end,draw=function(self)if cj.draw(self)then local cn,co=self:getAnchorPosition()if self.parent~=nil then self.parent:drawBackgroundBox(cn,co,self.width,self.height,self.bgColor)local cG=self:getValue()local ar=aZ(cG~=nil and cG.text or"",self.width,cw):sub(1,self.width-1)..(cC and cB or cA)self.parent:writeText(cn,co,ar,self.bgColor,self.fgColor)if cC then for ag=1,cz do if cs[ag+cx]~=nil then if cs[ag+cx]==cG then if cv then self.parent:writeText(cn,co+ag,aZ(cs[ag+cx].text,cy,cw),ct,cu)else self.parent:writeText(cn,co+ag,aZ(cs[ag+cx].text,cy,cw),cs[ag+cx].bgCol,cs[ag+cx].fgCol)end else self.parent:writeText(cn,co+ag,aZ(cs[ag+cx].text,cy,cw),cs[ag+cx].bgCol,cs[ag+cx].fgCol)end end end end end;self:setVisualChanged(false)end end}return setmetatable(bO,cj)end;local function cH(bF)local cj=bE(bF)local bG="Image"cj:setZIndex(2)local cI;local cJ;local cK=false;local function b6()local b9={[0]={8,4,3,6,5},{4,14,8,7},{6,10,8,7},{9,11,8,0},{1,14,8,0},{13,12,8,0},{2,10,8,0},{15,8,10,11,12,14},{0,7,1,9,2,13},{3,11,8,7},{2,6,7,15},{9,3,7,15},{13,5,7,15},{5,12,8,7},{1,4,7,15},{7,10,11,12,14}}local ba,bb,bc={},{},{}for o=0,15 do bb[2^o]=o end;do local bd="0123456789abcdef"for o=1,16 do ba[bd:sub(o,o)]=o-1;ba[o-1]=bd:sub(o,o)bc[bd:sub(o,o)]=2^(o-1)bc[2^(o-1)]=bd:sub(o,o)local be=b9[o-1]for o=1,#be do be[o]=2^be[o]end end end;local function bf(bg)local bh=b9[bb[bg[#bg][1]]]for p=1,#bh do local bi=bh[p]for o=1,#bg-1 do if bg[o][1]==bi then return o end end end;return 1 end;local function bj(bk,bl)if not bl then local bm={}bl={}for o=1,6 do local bn=bk[o]local bo=bl[bn]bl[bn],bm[o]=bo and bo+1 or 1,bn end;bk=bm end;local bg={}for bp,aP in pairs(bl)do bg[#bg+1]={bp,aP}end;if#bg>1 then while#bg>2 do table.sort(bg,function(bq,br)return bq[2]>br[2]end)local bs,bt=bf(bg),#bg;local bu,bv=bg[bt][1],bg[bs][1]for o=1,6 do if bk[o]==bu then bk[o]=bv;bg[bs][2]=bg[bs][2]+1 end end;bg[bt]=nil end;local bw=128;for o=1,#bk-1 do if bk[o]~=bk[6]then bw=bw+2^(o-1)end end;return string.char(bw),bc[bg[1][1]==bk[6]and bg[2][1]or bg[1][1]],bc[bk[6]]else return"\128",bc[bk[1]],bc[bk[1]]end end;local bx,a6,m,aB={{},{},{}},0,#cI+#cI%3,cj.bgColor or colors.black;for o=1,#cI do if#cI[o]>a6 then a6=#cI[o]end end;for aq=0,m-1,3 do local by,bz,bA,bB={},{},{},1;for ap=0,a6-1,2 do local bk,bl={},{}for bC=1,3 do for bD=1,2 do bk[#bk+1]=cI[aq+bC]and cI[aq+bC][ap+bD]and(cI[aq+bC][ap+bD]==0 and aB or cI[aq+bC][ap+bD])or aB;bl[bk[#bk]]=bl[bk[#bk]]and bl[bk[#bk]]+1 or 1 end end;by[bB],bz[bB],bA[bB]=bj(bk,bl)bB=bB+1 end;bx[1][#bx[1]+1],bx[2][#bx[2]+1],bx[3][#bx[3]+1]=table.concat(by),table.concat(bz),table.concat(bA)end;bx.width,bx.height=#bx[1][1],#bx[1]cJ=bx end;local bO={getType=function(self)return bG end,loadImage=function(self,aT)cI=paintutils.loadImage(aT)cK=false;return self end,loadBlittleImage=function(self,aT)cK=true;return self end,shrink=function(self)b6()cK=true;return self end,draw=function(self)if cj.draw(self)then if self.parent~=nil then if cI~=nil then local cn,co=self:getAnchorPosition()if cK then local b5,cL,cM=cJ[1],cJ[2],cJ[3]for o=1,cJ.height do local cN=b5[o]if type(cN)=="string"then self.parent:setText(cn,co+o-1,cN)self.parent:setFG(cn,co+o-1,cL[o])self.parent:setBG(cn,co+o-1,cM[o])elseif type(cN)=="table"then self.parent:setText(cn,co+o-1,cN[2])self.parent:setFG(cn,co+o-1,cL[o])self.parent:setBG(cn,co+o-1,cM[o])end end else for bT=1,math.min(#cI,self.height)do local cO=cI[bT]for bS=1,math.min(#cO,self.width)do if cO[bS]>0 then self.parent:drawBackgroundBox(cn+bS-1,co+bT-1,1,1,cO[bS])end end end end end end;self:setVisualChanged(false)end end}return setmetatable(bO,cj)end;local function cP(bF)local cj=bE(bF)local bG="Input"local cQ="text"local cR=0;cj:setZIndex(5)cj:setValue("")cj.width=10;cj.height=1;cj.bgColor=h.InputBG;cj.fgColor=h.InputFG;local cS=1;local cT=1;local cU=""local cV;local cW;local cX=cU;local cY=false;local bO={getType=function(self)return bG end,setInputType=function(self,cZ)if cZ=="password"or cZ=="number"or cZ=="text"then cQ=cZ end;return self end,setDefaultText=function(self,ar,c_,d0)cU=ar;cV=d0 or cV;cW=c_ or cW;if self:isFocused()then cX=""else cX=cU end;return self end,getInputType=function(self)return cQ end,setValue=function(self,cG)cj.setValue(self,tostring(cG))if not cY then cS=tostring(cG):len()+1 end;return self end,getValue=function(self)local cG=cj.getValue(self)return cQ=="number"and tonumber(cG)or cG end,setInputLimit=function(self,d1)cR=tonumber(d1)or cR;return self end,getInputLimit=function(self)return cR end,getFocusHandler=function(self)cj.getFocusHandler(self)if self.parent~=nil then local cn,co=self:getAnchorPosition()cX=""if self.parent~=nil then self.parent:setCursor(true,cn+cS-cT,co,self.fgColor)end end end,loseFocusHandler=function(self)cj.loseFocusHandler(self)if self.parent~=nil then self.parent:setCursor(false)cX=cU end end,keyHandler=function(self,aL,bp)if cj.keyHandler(self,aL,bp)then cY=true;if aL=="key"then if bp==keys.backspace then local ar=tostring(cj.getValue())if cS>1 then self:setValue(ar:sub(1,cS-2)..ar:sub(cS,ar:len()))if cS>1 then cS=cS-1 end;if cT>1 then if cS<cT then cT=cT-1 end end end end;if bp==keys.enter then if self.parent~=nil then end end;if bp==keys.right then local d2=tostring(cj.getValue()):len()cS=cS+1;if cS>d2 then cS=d2+1 end;if cS<1 then cS=1 end;if cS<cT or cS>=self.width+cT then cT=cS-self.width+1 end;if cT<1 then cT=1 end end;if bp==keys.left then cS=cS-1;if cS>=1 then if cS<cT or cS>=self.width+cT then cT=cS end end;if cS<1 then cS=1 end;if cT<1 then cT=1 end end end;if aL=="char"then local ar=cj.getValue()if ar:len()<cR or cR<=0 then if cQ=="number"then local d3=ar;if bp=="."or tonumber(bp)~=nil then self:setValue(ar:sub(1,cS-1)..bp..ar:sub(cS,ar:len()))cS=cS+1 end;if tonumber(cj.getValue())==nil then self:setValue(d3)end else self:setValue(ar:sub(1,cS-1)..bp..ar:sub(cS,ar:len()))cS=cS+1 end;if cS>=self.width+cT then cT=cT+1 end end end;local cn,co=self:getAnchorPosition()local cG=tostring(cj.getValue())local d4=(cS<=cG:len()and cS-1 or cG:len())-(cT-1)if d4>self.x+self.width-1 then d4=self.x+self.width-1 end;if self.parent~=nil then self.parent:setCursor(true,cn+d4,co,self.fgColor)end;cY=false end end,mouseClickHandler=function(self,aL,c2,ap,aq)if cj.mouseClickHandler(self,aL,c2,ap,aq)then if aL=="mouse_click"and c2==1 then end;return true end;return false end,draw=function(self)if cj.draw(self)then if self.parent~=nil then local cn,co=self:getAnchorPosition()local cp=b2(self.height,"center")self.parent:drawBackgroundBox(cn,co,self.width,self.height,self.bgColor)for ag=1,self.height do if ag==cp then local cG=tostring(cj.getValue())local d0=self.bgColor;local c_=self.fgColor;local ar;if cG:len()<=0 then ar=cX;d0=cV or d0;c_=cW or c_ end;ar=cX;if cG~=""then ar=cG end;ar=ar:sub(cT,self.width+cT-1)local d5=self.width-ar:len()if d5<0 then d5=0 end;if cQ=="password"and cG~=""then ar=string.rep("*",ar:len())end;ar=ar..string.rep(" ",d5)self.parent:writeText(cn,co+ag-1,ar,d0,c_)end end end;self:setVisualChanged(false)end end}return setmetatable(bO,cj)end;local function d6(bF)local cj=bE(bF)local bG="Label"cj:setZIndex(3)cj.fgColor=colors.white;cj.bgcolor=colors.black;local d7=true;cj:setValue("")local ck="left"local cl="top"local d8=0;local bO={getType=function(self)return bG end,setText=function(self,ar)ar=tostring(ar)cj:setValue(ar)if d7 then self.width=ar:len()end;return self end,setTextAlign=function(self,d9,da)ck=d9 or ck;cl=da or cl;self:setVisualChanged()return self end,setFontSize=function(self,u)if u>0 and u<=4 then d8=u-1 or 0 end;return self end,getFontSize=function(self)return d8+1 end,setSize=function(self,a6,m)cj.setSize(self,a6,m)d7=false;self:setVisualChanged()return self end,draw=function(self)if cj.draw(self)then if self.parent~=nil then local cn,co=self:getAnchorPosition()local cp=b2(self.height,cl)self.parent:drawBackgroundBox(cn,co,self.width,self.height,self.bgColor)self.parent:drawForegroundBox(cn,co,self.width,self.height,self.fgColor)self.parent:drawTextBox(cn,co,self.width,self.height," ")if d8==0 then for ag=1,self.height do if ag==cp then self.parent:writeText(cn,co+ag-1,aZ(self:getValue(),self.width,ck),self.bgColor,self.fgColor)end end else local db=K(d8,self:getValue(),self.fgColor,self.bgColor)if d7 then self.height=#db[1]-1;self.width=#db[1][1]end;for ag=1,self.height do if ag==cp then local dc,dd=self.parent:getSize()local de,df=#db[1][1],#db[1]cn=cn or math.floor((dc-de)/2)+1;co=co or math.floor((dd-df)/2)+1;for o=1,df do self.parent:setFG(cn,co+o+ag-2,aZ(db[2][o],self.width,ck))self.parent:setBG(cn,co+o+ag-2,aZ(db[3][o],self.width,ck,g[self.bgColor]))self.parent:setText(cn,co+o+ag-2,aZ(db[1][o],self.width,ck))end end end end end;self:setVisualChanged(false)end end}return setmetatable(bO,cj)end;local function dg(bF)local cj=bE(bF)local bG="List"cj.width=16;cj.height=6;cj.bgColor=h.listBG;cj.fgColor=h.listFG;cj:setZIndex(5)local cs={}local ct=h.selectionBG;local cu=h.selectionFG;local cv=true;local cw="left"local cx=0;local dh=true;local bO={getType=function(self)return bG end,addItem=function(self,ar,aB,aC,...)table.insert(cs,{text=ar,bgCol=aB or self.bgColor,fgCol=aC or self.fgColor,args={...}})if#cs==1 then self:setValue(cs[1])end;return self end,setIndexOffset=function(self,cD)cx=cD;return self end,getIndexOffset=function(self)return cx end,removeItem=function(self,aK)table.remove(cs,aK)return self end,getItem=function(self,aK)return cs[aK]end,getAll=function(self)return cs end,getItemIndex=function(self)local cE=self:getValue()for bp,aP in pairs(cs)do if aP==cE then return bp end end end,clear=function(self)cs={}self:setValue({})return self end,getItemCount=function(self)return#cs end,editItem=function(self,aK,ar,aB,aC,...)table.remove(cs,aK)table.insert(cs,aK,{text=ar,bgCol=aB or self.bgColor,fgCol=aC or self.fgColor,args={...}})return self end,selectItem=function(self,aK)self:setValue(cs[aK]or{})return self end,setSelectedItem=function(self,aB,aC,cF)ct=aB or self.bgColor;cu=aC or self.fgColor;cv=cF;return self end,setScrollable=function(self,di)dh=di;return self end,mouseClickHandler=function(self,aL,c2,ap,aq)local cn,co=self:getAbsolutePosition(self:getAnchorPosition())if cn<=ap and cn+self.width>ap and co<=aq and co+self.height>aq and self:isVisible()then if(aL=="mouse_click"or aL=="mouse_drag")and c2==1 or aL=="monitor_touch"then if#cs>0 then for ag=1,self.height do if cs[ag+cx]~=nil then if cn<=ap and cn+self.width>ap and co+ag-1==aq then self:setValue(cs[ag+cx])self:getEventSystem():sendEvent("mouse_click",self,"mouse_click",0,ap,aq,cs[ag+cx])end end end end end;if aL=="mouse_scroll"and dh then cx=cx+c2;if cx<0 then cx=0 end;if c2>=1 then if#cs>self.height then if cx>#cs-self.height then cx=#cs-self.height end;if cx>=#cs then cx=#cs-1 end else cx=cx-1 end end end;self:setVisualChanged()return true end end,draw=function(self)if cj.draw(self)then if self.parent~=nil then local cn,co=self:getAnchorPosition()self.parent:drawBackgroundBox(cn,co,self.width,self.height,self.bgColor)for ag=1,self.height do if cs[ag+cx]~=nil then if cs[ag+cx]==self:getValue()then if cv then self.parent:writeText(cn,co+ag-1,aZ(cs[ag+cx].text,self.width,cw),ct,cu)else self.parent:writeText(cn,co+ag-1,aZ(cs[ag+cx].text,self.width,cw),cs[ag+cx].bgCol,cs[ag+cx].fgCol)end else self.parent:writeText(cn,co+ag-1,aZ(cs[ag+cx].text,self.width,cw),cs[ag+cx].bgCol,cs[ag+cx].fgCol)end end end end;self:setVisualChanged(false)end end}return setmetatable(bO,cj)end;local function dj(bF)local cj=bE(bF)local bG="Menubar"local bO={}cj.width=30;cj.height=1;cj.bgColor=colors.gray;cj.fgColor=colors.lightGray;cj:setZIndex(5)local cs={}local ct=h.selectionBG;local cu=h.selectionFG;local cv=true;local cw="left"local dk=0;local d5=1;local dh=false;local function dl()local dm=0;local bS=0;for ag=1,#cs do if bS+cs[ag].text:len()+d5*2>bO.width then if bS<bO.width then dm=dm+cs[ag].text:len()+d5*2-(bO.width-bS)else dm=dm+cs[ag].text:len()+d5*2 end end;bS=bS+cs[ag].text:len()+d5*2 end;return dm end;bO={getType=function(self)return bG end,addItem=function(self,ar,aB,aC,...)table.insert(cs,{text=ar,bgCol=aB or self.bgColor,fgCol=aC or self.fgColor,args={...}})if#cs==1 then self:setValue(cs[1])end;return self end,getAll=function(self)return cs end,getItemIndex=function(self)local cE=self:getValue()for bp,aP in pairs(cs)do if aP==cE then return bp end end end,clear=function(self)cs={}self:setValue({})return self end,setSpace=function(self,dn)d5=dn or d5;return self end,setPositionOffset=function(self,b1)dk=b1 or 0;if dk<0 then dk=0 end;local dm=dl()if dk>dm then dk=dm end;return self end,getPositionOffset=function(self)return dk end,setScrollable=function(self,di)dh=di;if di==nil then dh=true end;return self end,removeItem=function(self,aK)table.remove(cs,aK)return self end,getItem=function(self,aK)return cs[aK]end,getItemCount=function(self)return#cs end,editItem=function(self,aK,ar,aB,aC,...)table.remove(cs,aK)table.insert(cs,aK,{text=ar,bgCol=aB or self.bgColor,fgCol=aC or self.fgColor,args={...}})return self end,selectItem=function(self,aK)self:setValue(cs[aK]or{})return self end,setSelectedItem=function(self,aB,aC,cF)ct=aB or self.bgColor;cu=aC or self.fgColor;cv=cF;return self end,mouseClickHandler=function(self,aL,c2,ap,aq)if cj.mouseClickHandler(self,aL,c2,ap,aq)then local c3,c4=self:getAbsolutePosition(self:getAnchorPosition())if c3<=ap and c3+self.width>ap and c4<=aq and c4+self.height>aq and self:isVisible()then if self.parent~=nil then self.parent:setFocusedObject(self)end;if aL=="mouse_click"or aL=="monitor_touch"then local bS=0;for ag=1,#cs do if cs[ag]~=nil then if c3+bS<=ap+dk and c3+bS+cs[ag].text:len()+d5*2>ap+dk and c4==aq then self:setValue(cs[ag])self:getEventSystem():sendEvent(aL,self,aL,0,ap,aq,cs[ag])end;bS=bS+cs[ag].text:len()+d5*2 end end end;if aL=="mouse_scroll"and dh then dk=dk+c2;if dk<0 then dk=0 end;local dm=dl()if dk>dm then dk=dm end end;self:setVisualChanged(true)return true end end;return false end,draw=function(self)if cj.draw(self)then if self.parent~=nil then local cn,co=self:getAnchorPosition()self.parent:drawBackgroundBox(cn,co,self.width,self.height,self.bgColor)local ar=""local dp=""local dq=""for aO,dr in pairs(cs)do local ds=(" "):rep(d5)..dr.text..(" "):rep(d5)ar=ar..ds;if dr==self:getValue()then dp=dp..g[ct or dr.bgCol or self.bgColor]:rep(ds:len())dq=dq..g[cu or dr.FgCol or self.fgColor]:rep(ds:len())else dp=dp..g[dr.bgCol or self.bgColor]:rep(ds:len())dq=dq..g[dr.FgCol or self.fgColor]:rep(ds:len())end end;self.parent:setText(cn,co,ar:sub(dk+1,self.width+dk))self.parent:setBG(cn,co,dp:sub(dk+1,self.width+dk))self.parent:setFG(cn,co,dq:sub(dk+1,self.width+dk))end;self:setVisualChanged(false)end end}return setmetatable(bO,cj)end;local function dt(bF)local cj=bE(bF)local bG="Pane"local bO={getType=function(self)return bG end,draw=function(self)if cj.draw(self)then if self.parent~=nil then local cn,co=self:getAnchorPosition()self.parent:drawBackgroundBox(cn,co,self.width,self.height,self.bgColor)self.parent:drawForegroundBox(cn,co,self.width,self.height,self.bgColor)end;self:setVisualChanged(false)end end}return setmetatable(bO,cj)end;local function du(bF)local cj=bE(bF)local bG="Program"cj:setZIndex(5)local bO;local function dv(ap,aq,a6,m)local dw,dx=1,1;local b8,dy=colors.black,colors.white;local dz=false;local dA=false;local a7={}local a8={}local a9={}local dB={}local ad;local ae={}for o=0,15 do local dC=2^o;dB[dC]={e.getPaletteColour(dC)}end;local function af()ad=(" "):rep(a6)for ag=0,15 do local ah=2^ag;local ai=g[ah]ae[ah]=ai:rep(a6)end end;local function aj()af()local ak=ad;local al=ae[colors.white]local am=ae[colors.black]for ag=1,m do a7[ag]=f(a7[ag]==nil and ak or a7[ag]..ak:sub(1,a6-a7[ag]:len()),1,a6)a9[ag]=f(a9[ag]==nil and al or a9[ag]..al:sub(1,a6-a9[ag]:len()),1,a6)a8[ag]=f(a8[ag]==nil and am or a8[ag]..am:sub(1,a6-a8[ag]:len()),1,a6)end end;aj()local function dD()if dw>=1 and dx>=1 and dw<=a6 and dx<=m then else end end;local function dE(dF,dG,dH)local dI=dw;local au=dI+#dF-1;if dx>=1 and dx<=m then if dI<=a6 and au>=1 then if dI==1 and au==a6 then a7[dx]=dF;a9[dx]=dG;a8[dx]=dH else local dJ,dK,dL;if dI<1 then local dM=1-dI+1;local dN=a6-dI+1;dJ=f(dF,dM,dN)dK=f(dG,dM,dN)dL=f(dH,dM,dN)elseif au>a6 then local dN=a6-dI+1;dJ=f(dF,1,dN)dK=f(dG,1,dN)dL=f(dH,1,dN)else dJ=dF;dK=dG;dL=dH end;local dO=a7[dx]local dP=a9[dx]local dQ=a8[dx]local dR,dS,dT;if dI>1 then local dU=dI-1;dR=f(dO,1,dU)..dJ;dS=f(dP,1,dU)..dK;dT=f(dQ,1,dU)..dL else dR=dJ;dS=dK;dT=dL end;if au<a6 then local dV=au+1;dR=dR..f(dO,dV,a6)dS=dS..f(dP,dV,a6)dT=dT..f(dQ,dV,a6)end;a7[dx]=dR;a9[dx]=dS;a8[dx]=dT end end;dw=au+1;if dA then dD()end end end;local function ao(dW,dX,ar)if ar~=nil then local dY=a7[dX]if dY~=nil then a7[dX]=f(dY:sub(1,dW-1)..ar..dY:sub(dW+ar:len(),a6),1,a6)end end end;local function ax(dW,dX,ay)if ay~=nil then local dZ=a8[dX]if dZ~=nil then a8[dX]=f(dZ:sub(1,dW-1)..ay..dZ:sub(dW+ay:len(),a6),1,a6)end end end;local function az(dW,dX,ay)if ay~=nil then local d_=a9[dX]if d_~=nil then a9[dX]=f(d_:sub(1,dW-1)..ay..d_:sub(dW+ay:len(),a6),1,a6)end end end;local e0=function(bW)if type(bW)~="number"then error("bad argument #1 (expected number, got "..type(bW)..")",2)elseif g[bW]==nil then error("Invalid color (got "..bW..")",2)end;dy=bW end;local e1=function(bW)if type(bW)~="number"then error("bad argument #1 (expected number, got "..type(bW)..")",2)elseif g[bW]==nil then error("Invalid color (got "..bW..")",2)end;b8=bW end;local e2=function(e3,e4,e5,br)if type(e3)~="number"then error("bad argument #1 (expected number, got "..type(e3)..")",2)end;if g[e3]==nil then error("Invalid color (got "..e3 ..")",2)end;local e6;if type(e4)=="number"and e5==nil and br==nil then e6={colours.rgb8(e4)}dB[e3]=e6 else if type(e4)~="number"then error("bad argument #2 (expected number, got "..type(e4)..")",2)end;if type(e5)~="number"then error("bad argument #3 (expected number, got "..type(e5)..")",2)end;if type(br)~="number"then error("bad argument #4 (expected number, got "..type(br)..")",2)end;e6=dB[e3]e6[1]=e4;e6[2]=e5;e6[3]=br end end;local e7=function(e3)if type(e3)~="number"then error("bad argument #1 (expected number, got "..type(e3)..")",2)end;if g[e3]==nil then error("Invalid color (got "..e3 ..")",2)end;local e6=dB[e3]return e6[1],e6[2],e6[3]end;local e8={setCursorPos=function(dW,dX)if type(dW)~="number"then error("bad argument #1 (expected number, got "..type(dW)..")",2)end;if type(dX)~="number"then error("bad argument #2 (expected number, got "..type(dX)..")",2)end;dw=math.floor(dW)dx=math.floor(dX)if dA then dD()end end,getCursorPos=function()return dw,dx end,setCursorBlink=function(e9)if type(e9)~="boolean"then error("bad argument #1 (expected boolean, got "..type(e9)..")",2)end;dz=e9 end,getCursorBlink=function()return dz end,getPaletteColor=e7,getPaletteColour=e7,setBackgroundColor=e1,setBackgroundColour=e1,setTextColor=e0,setTextColour=e0,setPaletteColor=e2,setPaletteColour=e2,getBackgroundColor=function()return b8 end,getBackgroundColour=function()return b8 end,getSize=function()return a6,m end,getTextColor=function()return dy end,getTextColour=function()return dy end,basalt_resize=function(ea,eb)a6,m=ea,eb;aj()end,basalt_reposition=function(dW,dX)ap,aq=dW,dX end,basalt_setVisible=function(ec)dA=ec end,drawBackgroundBox=function(dW,dX,ea,eb,aB)for ag=1,eb do ax(dW,dX+ag-1,g[aB]:rep(ea))end end,drawForegroundBox=function(dW,dX,ea,eb,aC)for ag=1,eb do az(dW,dX+ag-1,g[aC]:rep(ea))end end,drawTextBox=function(dW,dX,ea,eb,aD)for ag=1,eb do ao(dW,dX+ag-1,aD:rep(ea))end end,writeText=function(dW,dX,ar,aB,aC)aB=aB or b8;aC=aC or dy;ao(ap,dX,ar)ax(dW,dX,g[aB]:rep(ar:len()))az(dW,dX,g[aC]:rep(ar:len()))end,basalt_update=function()if bO.parent~=nil then for ag=1,m do bO.parent:setText(ap,aq+ag-1,a7[ag])bO.parent:setBG(ap,aq+ag-1,a8[ag])bO.parent:setFG(ap,aq+ag-1,a9[ag])end end end,scroll=function(b1)if type(b1)~="number"then error("bad argument #1 (expected number, got "..type(b1)..")",2)end;if b1~=0 then local ed=ad;local ee=ae[dy]local ef=ae[b8]for eg=1,m do local aq=eg+b1;if aq>=1 and aq<=m then a7[eg]=a7[aq]a8[eg]=a8[aq]a9[eg]=a9[aq]else a7[eg]=ed;a9[eg]=ee;a8[eg]=ef end end end;if dA then dD()end end,isColor=function()return e.isColor()end,isColour=function()return e.isColor()end,write=function(ar)ar=tostring(ar)if dA then dE(ar,g[dy]:rep(ar:len()),g[b8]:rep(ar:len()))end end,clearLine=function()if dA then ao(1,dx,(" "):rep(a6))ax(1,dx,g[b8]:rep(a6))az(1,dx,g[dy]:rep(a6))end;if dA then dD()end end,clear=function()for ag=1,m do ao(1,ag,(" "):rep(a6))ax(1,ag,g[b8]:rep(a6))az(1,ag,g[dy]:rep(a6))end;if dA then dD()end end,blit=function(ar,eh,ei)if type(ar)~="string"then error("bad argument #1 (expected string, got "..type(ar)..")",2)end;if type(eh)~="string"then error("bad argument #2 (expected string, got "..type(eh)..")",2)end;if type(ei)~="string"then error("bad argument #3 (expected string, got "..type(ei)..")",2)end;if#eh~=#ar or#ei~=#ar then error("Arguments must be the same length",2)end;if dA then dE(ar,eh,ei)end end}return e8 end;cj.width=30;cj.height=12;local ej=dv(1,1,cj.width,cj.height)local ek;local el=false;local em={}bO={getType=function(self)return bG end,show=function(self)cj.show(self)ej.setBackgroundColor(self.bgColor)ej.setTextColor(self.fgColor)ej.basalt_setVisible(true)return self end,hide=function(self)cj.hide(self)ej.basalt_setVisible(false)return self end,setPosition=function(self,ap,aq,bU)cj.setPosition(self,ap,aq,bU)ej.basalt_reposition(self:getAnchorPosition())return self end,getBasaltWindow=function()return ej end,getBasaltProcess=function()return ek end,setSize=function(self,a6,m)cj.setSize(self,a6,m)ej.basalt_resize(self.width,self.height)return self end,getStatus=function(self)if ek~=nil then return ek:getStatus()end;return"inactive"end,execute=function(self,aT,...)ek=aR:new(aT,ej,...)ej.setBackgroundColor(colors.black)ej.setTextColor(colors.white)ej.clear()ej.setCursorPos(1,1)ek:resume()el=false;return self end,stop=function(self)if ek~=nil then if not ek:isDead()then ek:resume("terminate")if ek:isDead()then if self.parent~=nil then self.parent:setCursor(false)end end end end;return self end,pause=function(self,en)el=en or not el;if ek~=nil then if not ek:isDead()then if not el then self:injectEvents(em)em={}end end end;return self end,isPaused=function(self)return el end,injectEvent=function(self,aL,c5,c6,c7,c8,eo)if ek~=nil then if not ek:isDead()then if el==false or eo then ek:resume(aL,c5,c6,c7,c8)else table.insert(em,{event=aL,args={c5,c6,c7,c8}})end end end;return self end,getQueuedEvents=function(self)return em end,updateQueuedEvents=function(self,aJ)em=aJ or em;return self end,injectEvents=function(self,aJ)if ek~=nil then if not ek:isDead()then for aO,aP in pairs(aJ)do ek:resume(aP.event,table.unpack(aP.args))end end end;return self end,mouseClickHandler=function(self,aL,c2,ap,aq)if cj.mouseClickHandler(self,aL,c2,ap,aq)then if ek==nil then return false end;if not ek:isDead()then if not el then local ep,eq=self:getAbsolutePosition(self:getAnchorPosition(nil,nil,true))ek:resume(aL,c2,ap-ep+1,aq-eq+1)end end;return true end end,keyHandler=function(self,aL,bp)cj.keyHandler(self,aL,bp)if self:isFocused()then if ek==nil then return false end;if not ek:isDead()then if not el then if self.draw then ek:resume(aL,bp)end end end end end,getFocusHandler=function(self)cj.getFocusHandler(self)if ek~=nil then if not ek:isDead()then if not el then if self.parent~=nil then local er,es=ej.getCursorPos()local cn,co=self:getAnchorPosition()if self.parent~=nil then if cn+er-1>=1 and cn+er-1<=cn+self.width-1 and es+co-1>=1 and es+co-1<=co+self.height-1 then self.parent:setCursor(ej.getCursorBlink(),cn+er-1,es+co-1,ej.getTextColor())end end end end end end end,loseFocusHandler=function(self)cj.loseFocusHandler(self)if ek~=nil then if not ek:isDead()then if self.parent~=nil then self.parent:setCursor(false)end end end end,eventHandler=function(self,aL,c5,c6,c7,c8)if ek==nil then return end;if not ek:isDead()then if not el then if aL~="mouse_click"and aL~="monitor_touch"and aL~="mouse_up"and aL~="mouse_scroll"and aL~="mouse_drag"and aL~="key_up"and aL~="key"and aL~="char"and aL~="terminate"then ek:resume(aL,c5,c6,c7,c8)end;if self:isFocused()then local cn,co=self:getAnchorPosition()local er,es=ej.getCursorPos()if self.parent~=nil then if cn+er-1>=1 and cn+er-1<=cn+self.width-1 and es+co-1>=1 and es+co-1<=co+self.height-1 then self.parent:setCursor(ej.getCursorBlink(),cn+er-1,es+co-1,ej.getTextColor())end end;if aL=="terminate"and self:isFocused()then self:stop()end end else if aL~="mouse_click"and aL~="monitor_touch"and aL~="mouse_up"and aL~="mouse_scroll"and aL~="mouse_drag"and aL~="key_up"and aL~="key"and aL~="char"and aL~="terminate"then table.insert(em,{event=aL,args={c5,c6,c7,c8}})end end end end,draw=function(self)if cj.draw(self)then if self.parent~=nil then local cn,co=self:getAnchorPosition()ej.basalt_reposition(cn,co)self.parent:drawBackgroundBox(cn,co,self.width,self.height,self.bgColor)ej.basalt_update()end;self:setVisualChanged(false)end end}return setmetatable(bO,cj)end;local function et(bF)local cj=bE(bF)local bG="Progressbar"local eu=0;cj:setZIndex(5)cj:setValue(false)cj.width=25;cj.height=1;cj.bgColor=h.CheckboxBG;cj.fgColor=h.CheckboxFG;local ev=colors.black;local ew=""local ex=colors.white;local ey=""local ez=0;local bO={getType=function(self)return bG end,setDirection=function(self,eA)ez=eA;return self end,setProgressBar=function(self,bW,aD,eB)ev=bW or ev;ew=aD or ew;ex=eB or ex;return self end,setBackgroundSymbol=function(self,aD)ey=aD:sub(1,1)return self end,setProgress=function(self,aP)if aP>=0 and aP<=100 and eu~=aP then eu=aP;self:setValue(eu)if eu==100 then self:progressDoneHandler()end end;return self end,getProgress=function(self)return eu end,onProgressDone=function(self,x)self:registerEvent("progress_done",x)return self end,progressDoneHandler=function(self)self:sendEvent("progress_done")end,draw=function(self)if cj.draw(self)then if self.parent~=nil then local cn,co=self:getAnchorPosition()self.parent:drawBackgroundBox(cn,co,self.width,self.height,self.bgColor)self.parent:drawForegroundBox(cn,co,self.width,self.height,self.fgColor)self.parent:drawTextBox(cn,co,self.width,self.height,ey)if ez==1 then self.parent:drawBackgroundBox(cn,co,self.width,self.height/100*eu,ev)self.parent:drawForegroundBox(cn,co,self.width,self.height/100*eu,ex)self.parent:drawTextBox(cn,co,self.width,self.height/100*eu,ew)elseif ez==2 then self.parent:drawBackgroundBox(cn,co+math.ceil(self.height-self.height/100*eu),self.width,self.height/100*eu,ev)self.parent:drawForegroundBox(cn,co+math.ceil(self.height-self.height/100*eu),self.width,self.height/100*eu,ex)self.parent:drawTextBox(cn,co+math.ceil(self.height-self.height/100*eu),self.width,self.height/100*eu,ew)elseif ez==3 then self.parent:drawBackgroundBox(cn+math.ceil(self.width-self.width/100*eu),co,self.width/100*eu,self.height,ev)self.parent:drawForegroundBox(cn+math.ceil(self.width-self.width/100*eu),co,self.width/100*eu,self.height,ex)self.parent:drawTextBox(cn+math.ceil(self.width-self.width/100*eu),co,self.width/100*eu,self.height,ew)else self.parent:drawBackgroundBox(cn,co,self.width/100*eu,self.height,ev)self.parent:drawForegroundBox(cn,co,self.width/100*eu,self.height,ex)self.parent:drawTextBox(cn,co,self.width/100*eu,self.height,ew)end end;self:setVisualChanged(false)end end}return setmetatable(bO,cj)end;local function eC(bF)local cj=bE(bF)local bG="Radio"cj.width=8;cj.bgColor=h.listBG;cj.fgColor=h.listFG;cj:setZIndex(5)local cs={}local ct=h.selectionBG;local cu=h.selectionFG;local eD=cj.bgColor;local eE=cj.fgColor;local cv=true;local aD="\7"local cw="left"local bO={getType=function(self)return bG end,addItem=function(self,ar,ap,aq,aB,aC,...)table.insert(cs,{x=ap or 1,y=aq or 1,text=ar,bgCol=aB or self.bgColor,fgCol=aC or self.fgColor,args={...}})if#cs==1 then self:setValue(cs[1])end;return self end,getAll=function(self)return cs end,removeItem=function(self,aK)table.remove(cs,aK)return self end,getItem=function(self,aK)return cs[aK]end,getItemIndex=function(self)local cE=self:getValue()for bp,aP in pairs(cs)do if aP==cE then return bp end end end,clear=function(self)cs={}self:setValue({})return self end,getItemCount=function(self)return#cs end,editItem=function(self,aK,ar,ap,aq,aB,aC,...)table.remove(cs,aK)table.insert(cs,aK,{x=ap or 1,y=aq or 1,text=ar,bgCol=aB or self.bgColor,fgCol=aC or self.fgColor,args={...}})return self end,selectItem=function(self,aK)self:setValue(cs[aK]or{})return self end,setSelectedItem=function(self,aB,aC,eF,eG,cF)ct=aB or ct;cu=aC or cu;eD=eF or eD;eE=eG or eE;cv=cF;return self end,mouseClickHandler=function(self,aL,c2,ap,aq)local cn,co=self:getAbsolutePosition(self:getAnchorPosition())if aL=="mouse_click"and c2==1 or aL=="monitor_touch"then if#cs>0 then for aO,aP in pairs(cs)do if cn+aP.x-1<=ap and cn+aP.x-1+aP.text:len()+2>=ap and co+aP.y-1==aq then self:setValue(aP)if self.parent~=nil then self.parent:setFocusedObject(self)end;self:setVisualChanged()return true end end end end;return false end,draw=function(self)if cj.draw(self)then if self.parent~=nil then local cn,co=self:getAnchorPosition()for aO,aP in pairs(cs)do if aP==self:getValue()then if cw=="left"then self.parent:writeText(aP.x+cn-1,aP.y+co-1,aD,eD,eE)self.parent:writeText(aP.x+2+cn-1,aP.y+co-1,aP.text,ct,cu)end else self.parent:drawBackgroundBox(aP.x+cn-1,aP.y+co-1,1,1,self.bgColor)self.parent:writeText(aP.x+2+cn-1,aP.y+co-1,aP.text,aP.bgCol,aP.fgCol)end end end;self:setVisualChanged(false)end end}return setmetatable(bO,cj)end;local function eH(bF)local cj=bE(bF)local bG="Scrollbar"cj.width=1;cj.height=8;cj.bgColor=colors.lightGray;cj.fgColor=colors.gray;cj:setValue(1)cj:setZIndex(2)local eI="vertical"local aD=" "local eJ=colors.black;local eK="\127"local eL=cj.height;local aK=1;local eM=1;local bO={getType=function(self)return bG end,setSymbol=function(self,eN)aD=eN:sub(1,1)self:setVisualChanged()return self end,setSymbolSize=function(self,u)eM=tonumber(u)or 1;if eI=="vertical"then self:setValue(aK-1*eL/(self.height-(eM-1))-eL/(self.height-(eM-1)))elseif eI=="horizontal"then self:setValue(aK-1*eL/(self.width-(eM-1))-eL/(self.width-(eM-1)))end;self:setVisualChanged()return self end,setMaxValue=function(self,cG)eL=cG;return self end,setBackgroundSymbol=function(self,eO)eK=string.sub(eO,1,1)self:setVisualChanged()return self end,setSymbolColor=function(self,eP)eJ=eP;self:setVisualChanged()return self end,setBarType=function(self,eQ)eI=eQ:lower()return self end,mouseClickHandler=function(self,aL,c2,ap,aq)if cj.mouseClickHandler(self,aL,c2,ap,aq)then local cn,co=self:getAbsolutePosition(self:getAnchorPosition())if(aL=="mouse_click"or aL=="mouse_drag")and c2==1 or aL=="monitor_touch"then if eI=="horizontal"then for eR=0,self.width do if cn+eR==ap and co<=aq and co+self.height>aq then aK=math.min(eR+1,self.width-(eM-1))self:setValue(eL/self.width*aK)self:setVisualChanged()end end end;if eI=="vertical"then for eR=0,self.height do if co+eR==aq and cn<=ap and cn+self.width>ap then aK=math.min(eR+1,self.height-(eM-1))self:setValue(eL/self.height*aK)self:setVisualChanged()end end end end;if aL=="mouse_scroll"then aK=aK+c2;if aK<1 then aK=1 end;aK=math.min(aK,(eI=="vertical"and self.height or self.width)-(eM-1))self:setValue(eL/(eI=="vertical"and self.height or self.width)*aK)end;return true end end,draw=function(self)if cj.draw(self)then if self.parent~=nil then local cn,co=self:getAnchorPosition()if eI=="horizontal"then self.parent:writeText(cn,co,eK:rep(aK-1),self.bgColor,self.fgColor)self.parent:writeText(cn+aK-1,co,aD:rep(eM),eJ,eJ)self.parent:writeText(cn+aK+eM-1,co,eK:rep(self.width-(aK+eM-1)),self.bgColor,self.fgColor)end;if eI=="vertical"then for ag=0,self.height-1 do if aK==ag+1 then for eS=0,math.min(eM-1,self.height)do self.parent:writeText(cn,co+ag+eS,aD,eJ,eJ)end else if ag+1<aK or ag+1>aK-1+eM then self.parent:writeText(cn,co+ag,eK,self.bgColor,self.fgColor)end end end end end;self:setVisualChanged(false)end end}return setmetatable(bO,cj)end;local function eT(bF)local cj=bE(bF)local bG="Slider"cj.width=8;cj.height=1;cj.bgColor=colors.lightGray;cj.fgColor=colors.gray;cj:setValue(1)local eI="horizontal"local aD=" "local eJ=colors.black;local eK="\140"local eL=cj.width;local aK=1;local eM=1;local bO={getType=function(self)return bG end,setSymbol=function(self,eN)aD=eN:sub(1,1)self:setVisualChanged()return self end,setSymbolSize=function(self,u)eM=tonumber(u)or 1;if eI=="vertical"then self:setValue(aK-1*eL/(self.height-(eM-1))-eL/(self.height-(eM-1)))elseif eI=="horizontal"then self:setValue(aK-1*eL/(self.width-(eM-1))-eL/(self.width-(eM-1)))end;self:setVisualChanged()return self end,setMaxValue=function(self,cG)eL=cG;return self end,setBackgroundSymbol=function(self,eO)eK=string.sub(eO,1,1)self:setVisualChanged()return self end,setSymbolColor=function(self,eP)eJ=eP;self:setVisualChanged()return self end,setBarType=function(self,eQ)eI=eQ:lower()return self end,mouseClickHandler=function(self,aL,c2,ap,aq)if cj.mouseClickHandler(self,aL,c2,ap,aq)then local cn,co=self:getAbsolutePosition(self:getAnchorPosition())if(aL=="mouse_click"or aL=="mouse_drag")and c2==1 or aL=="monitor_touch"then if eI=="horizontal"then for eR=0,self.width do if cn+eR==ap and co<=aq and co+self.height>aq then aK=math.min(eR+1,self.width-(eM-1))self:setValue(eL/self.width*aK)self:setVisualChanged()end end end;if eI=="vertical"then for eR=0,self.height do if co+eR==aq and cn<=ap and cn+self.width>ap then aK=math.min(eR+1,self.height-(eM-1))self:setValue(eL/self.height*aK)self:setVisualChanged()end end end end;if aL=="mouse_scroll"then aK=aK+c2;if aK<1 then aK=1 end;aK=math.min(aK,(eI=="vertical"and self.height or self.width)-(eM-1))self:setValue(eL/(eI=="vertical"and self.height or self.width)*aK)end;return true end end,draw=function(self)if cj.draw(self)then if self.parent~=nil then local cn,co=self:getAnchorPosition()if eI=="horizontal"then self.parent:writeText(cn,co,eK:rep(aK-1),self.bgColor,self.fgColor)self.parent:writeText(cn+aK-1,co,aD:rep(eM),eJ,eJ)self.parent:writeText(cn+aK+eM-1,co,eK:rep(self.width-(aK+eM-1)),self.bgColor,self.fgColor)end;if eI=="vertical"then for ag=0,self.height-1 do if aK==ag+1 then for eS=0,math.min(eM-1,self.height)do self.parent:writeText(cn,co+ag+eS,aD,eJ,eJ)end else if ag+1<aK or ag+1>aK-1+eM then self.parent:writeText(cn,co+ag,eK,self.bgColor,self.fgColor)end end end end end;self:setVisualChanged(false)end end}return setmetatable(bO,cj)end;local function eU(bF)local cj=bE(bF)local bG="Switch"cj.width=2;cj.height=1;cj.bgColor=colors.lightGray;cj.fgColor=colors.gray;cj:setValue(false)cj:setZIndex(5)local eK=colors.black;local eV=colors.red;local eW=colors.green;local bO={getType=function(self)return bG end,setSymbolColor=function(self,eJ)eK=eJ;self:setVisualChanged()return self end,setActiveBackground=function(self,ei)eW=ei;self:setVisualChanged()return self end,setInactiveBackground=function(self,ei)eV=ei;self:setVisualChanged()return self end,mouseClickHandler=function(self,aL,c2,ap,aq)if cj.mouseClickHandler(self,aL,c2,ap,aq)then local cn,co=self:getAbsolutePosition(self:getAnchorPosition())if aL=="mouse_click"and c2==1 or aL=="monitor_touch"then self:setValue(not self:getValue())end;return true end end,draw=function(self)if cj.draw(self)then if self.parent~=nil then local cn,co=self:getAnchorPosition()self.parent:drawBackgroundBox(cn,co,self.width,self.height,self.bgColor)if self:getValue()then self.parent:drawBackgroundBox(cn,co,1,self.height,eW)self.parent:drawBackgroundBox(cn+1,co,1,self.height,eK)else self.parent:drawBackgroundBox(cn,co,1,self.height,eK)self.parent:drawBackgroundBox(cn+1,co,1,self.height,eV)end end;self:setVisualChanged(false)end end}return setmetatable(bO,cj)end;local function eX(bF)local cj=bE(bF)local bG="Textfield"local eY,cT,cS,eZ=1,1,1,1;local e_={""}local f0={[colors.purple]={"break"}}cj.width=20;cj.height=8;cj.bgColor=h.textfieldBG;cj.fgColor=h.textfieldFG;cj:setZIndex(5)local bO={getType=function(self)return bG end,getLines=function(self)return e_ end,getLine=function(self,aK)return e_[aK]or""end,editLine=function(self,aK,ar)e_[aK]=ar or e_[aK]return self end,addLine=function(self,ar,aK)if aK~=nil then table.insert(e_,aK,ar)else table.insert(e_,ar)end;return self end,addKeyword=function(self,f1,bW)end,removeLine=function(self,aK)table.remove(e_,aK or#e_)if#e_<=0 then table.insert(e_,"")end;return self end,getTextCursor=function(self)return cS,eZ end,getFocusHandler=function(self)cj.getFocusHandler(self)if self.parent~=nil then local cn,co=self:getAnchorPosition()if self.parent~=nil then self.parent:setCursor(true,cn+cS-cT,co+eZ-eY,self.fgColor)end end end,loseFocusHandler=function(self)cj.loseFocusHandler(self)if self.parent~=nil then self.parent:setCursor(false)end end,keyHandler=function(self,aL,bp)if cj.keyHandler(self,aL,bp)then local cn,co=self:getAnchorPosition()if aL=="key"then if bp==keys.backspace then if e_[eZ]==""then if eZ>1 then table.remove(e_,eZ)cS=e_[eZ-1]:len()+1;cT=cS-self.width+1;if cT<1 then cT=1 end;eZ=eZ-1 end elseif cS<=1 then if eZ>1 then cS=e_[eZ-1]:len()+1;cT=cS-self.width+1;if cT<1 then cT=1 end;e_[eZ-1]=e_[eZ-1]..e_[eZ]table.remove(e_,eZ)eZ=eZ-1 end else e_[eZ]=e_[eZ]:sub(1,cS-2)..e_[eZ]:sub(cS,e_[eZ]:len())if cS>1 then cS=cS-1 end;if cT>1 then if cS<cT then cT=cT-1 end end end;if eZ<eY then eY=eY-1 end;self:setValue("")end;if bp==keys.delete then if cS>e_[eZ]:len()then if e_[eZ+1]~=nil then e_[eZ]=e_[eZ]..e_[eZ+1]table.remove(e_,eZ+1)end else e_[eZ]=e_[eZ]:sub(1,cS-1)..e_[eZ]:sub(cS+1,e_[eZ]:len())end end;if bp==keys.enter then table.insert(e_,eZ+1,e_[eZ]:sub(cS,e_[eZ]:len()))e_[eZ]=e_[eZ]:sub(1,cS-1)eZ=eZ+1;cS=1;cT=1;if eZ-eY>=self.height then eY=eY+1 end;self:setValue("")end;if bp==keys.up then if eZ>1 then eZ=eZ-1;if cS>e_[eZ]:len()+1 then cS=e_[eZ]:len()+1 end;if cT>1 then if cS<cT then cT=cS-self.width+1;if cT<1 then cT=1 end end end;if eY>1 then if eZ<eY then eY=eY-1 end end end end;if bp==keys.down then if eZ<#e_ then eZ=eZ+1;if cS>e_[eZ]:len()+1 then cS=e_[eZ]:len()+1 end;if eZ>=eY+self.height then eY=eY+1 end end end;if bp==keys.right then cS=cS+1;if eZ<#e_ then if cS>e_[eZ]:len()+1 then cS=1;eZ=eZ+1 end elseif cS>e_[eZ]:len()then cS=e_[eZ]:len()+1 end;if cS<1 then cS=1 end;if cS<cT or cS>=self.width+cT then cT=cS-self.width+1 end;if cT<1 then cT=1 end end;if bp==keys.left then cS=cS-1;if cS>=1 then if cS<cT or cS>=self.width+cT then cT=cS end end;if eZ>1 then if cS<1 then eZ=eZ-1;cS=e_[eZ]:len()+1;cT=cS-self.width+1 end end;if cS<1 then cS=1 end;if cT<1 then cT=1 end end end;if aL=="char"then e_[eZ]=e_[eZ]:sub(1,cS-1)..bp..e_[eZ]:sub(cS,e_[eZ]:len())cS=cS+1;if cS>=self.width+cT then cT=cT+1 end;self:setValue("")end;local d4=(cS<=e_[eZ]:len()and cS-1 or e_[eZ]:len())-(cT-1)if d4>self.x+self.width-1 then d4=self.x+self.width-1 end;local f2=eZ-eY<self.height and eZ-eY or eZ-eY-1;if d4<1 then d4=0 end;self.parent:setCursor(true,cn+d4,co+f2,self.fgColor)return true end end,mouseClickHandler=function(self,aL,c2,ap,aq)if cj.mouseClickHandler(self,aL,c2,ap,aq)then local cn,co=self:getAbsolutePosition(self:getAnchorPosition())local f3,f4=self:getAnchorPosition()if aL=="mouse_click"or aL=="monitor_touch"then if e_[aq-co+eY]~=nil then cS=ap-cn+cT;eZ=aq-co+eY;if cS>e_[eZ]:len()then cS=e_[eZ]:len()+1 end;if cS<cT then cT=cS-1;if cT<1 then cT=1 end end;if self.parent~=nil then self.parent:setCursor(true,f3+cS-cT,f4+eZ-eY)end end end;if aL=="mouse_drag"then if e_[aq-co+eY]~=nil then cS=ap-cn+cT;eZ=aq-co+eY;if cS>e_[eZ]:len()then cS=e_[eZ]:len()+1 end;if cS<cT then cT=cS-1;if cT<1 then cT=1 end end;if self.parent~=nil then self.parent:setCursor(true,f3+cS-cT,f4+eZ-eY)end end end;if aL=="mouse_scroll"then eY=eY+c2;if eY>#e_-(self.height-1)then eY=#e_-(self.height-1)end;if eY<1 then eY=1 end;if self.parent~=nil then if cn+cS-cT>=cn and cn+cS-cT<=cn+self.width and(co+eZ-eY>=co and co+eZ-eY<=co+self.height)then self.parent:setCursor(true,f3+cS-cT,f4+eZ-eY)else self.parent:setCursor(false)end end end;self:setVisualChanged()return true end end,draw=function(self)if cj.draw(self)then if self.parent~=nil then local cn,co=self:getAnchorPosition()self.parent:drawBackgroundBox(cn,co,self.width,self.height,self.bgColor)self.parent:drawForegroundBox(cn,co,self.width,self.height,self.fgColor)for ag=1,self.height do local ar=""if e_[ag+eY-1]~=nil then ar=e_[ag+eY-1]end;ar=ar:sub(cT,self.width+cT-1)local d5=self.width-ar:len()if d5<0 then d5=0 end;ar=ar..string.rep(" ",d5)self.parent:setText(cn,co+ag-1,ar)end end;self:setVisualChanged(false)end end}return setmetatable(bO,cj)end;local function f5(bF)local bO;local bG="Thread"local aN;local f6;local f7=false;bO={name=bF,getType=function(self)return bG end,getZIndex=function(self)return 1 end,getName=function(self)return self.name end,start=function(self,x)if x==nil then error("Function provided to thread is nil")end;aN=x;f6=coroutine.create(aN)f7=true;local aX,aY=coroutine.resume(f6)if not aX then if aY~="Terminated"then error("Thread Error Occurred - "..aY)end end;return self end,getStatus=function(self,x)if f6~=nil then return coroutine.status(f6)end;return nil end,stop=function(self,x)f7=false;return self end,eventHandler=function(self,aL,c5,c6,c7)if f7 then if coroutine.status(f6)~="dead"then local aX,aY=coroutine.resume(f6,aL,c5,c6,c7)if not aX then if aY~="Terminated"then error("Thread Error Occurred - "..aY)end end else f7=false end end end}bO.__index=bO;return bO end;local function f8(bF)local bG="Timer"local f9=0;local fa=0;local fb=0;local ca;local bN=aI()local fc=false;local bO={name=bF,getType=function(self)return bG end,getZIndex=function(self)return 1 end,getName=function(self)return self.name end,setTime=function(self,fd,fe)f9=fd or 0;fa=fe or 1;return self end,start=function(self)if fc then os.cancelTimer(ca)end;fb=fa;ca=os.startTimer(f9)fc=true;return self end,isActive=function(self)return fc end,cancel=function(self)if ca~=nil then os.cancelTimer(ca)end;fc=false;return self end,onCall=function(self,aN)bN:registerEvent("timed_event",aN)return self end,eventHandler=function(self,aL,ch)if aL=="timer"and ch==ca and fc then bN:sendEvent("timed_event",self)if fb>=1 then fb=fb-1;if fb>=1 then ca=os.startTimer(f9)end elseif fb==-1 then ca=os.startTimer(f9)end end end}bO.__index=bO;return bO end;local function ff(bF,fg)local cj=bE(bF)local bG="Frame"local fh={}local fi={}local bO={}local fj;local fk=e;local fl={}local fm=false;cj:setZIndex(10)local aA=a3(fk)local dz=false;local dw=1;local dx=1;local fn=colors.white;local fo,cx=0,0;if fg~=nil then cj.parent=fg;cj.width,cj.height=fg.w,fg.h;cj.bgColor=h.FrameBG;cj.fgColor=h.FrameFG else cj.width,cj.height=fk.getSize()cj.bgColor=h.basaltBG;cj.fgColor=h.basaltFG end;local function fp(bF)for aO,aP in pairs(fh)do for aO,br in pairs(aP)do if br.name==bF then return aP end end end end;local function fq(fr)local bH=fr:getZIndex()if fp(fr.name)~=nil then return nil end;if fh[bH]==nil then for ap=1,#fi+1 do if fi[ap]~=nil then if bH==fi[ap]then break end;if bH>fi[ap]then table.insert(fi,ap,bH)break end else table.insert(fi,bH)end end;if#fi<=0 then table.insert(fi,bH)end;fh[bH]={}end;fr.parent=bO;table.insert(fh[bH],fr)return fr end;local function fs(fr)for bq,br in pairs(fh)do for bp,aP in pairs(br)do if aP==fr then table.remove(fh[bq],bp)return true end end end;return false end;bO={barActive=false,barBackground=colors.gray,barTextcolor=colors.black,barText="New Frame",barTextAlign="left",isMoveable=false,getType=function(self)return bG end,setFocusedObject=function(self,fr)for aO,aK in pairs(fi)do for aO,aP in pairs(fh[aK])do if aP==fr then if fj~=nil then fj:loseFocusHandler()end;fj=fr;fj:getFocusHandler()end end end;return self end,setOffset=function(self,b_,c0)fo=b_~=nil and math.floor(b_<0 and math.abs(b_)or-b_)or fo;cx=c0~=nil and math.floor(c0<0 and math.abs(c0)or-c0)or cx;return self end,getFrameOffset=function(self)return fo,cx end,removeFocusedObject=function(self)if fj~=nil then fj:loseFocusHandler()end;fj=nil;return self end,getFocusedObject=function(self)return fj end,show=function(self)cj:show()if self.parent==nil and not fm then b=self end;return self end,setCursor=function(self,ft,fu,fv,bW)local cn,co=self:getAbsolutePosition(self:getAnchorPosition())dz=ft or false;if fu~=nil then dw=cn+fu-1 end;if fv~=nil then dx=co+fv-1 end;fn=bW or fn;self:setVisualChanged()return self end,setMoveable=function(self,fw)self.isMoveable=fw or not self.isMoveable;self:setVisualChanged()return self end,addMonitor=function(self,fx)local fy=peripheral.wrap(fx)fl[fx]={monitor=fx,frame=a.createFrame(self:getName().."_monitor_"..fx)}fl[fx].frame:setDisplay(fy):setFrameAsMonitor()fl[fx].frame:setSize(fy:getSize())return fl[fx].frame end,setMonitorScale=function(self,fz,fA)if fm then fk.setTextScale(fz*0.5)if fA then self:setSize(fk:getSize())end end;return self,fm end,setFrameAsMonitor=function(self,fB)fm=fB;if fB==nil then fm=true end;return self end,showBar=function(self,fC)self.barActive=fC or not self.barActive;self:setVisualChanged()return self end,setBar=function(self,ar,aB,aC)self.barText=ar or""self.barBackground=aB or self.barBackground;self.barTextcolor=aC or self.barTextcolor;self:setVisualChanged()return self end,setBarTextAlign=function(self,cw)self.barTextAlign=cw or"left"self:setVisualChanged()return self end,setDisplay=function(self,a4)fk=a4;aA=a3(fk)return self end,getDisplay=function(self)return fk end,getVisualChanged=function(self)local fD=cj.getVisualChanged(self)for aO,aK in pairs(fi)do if fh[aK]~=nil then for aO,aP in pairs(fh[aK])do if aP.getVisualChanged~=nil and aP:getVisualChanged()then fD=true end end end end;return fD end,loseFocusHandler=function(self)cj.loseFocusHandler(self)end,getFocusHandler=function(self)cj.getFocusHandler(self)if self.parent~=nil then self.parent:removeObject(self)self.parent:addObject(self)end end,keyHandler=function(self,aL,bp)if fj~=nil then if fj.keyHandler~=nil then if fj:keyHandler(aL,bp)then return true end end end;return false end,backgroundKeyHandler=function(self,aL,bp)cj.backgroundKeyHandler(self,aL,bp)for aO,aK in pairs(fi)do if fh[aK]~=nil then for aO,aP in pairs(fh[aK])do if aP.backgroundKeyHandler~=nil then aP:backgroundKeyHandler(aL,bp)end end end end end,eventHandler=function(self,aL,c5,c6,c7,c8)cj.eventHandler(self,aL,c5,c6,c7,c8)for aO,aK in pairs(fi)do if fh[aK]~=nil then for aO,aP in pairs(fh[aK])do if aP.eventHandler~=nil then aP:eventHandler(aL,c5,c6,c7,c8)end end end end;if aL=="terminate"then fk.clear()fk.setCursorPos(1,1)a.stop()end end,mouseClickHandler=function(self,aL,c2,ap,aq)local b_,c0=self:getOffset()b_=b_<0 and math.abs(b_)or-b_;c0=c0<0 and math.abs(c0)or-c0;if self.drag then if aL=="mouse_drag"then local fE=1;local fF=1;if self.parent~=nil then fE,fF=self.parent:getAbsolutePosition(self.parent:getAnchorPosition())end;self:setPosition(ap+self.xToRem-(fE-1)+b_,aq-(fF-1)+c0)end;if aL=="mouse_up"then self.drag=false end;return true end;if cj.mouseClickHandler(self,aL,c2,ap,aq)then local bX,bY=self:getAbsolutePosition(self:getAnchorPosition())if aL~="monitor_touch"or fm then for aO,aK in pairs(fi)do if fh[aK]~=nil then for aO,aP in b4(fh[aK])do if aP.mouseClickHandler~=nil then if aP:mouseClickHandler(aL,c2,ap+b_,aq+c0)then return true end end end end end elseif not fm then for aO,dr in pairs(fl)do if c2==dr.monitor then dr.frame:mouseClickHandler(aL,c2,ap,aq)end end end;if self.isMoveable then if ap>=bX and ap<=bX+self.width-1 and aq==bY and aL=="mouse_click"then self.drag=true;self.xToRem=bX-ap end end;if fj~=nil then fj:loseFocusHandler()fj=nil end;return true end;return false end,setText=function(self,ap,aq,ar)local cn,co=self:getAbsolutePosition(self:getAnchorPosition())if aq>=1 and aq<=self.height then if self.parent~=nil then self.parent:setText(math.max(ap+cn-1,cn)-(self.parent.x-1),co+aq-1-(self.parent.y-1),f(ar,math.max(1-ap+1,1),self.width-ap+1))else aA.setText(math.max(ap+cn-1,cn),co+aq-1,f(ar,math.max(1-ap+1,1),self.width-ap+1))end end end,setBG=function(self,ap,aq,aB)local cn,co=self:getAbsolutePosition(self:getAnchorPosition())if aq>=1 and aq<=self.height then if self.parent~=nil then self.parent:setBG(math.max(ap+cn-1,cn)-(self.parent.x-1),co+aq-1-(self.parent.y-1),f(aB,math.max(1-ap+1,1),self.width-ap+1))else aA.setBG(math.max(ap+cn-1,cn),co+aq-1,f(aB,math.max(1-ap+1,1),self.width-ap+1))end end end,setFG=function(self,ap,aq,aC)local cn,co=self:getAbsolutePosition(self:getAnchorPosition())if aq>=1 and aq<=self.height then if self.parent~=nil then self.parent:setFG(math.max(ap+cn-1,cn)-(self.parent.x-1),co+aq-1-(self.parent.y-1),f(aC,math.max(1-ap+1,1),self.width-ap+1))else aA.setFG(math.max(ap+cn-1,cn),co+aq-1,f(aC,math.max(1-ap+1,1),self.width-ap+1))end end end,writeText=function(self,ap,aq,ar,aB,aC)local cn,co=self:getAbsolutePosition(self:getAnchorPosition())if aq>=1 and aq<=self.height then if self.parent~=nil then self.parent:writeText(math.max(ap+cn-1,cn)-(self.parent.x-1),co+aq-1-(self.parent.y-1),f(ar,math.max(1-ap+1,1),self.width-ap+1),aB,aC)else aA.writeText(math.max(ap+cn-1,cn),co+aq-1,f(ar,math.max(1-ap+1,1),self.width-ap+1),aB,aC)end end end,drawBackgroundBox=function(self,ap,aq,a6,m,aB)local cn,co=self:getAbsolutePosition(self:getAnchorPosition())m=aq<1 and(m+aq>self.height and self.height or m+aq-1)or(m+aq>self.height and self.height-aq+1 or m)a6=ap<1 and(a6+ap>self.width and self.width or a6+ap-1)or(a6+ap>self.width and self.width-ap+1 or a6)if self.parent~=nil then self.parent:drawBackgroundBox(math.max(ap+cn-1,cn)-(self.parent.x-1),math.max(aq+co-1,co)-(self.parent.y-1),a6,m,aB)else aA.drawBackgroundBox(math.max(ap+cn-1,cn),math.max(aq+co-1,co),a6,m,aB)end end,drawTextBox=function(self,ap,aq,a6,m,aD)local cn,co=self:getAbsolutePosition(self:getAnchorPosition())m=aq<1 and(m+aq>self.height and self.height or m+aq-1)or(m+aq>self.height and self.height-aq+1 or m)a6=ap<1 and(a6+ap>self.width and self.width or a6+ap-1)or(a6+ap>self.width and self.width-ap+1 or a6)if self.parent~=nil then self.parent:drawTextBox(math.max(ap+cn-1,cn)-(self.parent.x-1),math.max(aq+co-1,co)-(self.parent.y-1),a6,m,aD:sub(1,1))else aA.drawTextBox(math.max(ap+cn-1,cn),math.max(aq+co-1,co),a6,m,aD:sub(1,1))end end,drawForegroundBox=function(self,ap,aq,a6,m,aC)local cn,co=self:getAbsolutePosition(self:getAnchorPosition())m=aq<1 and(m+aq>self.height and self.height or m+aq-1)or(m+aq>self.height and self.height-aq+1 or m)a6=ap<1 and(a6+ap>self.width and self.width or a6+ap-1)or(a6+ap>self.width and self.width-ap+1 or a6)if self.parent~=nil then self.parent:drawForegroundBox(math.max(ap+cn-1,cn)-(self.parent.x-1),math.max(aq+co-1,co)-(self.parent.y-1),a6,m,aC)else aA.drawForegroundBox(math.max(ap+cn-1,cn),math.max(aq+co-1,co),a6,m,aC)end end,draw=function(self)for aO,dr in pairs(fl)do dr.frame:draw()end;if self:getVisualChanged()then if cj.draw(self)then local cn,co=self:getAbsolutePosition(self:getAnchorPosition())local f3,f4=self:getAnchorPosition()if self.parent~=nil then self.parent:drawBackgroundBox(f3,f4,self.width,self.height,self.bgColor)self.parent:drawForegroundBox(f3,f4,self.width,self.height,self.fgColor)self.parent:drawTextBox(f3,f4,self.width,self.height," ")else aA.drawBackgroundBox(cn,co,self.width,self.height,self.bgColor)aA.drawForegroundBox(cn,co,self.width,self.height,self.fgColor)aA.drawTextBox(cn,co,self.width,self.height," ")end;fk.setCursorBlink(false)if self.barActive then if self.parent~=nil then self.parent:writeText(f3,f4,aZ(self.barText,self.width,self.barTextAlign),self.barBackground,self.barTextcolor)else aA.writeText(cn,co,aZ(self.barText,self.width,self.barTextAlign),self.barBackground,self.barTextcolor)end end;for aO,aK in b4(fi)do if fh[aK]~=nil then for aO,aP in pairs(fh[aK])do if aP.draw~=nil then aP:draw()end end end end;if dz then fk.setTextColor(fn)fk.setCursorPos(dw,dx)if self.parent~=nil then fk.setCursorBlink(self:isFocused())else fk.setCursorBlink(dz)end end;self:setVisualChanged(false)end end end,drawUpdate=function(self)aA.update()for fG,dr in pairs(fl)do dr.frame:drawUpdate()end end,addObject=function(self,fr)return fq(fr)end,removeObject=function(self,fr)return fs(fr)end,getObject=function(self,fr)return fp(fr)end,addButton=function(self,bF)local fr=ci(bF)fr.name=bF;return fq(fr)end,addLabel=function(self,bF)local fr=d6(bF)fr.bgColor=self.bgColor;fr.fgColor=self.fgColor;return fq(fr)end,addCheckbox=function(self,bF)local fr=cq(bF)return fq(fr)end,addInput=function(self,bF)local fr=cP(bF)return fq(fr)end,addProgram=function(self,bF)local fr=du(bF)return fq(fr)end,addTextfield=function(self,bF)local fr=eX(bF)return fq(fr)end,addList=function(self,bF)local fr=dg(bF)fr.name=nam;return fq(fr)end,addDropdown=function(self,bF)local fr=cr(bF)return fq(fr)end,addRadio=function(self,bF)local fr=eC(bF)return fq(fr)end,addTimer=function(self,bF)local fr=f8(bF)return fq(fr)end,addAnimation=function(self,bF)local fr=c9(bF)return fq(fr)end,addSlider=function(self,bF)local fr=eT(bF)return fq(fr)end,addScrollbar=function(self,bF)local fr=eH(bF)return fq(fr)end,addMenubar=function(self,bF)local fr=dj(bF)return fq(fr)end,addThread=function(self,bF)local fr=f5(bF)return fq(fr)end,addPane=function(self,bF)local fr=dt(bF)return fq(fr)end,addImage=function(self,bF)local fr=cH(bF)return fq(fr)end,addProgressbar=function(self,bF)local fr=et(bF)return fq(fr)end,addSwitch=function(self,bF)local fr=eU(bF)return fq(fr)end,addFrame=function(self,bF)local fr=ff(bF,self)return fq(fr)end}setmetatable(bO,cj)if fg==nil then table.insert(c,bO)end;return bO end;local fH=false;local function fI(aL,c5,c6,c7,c8)if aL=="mouse_click"then b:mouseClickHandler(aL,c5,c6,c7,c8)elseif aL=="mouse_drag"then b:mouseClickHandler(aL,c5,c6,c7,c8)elseif aL=="mouse_up"then b:mouseClickHandler(aL,c5,c6,c7,c8)elseif aL=="mouse_scroll"then b:mouseClickHandler(aL,c5,c6,c7,c8)elseif aL=="monitor_touch"then b:mouseClickHandler(aL,c5,c6,c7,c8)elseif aL=="key"or aL=="char"then b:keyHandler(aL,c5)b:backgroundKeyHandler(aL,c5)end;if aL=="key"then d[c5]=true end;if aL=="key_up"then d[c5]=false end;for aO,aP in pairs(c)do aP:eventHandler(aL,c5,c6,c7,c8)end;if fH then b:draw()b:drawUpdate()end end;function a.autoUpdate(f7)e.clear()fH=f7 or true;b:draw()b:drawUpdate()while fH do local aL,c5,c6,c7,c8=os.pullEventRaw()fI(aL,c5,c6,c7,c8)end end;function a.update(aL,c5,c6,c7,c8)if aL~=nil then fI(aL,c5,c6,c7,c8)else b:draw()b:drawUpdate()end end;function a.stop()fH=false end;function a.isKeyDown(bp)if d[bp]==nil then return false end;return d[bp]end;function a.getFrame(bF)for aO,aP in pairs(c)do if aP.name==bF then return aP end end end;function a.getActiveFrame()return b end;function a.setActiveFrame(bP)if bP:getType()=="Frame"then b=bP;return true end;return false end;function a.createFrame(bF)return ff(bF)end;function a.removeFrame(bF)for bp,aP in pairs(c)do if aP.name==bF then c[bp]=nil;return true end end;return false end;if a.debugger then a.debugFrame=a.createFrame("basaltDebuggingFrame"):showBar():setBackground(colors.lightGray):setBar("Debug",colors.black,colors.gray)a.debugList=a.debugFrame:addList("debugList"):setSize(a.debugFrame.width-2,a.debugFrame.height-3):setPosition(2,3):setScrollable(true):show()a.debugFrame:addButton("back"):setAnchor("right"):setSize(1,1):setText("\22"):onClick(function()a.oldFrame:show()end):setBackground(colors.red):show()a.debugLabel=a.debugFrame:addLabel("debugLabel"):onClick(function()a.oldFrame=b;a.debugFrame:show()end):setBackground(colors.black):setForeground(colors.white):setAnchor("bottom"):setZIndex(20):show()end;if a.debugger then function a.debug(...)local aV={...}if b.name~="basaltDebuggingFrame"then if b~=a.debugLabel.frame then a.debugLabel:setParent(b)end end;local fJ=""for bp,aP in pairs(aV)do fJ=fJ..tostring(aP)..(#aV~=bp and", "or"")end;a.debugLabel:setText("[Debug] "..fJ)a.debugList:addItem(fJ)if a.debugList:getItemCount()>50 then a.debugList:removeItem(1)end;a.debugList:setValue(a.debugList:getItem(a.debugList:getItemCount()))if a.debugList.getItemCount()>a.debugList:getHeight()then a.debugList:setIndexOffset(a.debugList:getItemCount()-a.debugList:getHeight())end;a.debugLabel:show()end end;return a